/*
 Joel Espinosa Longi
 j.longi@gmail.com
 https://github.com/jlongi/DescartesJS
 LGPL - http://www.gnu.org/licenses/lgpl.html
 2015-03-12
*/
var babel=function(a){if(a.loadLib)return a;a.falso=a["false"]=a.fals=a.gezurra=a.faux=a.fals="false";a.verdadero=a["true"]=a.veritable=a.egia=a.vrai=a.verdadeiro=a.veritable="true";a.no=a.ez=a.non=a["n\u00e3o"]="false";a["s\u00ed"]=a.yes=a.bai=a.oui=a.si=a["sim "]="true";a.negro=a.black=a.negre=a.beltza=a.noir=a.preto=a["#000000"]="#000000";a.maxenta=a.magenta=a["#ff00ff"]="#ff00ff";a.azul=a.blue=a.blau=a.urdina=a.bleu=a["#0000ff"]="#0000ff";a.turquesa=a.cyan=a.turkesa=a.turquoise=a["#00ffff"]="#00ffff";
a.verde=a.green=a.verd=a.berdea=a.vert=a["#00ff00"]="#00ff00";a.amarillo=a.yellow=a.groc=a.horia=a.jaune=a.amarelo=a["#ffff00"]="#ffff00";a.naranja=a.orange=a.taronja=a.laranja=a.laranxa=a["#ffc800"]="#ffc800";a.rojo=a.red=a.vermell=a.gorria=a.rouge=a.vermello=a.vermelho=a["#ff0000"]="#ff0000";a.pink=a.rosa=a.arrosa=a.rose=a["#ffafaf"]="#ffafaf";a.grisObscuro=a.darkGray=a.grisFosc=a["gris iluna"]=a.grisObscur=a.grisEscuro=a.cinzaEscuro=a["#404040"]="#404040";a.gris=a.gray=a.grisa=a.cinza=a["#808080"]=
"#808080";a.grisClaro=a.lightGray=a.grisClar=a["gris argia"]=a.grisClair=a.cinzaClaro=a["#c0c0c0"]="#c0c0c0";a.blanco=a.white=a.blanc=a.zuria=a.branco=a["#ffffff"]="#ffffff";a.escala=a.scale=a.eskala=a["\u00e9chelle"]="scale";a.nombre=a.name=a.nom=a.izena=a.nome="name";a.ikusgai=a["vis\u00edvel"]=a.visible="visible";a.rastro=a.trace=a.rastre=a.arrastoa="trace";a.fondo=a.background=a.fons=a.hondoa=a.fond=a.fundo="background";a["par\u00e1metro"]=a.parameter=a.parametroa=a["par\u00e2metro"]=a["par\u00e0metre"]=
"parameter";a["sucesi\u00f3n"]=a.sequence=a["successi\u00f3"]=a.segida=a.succession=a["seq\u00fc\u00eancia"]="sequence";a["tama\u00f1o"]=a.size=a.neurria=a.taille=a.tamanho=a["grand\u00e0ria"]="size";a.decimales=a.decimals=a.hamartarra=a["d\u00e9cimales"]=a.decimais="decimals";a.red=a.net=a.xarxa=a.sarea=a["r\u00e9seau"]=a.rede=a.malha="net";a.red10=a.net10=a.xarxa10=a.sarea10=a["r\u00e9seau10"]=a.rede10=a.malha10="net10";a.ejes=a.axes=a.eixos=a.ardatzak=a.eixes="axes";a.texto=a.text=a.testua=a.texte=
"text";a["cr\u00e9ditos"]=a.about=a["cr\u00e8dits"]=a.kreditoak=a["cr\u00e9dits"]=a.sobre="about";a.config=a.konfig=a["configura\u00e7\u00e3o"]="config";a.limpiar=a.clear=a.neteja=a.ezabatu=a.nettoye=a.limpar="clear";a.incr=a.gehi=a.incremento="incr";a.min=a.inf="min";a.max=a.sup=a["m\u00e1x"]="max";a.relleno=a.fill=a.ple=a.betea=a.plein=a.recheo=a.preencher="fill";a["relleno+"]=a["fill+"]=a["ple+"]=a["betea+"]=a["plein+"]=a["recheo+"]=a["preencher+"]=a.fillP="fillP";a["relleno-"]=a["fill-"]=a["ple-"]=
a["betea-"]=a["plein-"]=a["recheo-"]=a["preencher-"]=a.fillM="fillM";a.flecha=a.arrow=a.fletxa=a.gezia=a["fl\u00e8che"]=a.frecha=a.seta="arrow";a.ancho=a.width=a.ample=a.zabalera=a.large=a.largura="width";a.punta=a.spear=a.muturra=a.pointe=a.ponta="spear";a["regi\u00f3n"]=a.region=a["regi\u00f3"]=a.eskualde=a["r\u00e9gion"]=a["rexi\u00f3n"]=a["regi\u00e3o"]="region";a.norte=a.north=a.nord=a.ipar="north";a.sur=a.south=a.sud=a.hego=a.sul="south";a.este=a.east=a.est=a.ekialde=a.leste="east";a.oeste=
a.west=a.oest=a.hegoalde=a.ouest="west";a.exterior=a.external=a.kanpoalde=a.externo="external";a["expresi\u00f3n"]=a.expresion=a["expresi\u00f3"]=a.adierazpen=a["express\u00e3o"]="expresion";a.tipo=a.type=a.tipus=a.mota="type";a["posici\u00f3n"]=a.position=a["posici\u00f3"]=a.posizio=a["posi\u00e7\u00e3o"]="position";a["constricci\u00f3n"]=a.constraint=a["constricci\u00f3"]=a.beharte=a.constriction=a["constrici\u00f3n"]=a["restri\u00e7\u00e3o"]="constraint";a.valor=a.value=a.balio=a.valeur="value";
a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.curva=a.curve=a.corba=a.kurba=a.courbe="curve";a.texto=a.text=a.testu=a.texte="text";a.punto=a.point=a.punt=a.puntu=a.ponto="point";a.segmento=a.segment=a.zuzenki="segment";a.arco=a.arc=a.arku="arc";a["pol\u00edgono"]=a.polygon=a["pol\u00edgon"]=a.poligono=a.polygone="polygon";a.imagen=a.image=a.imatge=a.irudi=a.imaxe=a.imagem="image";a["Versi\u00f3n"]=a.Version=a["Versi\u00f3"]=a["Vers\u00e3o"]=
a.version="version";a.Idioma=a.Language=a.Hizkuntza=a.Langue=a.language="language";a["O.x"]="O.x";a["O.y"]="O.y";a.Botones=a.Buttons=a.Botons=a.Botoiak=a.Boutons=a["Bot\u00f3ns"]=a["Bot\u00f5es"]=a.Botons="Buttons";a["Animaci\u00f3n"]=a.Animation=a["Animaci\u00f3"]=a.Animazio=a["Anima\u00e7\u00e3o"]="Animation";a.constante=a.constant=a.Konstante="constant";a.fuente=a.font=a.iturri=a.source=a.fonte="font";a["num\u00e9rico"]=a.numeric=a["num\u00e8ric"]=a.zenbakizko=a["num\u00e9rique"]="numeric";a["gr\u00e1fico"]=
a.graphic=a["gr\u00e0fic"]=a.grafiko=a.graphique="graphic";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.hacer=a["do"]=a.fer=a.egin=a.faire=a.facer=a.fazer=a.doExpr="doExpr";a.mientras=a["while"]=a.mentre=a.bitartean=a["tandis que"]=a.mentres=a.enquanto=a.whileExpr="whileExpr";a.evaluar=a.evaluate=a.avalua=a.ebaluatu=a["\u00e9valuer"]=a.avaliar="evaluate";a.variable=a.aldagaia=a["vari\u00e1vel"]="variable";a["funci\u00f3n"]=a["function"]=a["funci\u00f3"]=a.funtzio=a.fonction=
a["fun\u00e7\u00e3o"]="function";a.algoritmo=a.algorithm=a.algorisme=a.algorithme="algorithm";a.vector=a.array=a.bektore=a.vecteur=a.matriz="array";a["dibujar-si"]=a["draw-if"]=a["marraztu-baldin"]=a["dessiner-si"]=a["debuxar-se"]=a["desenhar-se"]=a["dibuixa-si"]=a.drawif="drawif";a.dominio=a.range=a.domini=a["izate-eremua"]=a.domain=a["dom\u00ednio"]="range";a.pausa=a.delay=a.eten="delay";a["eje-x"]=a["x-axis"]=a["eix-x"]=a["x-ardatza"]=a["axe-x"]=a["eixe-x"]=a["eixo-x"]=a.x_axis="x_axis";a["eje-y"]=
a["y-axis"]=a["eix-y"]=a["y-ardatza"]=a["axe-y"]=a["eixe-y"]=a["eixo-y"]=a.y_axis="y_axis";a["n\u00fameros"]=a.numbers=a.nombres=a.zenbakiak="numbers";a["exponencial-si"]=a["exponential-if"]=a["esponentzial-baldin"]=a["exponentiel-si"]=a["exponencial-se"]=a.exponentialif="exponentialif";a.familia=a.family=a["fam\u00edlia"]=a.famille="family";a.intervalo=a.interval=a.tarte=a.intervalle="interval";a.pasos=a.steps=a.passos=a.pausoak=a.pas="steps";a.centro=a.center=a.centre=a.zentro="center";a.radio=
a.radius=a.radi=a.erradio=a.rayon=a.raio="radius";a.fin=a.end=a.fi=a.bukaera=a.fim="end";a["una-sola-vez"]=a["only-once"]=a["una-sola-vegada"]=a["behin-bakarrik"]=a["une-seule-fois"]=a["unha-soa-vez"]=a["apenas-uma-vez"]=a.onlyOnce="onlyOnce";a.siempre=a.always=a.sempre=a.beti=a.toujours="always";a["color-int"]=a["int-colour"]=a["barruko-kolore"]=a["couleur-int"]=a["cor-int"]=a.colorInt="colorInt";a.repetir=a.loop=a.repeteix=a.errepikatu=a["r\u00e9p\u00e9ter"]="loop";a.controles=a.controls=a.kontrolak=
a["contr\u00f4les"]=a.controis="controls";a.animar=a.animate=a.anima=a.animatu=a.animer="animate";a.auto="auto";a.alto=a.height=a.alt=a.altu=a.haut=a.altura="height";a.x=a.left="x";a.y=a.top="y";a.espacio=a.space=a.espai=a.espazio=a.espace=a.espazo=a["espa\u00e7o"]="space";a.Nu="Nu";a.Nv="Nv";a.ancho=a.depth=a.amplada=a.zabalera=a.largeur=a.ancho=a.profundidade=a.amplada=a.width="width";a.largo=a.length=a.llargada=a.luzera=a.longueur=a.longo=a.comprimento=a.llargada="length";a.alto=a.height=a["al\u00e7ada"]=
a.altu=a.hauteur=a.alto=a.altura=a["al\u00e7ada"]="height";a.color_reverso=a.backcolor=a.color_revers=a["atzealde kolorea"]=a.couleur_revers=a.cor_reverso=a.cor_de_fundo="backcolor";a.aristas=a.edges=a.arestes=a.ertzak=a["ar\u00eates"]=a.arestas="edges";a.rotini=a.inirot="inirot";a.posini=a.inipos="inipos";a["tri\u00e1ngulo"]=a.triangle=a.hirukia=a["tri\u00e2ngulo"]="triangle";a.cara=a.face=a.aurpegi="face";a.polireg=a.regpoly=a["pol\u00edgonoRegular"]="polireg";a.superficie=a.surface=a["superf\u00edcie"]=
a.azalera="surface";a.cubo=a.cube=a.cub=a.kubo="cube";a["paralelep\u00edpedo"]=a.box=a["paral\u00b7lelep\u00edpede"]=a.paralelepipedo=a["parall\u00e9l\u00e9pip\u00e8de"]="box";a.cono=a.cone=a.con=a.kono=a["c\u00f4ne"]="cone";a.cilindro=a.cylinder=a.cilindre=a.zilindro=a.cylindre="cylinder";a.esfera=a.sphere=a["sph\u00e8re"]="sphere";a.tetraedro=a.tetrahedron=a.tetraedre=a["t\u00e9tra\u00e8dre"]="tetrahedron";a.octaedro=a["octahedron="]=a.octaedre=a.oktaedro=a["octa\u00e8dre"]="octahedron";a.dodecaedro=
a.dodecahedron=a.dodecaedre=a.dodekaedro=a["dod\u00e9ca\u00e8dre"]="dodecahedron";a.icosaedro=a.icosahedron=a.icosaedre=a.ikosaedro=a["icosa\u00e8dre"]="icosahedron";a.elipsoide=a.ellipsoid=a["el\u00b7lipsoide"]=a["ellipso\u00efde"]=a["elips\u00f3ide"]="ellipsoid";a.macro=a.makro="macro";a.id="id";a.modelo=a.model=a.eredu=a["mod\u00e8le"]="model";a.color=a.kolore=a.couleur=a.cor=a.colour=a.kolorea="color";a.luz=a.light=a.llum=a.argia=a["lumi\u00e8re"]="light";a.metal=a.metall=a["m\u00e9tal"]="metal";
a.alambre=a.wire=a.filferro=a.alanbre=a["fil de fer"]=a.arame="wire";a.cortar=a.split=a.talla=a.moztu=a.couper=a.dividir="split";a.despliegue=a.render=a.desplegament=a.zabaltze=a["d\u00e8ploiement"]=a.despregamento=a.processar="render";a.orden=a.sort=a.ordre=a.ordena=a.orde=a.ordenar="sort";a.pintor=a.painter=a.margolari=a.peintre="painter";a["trazado de rayos"]=a["ray trace"]=a["tra\u00e7at de raigs"]=a["izpi trazadura"]=a["trace de rayons"]=a["trazado de raios"]=a["tra\u00e7ado de raios"]=a.raytrace=
"raytrace";a.imagen=a.bg_image=a.imatge=a.irudia=a.imaxe=a.imagem_de_fundo=a.image="image";a.despl_imagen=a.bg_display=a.despl_imatge=a["irudi desplazamendu"]=a.despl_image=a.despr_imaxe=a["apresenta\u00e7\u00e3o_de_imagem"]="bg_display";a["arr-izq"]=a.topleft=a["dalt-esq"]=a["goi-ezk"]=a["au-dessus-gau"]=a["arr-esq"]=a["acima-esquerda"]="topleft";a["expand."]=a.stretch=a.hedatu=a["expandir "]="stretch";a.mosaico=a.patch=a.mosaic=a.mosaiko=a["mosa\u00efque"]="patch";a.centrada=a.center=a.zentratu=
a["centr\u00e9e"]=a.centrado="imgcenter";a.archivo=a.file=a.fitxer=a.artxibo=a.fichier=a.arquivo="file";a.tipo_de_macro=a.macro_type=a.tipus_de_macro=a.makro_mota=a.type_de_macro=a.tipo_de_macro=a.tipo_de_macro=a.tipus_de_macro="macro_type";a.filas_norte=a.rows_north=a.files_nord=a["HTML kodea"]=a.files_nord=a.filas_norte=a.linhas_norte=a.files_nord=a.rowsNorth="rowsNorth";a.filas_sur=a.rows_south=a.files_sud=a.ipar_lerro=a.files_sud=a.filas_sur=a.linhas_sul=a.files_sud=a.rowsSouth="rowsSouth";a.ancho_este=
a.width_east=a.ample_est=a.hego_lerro=a.ample_est=a.ancho_leste=a.largura_leste=a.ample_est=a.widthEast="widthEast";a.ancho_oeste=a.width_west=a.ample_oest=a.ekialde_zabalera=a.ample_ouest=a.ancho_oeste=a.largura_oeste=a.ample_oest=a.widthWest="widthWest";a.fijo=a.fixed=a.fix=a.hegoalde_zabalera=a.fixe=a.fixo="fixed";a["Reiniciar Animaci\u00f3n"]=a["Init Animation"]=a["Reinicia Animaci\u00f3"]=a.finko=a["Recommencer l'Animation"]=a["Reiniciar Anima\u00e7\u00e3o"]=a.initAnimation="initAnimation";a["Explicaci\u00f3n"]=
a.Explanation=a.Azalpena=a.Explication=a["Explica\u00e7\u00e3o"]=a["Explicaci\u00f3"]="Explanation";a.tooltip=a.dica="tooltip";a.discreto=a.discrete=a.discret=a.diskretu="discrete";a.interfaz=a.gui=a["interf\u00edcie"]=a.interfaze=a["interface"]="gui";a.pulsador=a.spinner=a.polsador=a.pultsadore=a.bouton="spinner";a["campo de texto"]=a.textfield=a["camp de text"]=a["testu esarrua"]=a["champ de texte"]="textfield";a["men\u00fa"]=a.choice=a.menu=a.escolha="menu";a.barra=a.scrollbar=a.barre="scrollbar";
a.opciones=a.options=a.opcions=a.aukerak=a["opci\u00f3ns"]=a["op\u00e7\u00f5es"]="options";a.interior=a.barruko=a["int\u00e9rieur"]="interior";a["condici\u00f3n"]=a.condition=a["condici\u00f3"]=a.baldintza=a["condi\u00e7\u00e3o"]="condition";a["acci\u00f3n"]=a.action=a["acci\u00f3"]=a.ekintza=a["a\u00e7\u00e3o"]="action";a.evento=a.event=a.esdeveniment=a.gertaera=a["\u00e9v\u00e9nement"]="event";a["abrir URL"]=a["open URL"]=a["obre URL"]=a["URL zabaldu"]=a["ouvrir URL"]=a.openURL="openURL";a["abrir Escena"]=
a["open Scene"]=a["obre Escena"]=a["eszena zabaldu"]=a["ouvrir Escena"]=a["abrir Cena"]=a.openScene="openScene";a["bot\u00f3n"]=a.button=a["bot\u00f3"]=a.botoi=a.bouton=a["bot\u00e3o"]="button";a.mensaje=a.message=a.mezua=a.mensaxe=a.mensagem=a.missatge="message";a.alternar=a.alternate=a.alterna=a.txandakatu=a.alterner="alternate";a["ejecuci\u00f3n"]=a.execution=a["execuci\u00f3"]=a.gauzatze=a["ex\u00e9cution"]=a["execuci\u00f3n"]=a["execu\u00e7\u00e3o"]="execution";a.calcular=a.calculate=a.calcula=
a.kalkulatu=a.calculer="calculate";a.coord_abs=a.abs_coord=a.koor_abs="abs_coord";a.negrita=a.bold=a.negreta=a.lodi=a["caract\u00e8re gras"]=a.negra=a.negrito="bold";a.cursiva=a.italics=a.etzana=a.italique=a["it\u00e1lico"]="italics";a.subrayada=a.underlined=a.subratllat=a.azpimarratua=a.soulignement=a["subli\u00f1ada"]=a.sublinhado="underlined";a.imagen=a.image=a.imatge=a.irundia=a.imaxe=a.imagem="image";a.pos_mensajes=a.msg_pos=a.pos_missatges=a.mezuen_pos=a.pos_messages=a.pos_mensaxes="msg_pos";
a.izquierda=a.left=a.esquerra=a.eskerrean=a.gauche=a.esquerda=a.esquerda=a.esquerra=a.x="x";a.derecha=a.right=a.dreta=a.eskuinan=a.droite=a.dereita=a.direita=a.dreta="right";a["sensible_a_los_movimientos_del_rat\u00f3n"]=a.sensitive_to_mouse_movements=a["sensible_als_moviments_del_ratol\u00ed"]=a["xagu mugimenduarekiko sentikorra"]=a.sensible_aux_mouvements_du_souris=a.sensible_aos_movementos_do_rato=a["sens\u00edvel_aos_movimentos_do_mouse"]="sensitive_to_mouse_movements";a.reproducir=a.play=a.reprodueix=
a.erreproduzitu=a.reproduire=a.reproduzir=a.playAudio="playAudio";a["activo-si"]=a["active-if"]=a["actiu-si"]=a["altiboa-baldin"]=a["actif-si"]=a["activo-se"]=a["ativo-se"]=a.activeif="activeif";a.rotfin=a.finrot=a.bukrot=a.endrot="endrot";a.posfin=a.finpos=a.bukpos=a.endpos="endpos";a.editable=a.editagarria=a["edit\u00e1vel"]="editable";a.tipo=a.type=a.tipus=a.mota="type";a.R2="R2";a.R3="R3";a.vectores=a.bektoreak=a.vecteurs=a.vetores=a.vectors="vectors";a["fuente puntos"]=a["font size"]=a["font punts"]=
a["puntu iturria"]=a["source points"]=a["fonte puntos"]=a["fonte pontos"]=a.font_size="font_size";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.punto=a.dot=a.punt=a.puntu=a.point=a.ponto="point";a.escenario=a.scenario=a.escenari=a.agertoki=a["sc\u00e8ne"]=a["cen\u00e1rio"]="scenario";a.cID="cID";a.matriz=a.matrix=a.matriu=a.matrice="matrix";a.filas=a.rows=a.files="rows";a.columnas=a.columns=a.colonnes="columns";a.solo_texto=a.only_text=
a.seulement_texte=a["s\u00f3_texto"]=a.tan_sols_texte=a.onlyText="onlyText";a.respuesta=a.answer="answer";a.peso=a.weight=a.pes="weight";a.decimal_symbol=a["signo decimal"]=a["decimal symbol"]="decimal_symbol";a.info="info";a.color_contorn_text=a.color_text_border=a.color_borde_texto=a.muga_testuaren_kolorea=a.couleur_contour_texte=a.cor_borde_texto=a.colore_bordo_testo=a.cor_borda_texto=a.color_contorn_text=a.border="border";a.video=a["vid\u00e9o"]="video";a.audio=a["\u00e0udio"]="audio";a.autoplay=
"autoplay";a.loop="loop";a.poster="poster";a.opacidad=a.opacity=a["opacit\u00e9"]=a.opacitat=a.opacidade="opacity";a.alinear=a.align=a["ali\u00f1ar"]=a.aligner="align";a.malla=a.mesh="mesh";a.local=a.Local="local";a.rectangle=a["rect\u00e1ngulo"]="rectangle";a.generic=a.generico="generic";a.loadLib=!0;a["GUI_espa\u00f1ol"]={decimal_symbol:"Simbolo decimal",language:"Lenguaje",about:"Cr\u00e9ditos",config:"Configuraci\u00f3n",init:"Inicio",clear:"Limpiar"};a.GUI_english={};a["GUI_catal\u00e0"]={};
a.GUI_euskera={};a["GUI_fran\u00e7ais"]={};a.GUI_galego={};a["GUI_portugu\u00eas"]={};a["GUI_valenci\u00e0"]={};a.translate=function(a,g){return g.charAt(0).toUpperCase()+g.substring(1)};a["LANG_espa\u00f1ol"]={"true":"s\u00ed","false":"no",decimal_symbol:"signo decimal",version:"Versi\u00f3n",language:"Idioma",Buttons:"Botones",about:"cr\u00e9ditos",init:"inicio",clear:"limpiar",widthEast:"ancho_este",widthWest:"ancho_oeste",type:"tipo",width:"ancho",height:"alto",drawif:"dibujar-si",exponentialif:"exponencial-si",
activeif:"activo-si",fixed:"fijo",scale:"escala",image:"imagen",bg_display:"despl_imagen",background:"fondo",file:"archivo",topleft:"arr-izq",stretch:"expand.",patch:"mosaico",imgcenter:"centrada",center:"centro",net:"red",net10:"red10",axes:"ejes",text:"texto",numbers:"n\u00fameros",x_axis:"eje-x",y_axis:"eje-y",sensitive_to_mouse_movements:"sensible_a_los_movimientos_del_rat\u00f3n",render:"despliegue",sort:"orden",painter:"pintor",split:"cortar",raytrace:"trazado de rayos",numeric:"num\u00e9rico",
region:"regi\u00f3n",north:"norte",south:"sur",east:"este",west:"oeste",external:"exterior",expresion:"expresi\u00f3n",space:"espacio",name:"nombre",value:"valor",incr:"incremento",gui:"interfaz",spinner:"pulsador",textfield:"campo de texto",menu:"men\u00fa",scrollbar:"barra",options:"opciones",button:"bot\u00f3n",graphic:"gr\u00e1fico",discrete:"discreto",decimals:"decimales",visible:"visible",action:"acci\u00f3n",playAudio:"reproducir",parameter:"par\u00e1metro",interior:"interior",condition:"condici\u00f3n",
action:"acci\u00f3n",event:"evento",openURL:"abrir URL",openScene:"abrir Escena",message:"mensaje",alternate:"alternar",execution:"ejecuci\u00f3n",calculate:"calcular",onlyText:"solo_texto",msg_pos:"pos_mensajes",color:"color",colorInt:"color-int",bold:"negrita",italics:"cursiva",underlined:"subrayada",font_size:"fuente puntos",size:"tama\u00f1o",constraint:"constricci\u00f3n",answer:"respuesta",weight:"peso","function":"funci\u00f3n",algorithm:"algoritmo",array:"vector",doExpr:"hacer",whileExpr:"mientras",
evaluate:"evaluar",range:"dominio",onlyOnce:"una-sola-vez",always:"siempre",matrix:"matriz",rows:"filas",columns:"columnas",constant:"constante",equation:"ecuaci\u00f3n",curve:"curva",sequence:"sucesi\u00f3n",text:"texto",point:"punto",segment:"segmento",arc:"arco",polygon:"pol\u00edgono",image:"imagen",abs_coord:"coord_abs",trace:"rastro",family:"familia",interval:"intervalo",steps:"pasos",fillP:"relleno+",fillM:"relleno-",fill:"relleno",spear:"punta",arrow:"flecha",radius:"radio",end:"fin",vectors:"vectores",
opacity:"opacidad",backcolor:"color_reverso",triangle:"tri\u00e1ngulo",face:"cara",surface:"superficie",cube:"cubo",box:"paralelep\u00edpedo",cone:"cono",cylinder:"cilindro",sphere:"esfera",tetrahedron:"tetraedro",octahedron:"octaedro",dodecahedron:"dodecaedro",icosahedron:"icosaedro",ellipsoid:"elipsoide",model:"modelo",light:"luz",metal:"metal",wire:"alambre",edges:"aristas",length:"largo",Animation:"Animaci\u00f3n",delay:"pausa",controls:"controles",loop:"repetir"};a.toLanguage=function(f,g){return a["LANG_"+
(g||"espa\u00f1ol")][f]||f};return a}(babel||{}),descartesJS=function(a){if(a.loadLib)return a;a.convertFont=function(a){if(""==a)return a;fontTokens=a.split(",");fontCanvas="";"bold"==fontTokens[1].toLowerCase()?fontCanvas+="Bold ":"italic"==fontTokens[1].toLowerCase()||"italics"==fontTokens[1].toLowerCase()?fontCanvas+="Italic ":"bold+italic"==fontTokens[1].toLowerCase()&&(fontCanvas+="Italic Bold ");fontName=fontTokens[0].split(" ")[0].toLowerCase();fontCanvas+=fontTokens[2]+"px ";return fontCanvas=
"serif"===fontName||"times new roman"===fontName||"timesroman"===fontName||"times"===fontName?fontCanvas+"descartesJS_serif,Times,'Times New Roman', serif":"sansserif"===fontName||"arial"===fontName||"helvetica"===fontName?fontCanvas+"descartesJS_sansserif,Arial,Helvetica,Sans-serif":fontCanvas+"descartesJS_monospace,Courier,'Courier New',Monospace"};a.getTextWidth=function(c,b){a.ctx.font=b;return Math.round(a.ctx.measureText(c).width)};a.getFieldFontSize=function(a){a=Math.min(50,a);return a=24<=
a?Math.floor(a/2+2-a/16):20<=a?12:17<=a?11:15<=a?10:9};var f={ss_5:{a:5,d:3},ss_6:{a:5,d:3},ss_7:{a:6,d:3},ss_8:{a:7,d:3},ss_9:{a:9,d:4},ss_10:{a:10,d:4},ss_11:{a:11,d:4},ss_12:{a:12,d:4},ss_13:{a:13,d:4},ss_14:{a:13,d:4},ss_15:{a:14,d:4},ss_16:{a:15,d:4},ss_17:{a:15,d:5},ss_18:{a:16,d:5},ss_19:{a:18,d:5},ss_20:{a:19,d:5},ss_21:{a:19,d:6},ss_22:{a:20,d:6},ss_23:{a:21,d:6},ss_24:{a:21,d:7},ss_25:{a:23,d:6},ss_26:{a:25,d:7},ss_27:{a:26,d:7},ss_28:{a:26,d:7},ss_29:{a:27,d:7},ss_30:{a:28,d:8},ss_31:{a:28,
d:8},ss_32:{a:29,d:8},ss_33:{a:31,d:8},ss_34:{a:32,d:8},ss_35:{a:32,d:9},ss_36:{a:33,d:9},ss_37:{a:34,d:10},ss_38:{a:34,d:10},ss_39:{a:35,d:10},ss_40:{a:36,d:10},ss_41:{a:38,d:11},ss_42:{a:38,d:11},ss_43:{a:39,d:11},ss_44:{a:40,d:11},ss_45:{a:40,d:11},ss_46:{a:42,d:11},ss_47:{a:43,d:11},ss_48:{a:45,d:11},ss_49:{a:45,d:13},ss_50:{a:46,d:13},ss_51:{a:47,d:13},ss_52:{a:48,d:13},ss_53:{a:48,d:14},ss_54:{a:49,d:14},ss_55:{a:51,d:14},ss_56:{a:52,d:14},ss_57:{a:52,d:14},ss_58:{a:53,d:14},ss_59:{a:53,d:14},
ss_60:{a:54,d:14},ss_61:{a:55,d:15},ss_62:{a:56,d:15},ss_63:{a:57,d:15},ss_64:{a:58,d:15},ss_65:{a:59,d:16},ss_66:{a:60,d:16},ss_67:{a:60,d:16},ss_68:{a:61,d:16},ss_69:{a:62,d:17},ss_70:{a:63,d:17},ss_71:{a:64,d:17},ss_72:{a:65,d:17},ss_73:{a:66,d:17},ss_74:{a:66,d:17},ss_75:{a:67,d:17},ss_76:{a:68,d:17},ss_77:{a:70,d:18},ss_78:{a:70,d:18},ss_79:{a:71,d:18},ss_80:{a:72,d:18},ss_81:{a:73,d:20},ss_82:{a:73,d:20},ss_83:{a:74,d:20},ss_84:{a:75,d:20},ss_85:{a:77,d:20},ss_86:{a:77,d:20},ss_87:{a:78,d:20},
ss_88:{a:79,d:20},ss_89:{a:80,d:20},ss_90:{a:80,d:20},ss_91:{a:81,d:20},ss_92:{a:83,d:20},ss_93:{a:84,d:20},ss_94:{a:84,d:20},ss_95:{a:85,d:20},ss_96:{a:86,d:20},ss_97:{a:87,d:20},ss_98:{a:87,d:20},ss_99:{a:89,d:20},s_5:{a:4,d:4},s_6:{a:5,d:4},s_7:{a:6,d:4},s_8:{a:7,d:4},s_9:{a:9,d:4},s_10:{a:10,d:3},s_11:{a:11,d:4},s_12:{a:12,d:4},s_13:{a:12,d:4},s_14:{a:13,d:4},s_15:{a:13,d:5},s_16:{a:15,d:5},s_17:{a:15,d:5},s_18:{a:16,d:5},s_19:{a:16,d:6},s_20:{a:17,d:6},s_21:{a:18,d:6},s_22:{a:20,d:6},s_23:{a:20,
d:7},s_24:{a:21,d:7},s_25:{a:23,d:7},s_26:{a:23,d:7},s_27:{a:24,d:8},s_28:{a:26,d:8},s_29:{a:26,d:8},s_30:{a:27,d:8},s_31:{a:28,d:9},s_32:{a:28,d:9},s_33:{a:29,d:9},s_34:{a:31,d:9},s_35:{a:32,d:10},s_36:{a:32,d:10},s_37:{a:33,d:10},s_38:{a:34,d:10},s_39:{a:34,d:12},s_40:{a:35,d:12},s_41:{a:37,d:12},s_42:{a:38,d:12},s_43:{a:39,d:12},s_44:{a:40,d:12},s_45:{a:41,d:13},s_46:{a:41,d:13},s_47:{a:42,d:13},s_48:{a:43,d:13},s_49:{a:44,d:15},s_50:{a:45,d:15},s_51:{a:45,d:15},s_52:{a:46,d:15},s_53:{a:48,d:15},
s_54:{a:48,d:15},s_55:{a:49,d:15},s_56:{a:50,d:15},s_57:{a:51,d:15},s_58:{a:52,d:15},s_59:{a:53,d:15},s_60:{a:54,d:15},s_61:{a:54,d:17},s_62:{a:55,d:17},s_63:{a:56,d:17},s_64:{a:57,d:17},s_65:{a:58,d:17},s_66:{a:59,d:17},s_67:{a:60,d:17},s_68:{a:61,d:17},s_69:{a:61,d:18},s_70:{a:62,d:18},s_71:{a:63,d:18},s_72:{a:64,d:18},s_73:{a:65,d:19},s_74:{a:66,d:19},s_75:{a:67,d:19},s_76:{a:67,d:19},s_77:{a:68,d:20},s_78:{a:70,d:20},s_79:{a:71,d:20},s_80:{a:71,d:20},s_81:{a:72,d:21},s_82:{a:73,d:21},s_83:{a:73,
d:21},s_84:{a:75,d:21},s_85:{a:76,d:21},s_86:{a:77,d:21},s_87:{a:77,d:21},s_88:{a:78,d:21},s_89:{a:79,d:21},s_90:{a:81,d:21},s_91:{a:81,d:21},s_92:{a:82,d:21},s_93:{a:83,d:21},s_94:{a:83,d:21},s_95:{a:84,d:21},s_96:{a:86,d:21},s_97:{a:87,d:21},s_98:{a:87,d:21},s_99:{a:88,d:21},m_5:{a:4,d:3},m_6:{a:5,d:3},m_7:{a:6,d:3},m_8:{a:6,d:3},m_9:{a:9,d:4},m_10:{a:9,d:4},m_11:{a:10,d:5},m_12:{a:11,d:5},m_13:{a:11,d:6},m_14:{a:11,d:7},m_15:{a:12,d:6},m_16:{a:13,d:6},m_17:{a:14,d:7},m_18:{a:14,d:7},m_19:{a:15,
d:7},m_20:{a:16,d:7},m_21:{a:16,d:8},m_22:{a:17,d:8},m_23:{a:17,d:9},m_24:{a:19,d:9},m_25:{a:21,d:9},m_26:{a:21,d:9},m_27:{a:22,d:9},m_28:{a:22,d:10},m_29:{a:23,d:10},m_30:{a:24,d:10},m_31:{a:25,d:11},m_32:{a:26,d:11},m_33:{a:26,d:11},m_34:{a:27,d:11},m_35:{a:28,d:11},m_36:{a:28,d:12},m_37:{a:28,d:11},m_38:{a:30,d:11},m_39:{a:31,d:12},m_40:{a:31,d:12},m_41:{a:32,d:14},m_42:{a:32,d:14},m_43:{a:33,d:14},m_44:{a:34,d:14},m_45:{a:35,d:14},m_46:{a:36,d:14},m_47:{a:37,d:14},m_48:{a:37,d:14},m_49:{a:38,
d:17},m_50:{a:38,d:17},m_51:{a:39,d:17},m_52:{a:41,d:17},m_53:{a:41,d:18},m_54:{a:42,d:18},m_55:{a:43,d:18},m_56:{a:43,d:18},m_57:{a:44,d:19},m_58:{a:46,d:19},m_59:{a:46,d:19},m_60:{a:47,d:19},m_61:{a:47,d:21},m_62:{a:48,d:21},m_63:{a:49,d:21},m_64:{a:49,d:22},m_65:{a:51,d:21},m_66:{a:52,d:21},m_67:{a:52,d:21},m_68:{a:53,d:21},m_69:{a:53,d:22},m_70:{a:54,d:22},m_71:{a:55,d:22},m_72:{a:56,d:22},m_73:{a:57,d:23},m_74:{a:58,d:23},m_75:{a:58,d:23},m_76:{a:59,d:23},m_77:{a:59,d:24},m_78:{a:60,d:24},m_79:{a:62,
d:24},m_80:{a:62,d:24},m_81:{a:63,d:25},m_82:{a:64,d:25},m_83:{a:64,d:25},m_84:{a:65,d:25},m_85:{a:65,d:25},m_86:{a:67,d:25},m_87:{a:68,d:25},m_88:{a:68,d:25},m_89:{a:69,d:25},m_90:{a:70,d:25},m_91:{a:70,d:25},m_92:{a:71,d:25},m_93:{a:72,d:25},m_94:{a:73,d:25},m_95:{a:74,d:25},m_96:{a:74,d:25},m_97:{a:75,d:25},m_98:{a:76,d:25},m_99:{a:77,d:25}},g={};document.createElement("canvas");var c;a.getFontMetrics=function(a){if(g[a])return g[a];c=parseInt(a.match(/(\d+\.*)+px/)[0]);var b;a.match("sansserif")?
b="ss_":a.match("serif")?b="s_":a.match("monospace")&&(b="m_");b=f[b+c];b={ascent:b.a,descent:b.d,h:b.a+b.d,baseline:b.a};return g[a]=b};return a}(descartesJS||{}),descartesJS=function(a){function f(){var a,b,c,d,l,h,e,f,m;Number.prototype.originalToFixed=Number.prototype.toFixed;Number.prototype.toFixed=function(k){try{return this.originalToFixed(k)}catch(n){k=k?k:0;k=0>k?0:parseInt(k);a=this.toString();l=a.indexOf("e");if(-1!==l)if(h=a.split("e"),f="-"===h[0][0]?"-":"",e="-"===f?parseFloat(h[0].substring(1)).originalToFixed(11):
parseFloat(h[0]).originalToFixed(11),m=parseInt(h[1]),b=e.indexOf("."),0>b+m){b=0>b?1:b;var g=f+"0.",r;r=Math.abs(b+m);r=Array(r+1).join("0");a=g+r+e.replace(".","")}else e=e.replace(".",""),a=f+e+Array(m-e.length+2).join("0");b=a.indexOf(".");c="";if(-1===b)0<k&&(c="."),c+=Array(k+1).join("0"),a+=c;else if(d=a.length-b-1,d>=k)11>=k&&(a=parseFloat(a).originalToFixed(k)),a=0<k?a.substring(0,b+1+k):a.substring(0,b);else{g=0;for(k-=d;g<k;g++)c+="0";a+=c}return a}}}function g(a,b,d){a.fillStyle="#c0c0c0";
a.fillRect(b.offsetLeft,b.offsetTop,b.offsetWidth,b.offsetHeight);c(a,b,d.controls)}function c(a,b,c){for(var d,h=c.length-1;0<=h;h--)d=c[h],a.drawImage(d.getScreenshot(),b.offsetLeft+d.x,b.offsetTop+d.y)}if(a.loadLib)return a;var e=2*Math.PI,b=360/e,m=e/360,h=Math.floor,d,n,r,k,s,q,u,l;a.rangeOK=1;a.extend=function(a,b){if("function"==typeof Object.create)a.prototype=Object.create(b.prototype);else if(a.prototype.__proto__)a.prototype.__proto__=b.prototype;else for(var c in b.prototype)b.prototype.hasOwnProperty(c)&&
(a.prototype[c]=b.prototype[c]);a.prototype.uber=b.prototype};a.radToDeg=function(a){return a*b};a.degToRad=function(a){return a*m};a.drawLine=function(a,b,c,d,e,f,m){a.lineWidth=m||1;a.strokeStyle=f||"black";l=a.lineWidth%2?.5:0;a.beginPath();a.moveTo(h(b)+l,h(c)+l);a.lineTo(h(d)+l,h(e)+l);a.stroke()};a.getColor=function(a,b){if("string"==typeof b)return b;d=a.evalExpression(b);n=h(255*d[0][0]);r=h(255*d[0][1]);k=h(255*d[0][2]);s=1-d[0][3];return"rgba("+n+","+r+","+k+","+s+")"};a.getFeatures=function(){a.hasJavaSupport=
navigator.javaEnabled();var b=navigator.appVersion.toLowerCase();a.hasTouchSupport=window.hasOwnProperty&&window.hasOwnProperty("ontouchstart")||b.match("android")&&!0;a.hasTouchSupport=navigator.userAgent.toLowerCase().match("qt")?!1:a.hasTouchSupport;a.isIOS=!(!navigator.userAgent.match(/iPad/i)&&!navigator.userAgent.match(/iPhone/i));b=document.createElement("canvas");a.hasCanvasSupport=b.getContext&&b.getContext("2d");a.hasCanvasSupport&&(a.ctx=document.createElement("canvas").getContext("2d"),
a._ratio=a.devicePixelRatio=a.backingStoreRatio=1);f()};a.removeNeedlessDecimals=function(a){var b,c;if("string"==typeof a&&(b=a.indexOf("."),-1!=b)){c=a.substring(b);if(0==parseFloat(c))return a.substring(0,b);for(var d=c.length;0<d;d--)if(0!=c.charAt(d))return a.substring(0,b+d+1)}return a};a.returnValue=function(a){return"number"===typeof a?parseFloat(a.toFixed(11)):a};a.whichButton=function(a){return null!==a.which?2>a.which?"L":2===a.which?"M":"R":2>a.button?"L":4===a.button?"M":"R"};a.getCursorPosition=
function(a){a.touches?(a=a.touches[0],q=a.pageX,u=a.pageY):void 0!=a.pageX&&void 0!=a.pageY?(q=a.pageX,u=a.pageY):(q=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,u=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:q,y:u}};a.getScreenshot=function(){var b=a.apps[0],d,h=document.createElement("canvas"),l=new Image;if(b){h.setAttribute("width",b.width);h.setAttribute("height",b.height);for(var e=h.getContext("2d"),f=0,m=b.spaces.length;f<m;f++)d=
b.spaces[f],"R2"===d.type&&(e.drawImage(d.backgroundCanvas,d.x,d.y),e.drawImage(d.canvas,d.x,d.y),c(e,d.container,d.ctrs));0<b.northSpace.controls.length&&g(e,b.northSpace.container,b.northSpace);0<b.southSpace.controls.length&&g(e,b.southSpace.container,b.southSpace);0<b.eastSpace.controls.length&&g(e,b.eastSpace.container,b.eastSpace);0<b.westSpace.controls.length&&g(e,b.westSpace.container,b.westSpace);l.src=h.toDataURL("image/png")}return l};a.showAbout=function(){var b;b=a.creativeCommonsLicense?
"<html>\n<head>\n<style>\nbody{ text-align:center; }\niframe{ width:650px; height:73px; overflow:hidden; border:1px solid black; }\ndt{ font-weight:bold; margin-top:10px; }\n</style>\n</head>\n<body>\n<iframe src='http://arquimedes.matem.unam.mx/Descartes5/creditos/bannerPatrocinadores.html'></iframe>\n<h2> <a href='http://proyectodescartes.org/' target='_blank'>ProyectoDescartes.org</a> <br> <a href='http://descartesjs.org' target='_blank'>DescartesJS.org</a> </h2>\n<dl>\n<dt> Dise&ntilde;o funcional:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Jos&eacute; R. Galo Sanchez,</nobr>\n<nobr>Juan Madrigal Muga</nobr>\n</dd>\n<dt>Autores del software:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Marta Oliver&oacute; Serrat,</nobr>\n<nobr>Oscar Escamilla Gonz&aacute;lez,</nobr>\n<nobr>Joel Espinosa Longi</nobr>\n</dd>\n</dl>\n<p>\nEl software en Java est&aacute; bajo la licencia\n<a href='https://joinup.ec.europa.eu/software/page/eupl/licence-eupl'>EUPL v.1.1 </a>\n<br>\nEl software en JavaScript est&aacute; bajo licencia\n<a href='http://www.gnu.org/licenses/lgpl.html'>LGPL</a>\n</p>\n<p>\nLa documentaci&oacute;n y el c&oacute;digo fuente se encuentran en :\n<br>\n<a href='http://arquimedes.matem.unam.mx/Descartes5/'>http://arquimedes.matem.unam.mx/Descartes5/</a>\n</p>\n<p>\nEste objeto, creado con Descartes, est&aacute; licenciado\npor sus autores como\n<a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'><nobr>Creative Commons</nobr></a>\n<br>\n<a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'><img src='https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png'></a>\n</p></body> </html>":
"<html>\n<head>\n<style>\nbody{ text-align:center; }\niframe{ width:650px; height:73px; overflow:hidden; border:1px solid black; }\ndt{ font-weight:bold; margin-top:10px; }\n</style>\n</head>\n<body>\n<iframe src='http://arquimedes.matem.unam.mx/Descartes5/creditos/bannerPatrocinadores.html'></iframe>\n<h2> <a href='http://proyectodescartes.org/' target='_blank'>ProyectoDescartes.org</a> <br> <a href='http://descartesjs.org' target='_blank'>DescartesJS.org</a> </h2>\n<dl>\n<dt> Dise&ntilde;o funcional:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Jos&eacute; R. Galo Sanchez,</nobr>\n<nobr>Juan Madrigal Muga</nobr>\n</dd>\n<dt>Autores del software:</dt>\n<dd>\n<nobr>Jos&eacute; Luis Abreu Leon,</nobr>\n<nobr>Marta Oliver&oacute; Serrat,</nobr>\n<nobr>Oscar Escamilla Gonz&aacute;lez,</nobr>\n<nobr>Joel Espinosa Longi</nobr>\n</dd>\n</dl>\n<p>\nEl software en Java est&aacute; bajo la licencia\n<a href='https://joinup.ec.europa.eu/software/page/eupl/licence-eupl'>EUPL v.1.1 </a>\n<br>\nEl software en JavaScript est&aacute; bajo licencia\n<a href='http://www.gnu.org/licenses/lgpl.html'>LGPL</a>\n</p>\n<p>\nLa documentaci&oacute;n y el c&oacute;digo fuente se encuentran en :\n<br>\n<a href='http://arquimedes.matem.unam.mx/Descartes5/'>http://arquimedes.matem.unam.mx/Descartes5/</a>\n</p>\n</body> </html>";
var c=window.open("","creditos","width=700,height=500,titlebar=0,toolbar=0,location=0,menubar=0,resizable=0,scrollbars=0,status=0");c.document.write(b);c.document.close()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g;a._externalFilesContent={};a.openExternalFile=function(c){if(a._externalFilesContent[c])return a._externalFilesContent[c];f=null;var e=!1;if(window.XMLHttpRequest)try{e=new XMLHttpRequest}catch(b){e=!1}else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(m){try{e=
new ActiveXObject("Microsoft.XMLHTTP")}catch(h){e=!1}}g=e;g.open("GET",c,!1);try{g.send(null),f=g.responseText,f.match(String.fromCharCode(65533))&&(g.open("GET",c,!1),g.overrideMimeType("text/plain; charset=ISO-8859-1"),g.send(null),f=g.responseText)}catch(d){console.log("Error to load the file :",c),f=null}return f};a.addExternalFileContent=function(c,e){a._externalFilesContent[c]=e};return a}(descartesJS||{}),descartesJS=function(a){function f(a){p=a.indexOf("--radial--");-1!=p&&(a=a.substring(0,
p));b=a.trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1),"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1)));"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1),b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1)));"*"===b.charAt(0)&&"*"!==b.charAt(b.length-1)?b=b.substring(1)+"$":"*"!==b.charAt(0)&&"*"===b.charAt(b.length-1)?b="^"+
b.substring(0,b.length-1):"*"!==b.charAt(0)&&"*"!==b.charAt(b.length-1)?b="^"+b+"$":"*"===b.charAt(0)&&"*"===b.charAt(b.length-1)&&(b=b.substring(1,b.length-1));b=b.replace(/\?/g,"[\\S\\s]{1}");a.regExp=b;return a}function g(a,c){b=(a||"").trim();a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};a.expr=b.split(",");a.expr[0]=a.expr[0].trim();a.expr[0]={type:a.expr[0].charAt(0),expr:c.parser.parse(a.expr[0].substring(1))};a.expr[1]=a.expr[1].trim();a.expr[1]={type:a.expr[1].charAt(a.expr[1].length-1),
expr:c.parser.parse(a.expr[1].substring(0,a.expr[1].length-1))};return a}function c(a,b,c){b=parseFloat(b);n=a.expr[0];r=a.expr[1];k=c.evalExpression(n.expr);s=c.evalExpression(r.expr);q="("==n.type;u="["==n.type;l=")"==r.type;v="]"==r.type;return(q&&b>k||u&&b>=k)&&(l&&b<s||v&&b<=s)?1:0}function e(a){return a.toString().replace(/\u00e1/g,"a").replace(/\u00e9/g,"e").replace(/\u00ed/g,"i").replace(/\u00f3/g,"o").replace(/\u00fa/g,"u").replace(/\u00c1/g,"A").replace(/\u00c9/g,"E").replace(/\u00cd/g,
"I").replace(/\u00d3/g,"O").replace(/\u00da/g,"U").replace(/\u00f1/g,"n").replace(/\u00d1/g,"N")}if(a.loadLib)return a;var b,m,h,d,n,r,k,s,q,u,l,v,p;a.buildRegularExpresionsPatterns=function(a,c){a=a||"";"("===a.charAt(0)&&")"===a.charAt(a.length-1)&&-1===a.indexOf(",")&&(a=a.substring(1,a.length-1));a=a.replace(/&squot;/g,"'").replace(/&amp;/g,"&").split("|");for(var d=0,l=a.length;d<l;d++){m=a[d].split("&");h=[];for(var e=0,k=m.length;e<k;e++)b=m[e],-1===b.indexOf(",")||"("!==b.charAt(0)&&"["!==
b.charAt(0)||")"!==b.charAt(b.length-1)&&"]"!==b.charAt(b.length-1)?h.push(f(b)):h.push(g(b,c));a[d]=h}return a};a.escorrecto=function(b,h,l,f){l=l||a.externalEvaluator;f=f||a.buildRegularExpresionsPatterns(b,l);h=e(h);b=0;for(var k=f.length;b<k;b++){m=f[b];d=!0;for(var n=0,g=m.length;n<g;n++)d=m[n].regExp?d&&!!h.match(new RegExp(e(m[n].regExp),"i")):d&&c(m[n],h,l);if(d)return 1}return 0};a.esCorrecto=function(h,l,f,k){f=f||a.externalEvaluator;k=k||a.buildRegularExpresionsPatterns(h,f);h=0;for(var n=
k.length;h<n;h++){m=k[h];d=!0;for(var g=0,p=m.length;g<p;g++)(b=m[g].regExp)?(m[g].ignoreAcents&&(l=e(l),b=e(b)),m[g].ignoreCaps&&(l=l.toLowerCase(),b=e(b).toLowerCase()),d=d&&!!l.match(b)):d=d=d&&c(m[g],l,f);if(d)return 1}return 0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.getCreativeCommonsLicenseImage=function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAYAAABjyArgAAAABHNCSVQICAgIfAhkiAAACpVJREFUaIHtWm1sU9cZfu61iUYnPP/bJgdhhDbFkVYcCrR0tLHXrVNL01wvgUJDh820tivrkpQQtpEvA4HGhDoe/dCmNfbaVa1WKszX2oUO3xC0OHESm9Hi/FhloyQq1aY5OGgq8ce7H9f3xI7txKFsdKyPdHSPz8dzz33Oe77eY46IVBzHXcUXuOkgIo4DQABwuucUeJ4Hz/NQKBTgeQUUPA9ekXryPDiOB89x4DgO4DiZBQQCJQlJSiKZlEIikZCeyQQSiSSSyQTLS1KSlSciuTEsfjtgY+UmAAAHgGRxFQqFFHjFTFyhkPJ4RUpkDhzHp+ubEiclbFISM5FIhfR4IlPkZDLJhE0X+nbBxspNUALIFFehhDLjKYWTx0/B4/FgcHAQU9GpDKIlqiVYu3YtjN8xouLRR5BIKsDzcalDEjw4cJD6cgaUJGkkANIY4iRxR3x+uN9xIxgMZpTX6XQQqgSsWlNW0Md9Xng4APSns+9BqVQyUZVKpRQUSvSK52B73oaJiYmCGqTRaND4i0aUl9+PeCKBRCKOeDwVEnHE4wlm4emW/PHExzjS9SJGg6MAAIPBAL1eDwAIBAIQRREAUKIrwY7aHfja17+a8/1XPv4ELzle+lzwbKzcJAn8fu8ZKBXKGWGVi7BIqURrcxvcx9ysglqthiAI0Gq1KC8vBwD09vYiHA7D7XZjcnKSlRVMAhoad2LxHYsRj8cRi8cRj8cQj8czpwxK4mrkKn769LOIRqMQBAF2ux1arTajseFwGPX19XC73VCpVGi3tWd91LXoNdTuqPvc8MjzMJ3tO0t9/eeo39dPQwEfXfggQIJJIEiDl9RqNbW1tVEkEqG54HQ6Sa1Ws3oluhI6399HQ4Eh8g71U1//OfL0naUzYg+99+d36XTPKTrx7nHS6XQEgMxmcwafzDP7HTL328f/kBFKdCU5eRx2Oz3+2ObPxDM2Nkbe/n7y9vfT2NhYQTwAiAcARWoOVioUUCoyLVev18Pv96O1tRVqtTprGKTDbDYjFAqxoTQaHEWn7XDGXM6zHYm0G/F5fQgGgxAEAY27ds3JL79DEASMBkcx4vOz9BGfH6PBUawqK8O996xj6b/q6sLzNhtOnj6N3Q27MD4+XhBPent+/9prMKy/DzWbt6Bm8xYY1t+HMz09c/Kkg/q8feQd8tLIhWFyHHEwy9Hr9fNabS5EIhHS6/WMx/Gig0b+OkIDw1467+0jz3nJit99/4+kK5WsNxQKFcwfCoUIAOl0OmYt8igo+cY3acUyLZV/ez09/eMnCQC1tbXRwQMHCQAdffvtgnjk9nj7+yW+u9fRj7ZZqHFnA61YpqUVy7TksNvz8uSwYMmKbc/bAEjzrdPpnNdqc0GtVsPj8bC6toO21F46ZcFcak/N8wheCsJgMGTNcRaLhVm5xWLJyNNqtTAYDBkrezAo8VRUVGDjpk0YHx/HmZ4erFimxb+mrmHrE1tx6cMPUVVdXRCPVqtFNBpF0H8RAFAp/AC/dXWjo/MQ9rQ0AwBc3c68PDJ4AKlhK23F5N1CXV0dG+o3ArVaDbvdDgCYmJjAyROn2IFFEplj27Rc73G5XDnjMnLV0ev1sB3uxEFbB954601UVVfjo8th2A53YunSpXB1OxG8dKkgHhntL0gG95vfvcrSvvfggwCAaDSKT65cycsDpASWrcnj8QCQxKmtrWWFRFGEyWSC0WiE0WiE1WrNm9fV1cXyzGYzs2LPWU+a9XLg+BmB/xO4+5570NF5CGNjY2jc2YCyb92Jd44eRcXDG1CzeQubQ+eCSqWCw+HAHaoleOWVV3KW+fTT63NySAcNjgPPcRgcHAQACILAhBFFEUajMaOSKIoQRRG1tbUwmUxZeRcuXIDT6WRcLpcLg4OD0gkwJawkriRwIBDIapjZbGaWazabs/Jz1ZmdFo1GcaanBx2dh2C+ZEHFwxsAAANeLwa8XhQXF4NbpJyTZ5FSicaGBtyxeDFLG/B6WXyZdlne9gDMgqUPlk9oK1euZAXq6+sBSPNMKBSCx+OBVqvFtm3bmCXr9XqEQiEcO3YsY48MgMWnolPSe8ClPYHS0lKIoohwOJzRMLmDZscBaQ8qiiJ0Oh1L0+l0WTw/efIptO/dh1V3rkTN5i346HIYVdXV6Og8hJqtWwviGR8fR1tLKx5/bDPa9+5D+959aGlqAgDs2r07b3syBAaHjOGaPp/IPWM2m9lkHgqFYDabWZ58+BAEgeXJSF+8JKPNPDZvfExadOSOLARyWaFKYGlyPJ2no/MQLNu348o//o6/hUJw2O3Y09KMqupqWPfvQ9ma1fPyWLZvh2X7dgCAs7sbzu5uXP/0OjZUPIItNY/nbY+M7PHxX8a69eugK9XB7XbDYrFkWetsyKenEl1Jhh9g1ZoylOhKMniKi4uxp6UZX1q8GCPDw/hZXd0N8expacb3H3oIly+HAUijTldaOiePDMmCKdOLlT6fyNbscrkwOTmJQCCA5cuXw2q1sjz5mJyeJyN9yEpnM3l7PIPmtmaoVCq4XC6YTCZWh9K8bOFwGCaTCV1dXVCpVNhRuyPrY3b/sjEnz85dDXjjrTc/E8/qNatRVV2Nqupq6EpLC+IBUs4e38ggioqKsP7e+zAVnYLZbGaW5Ha7sxYyQJoyKisr8+bJ9evr69HV1YUlqiU4/5c+TE9PYzo2jVg8hlgsLjmDEnFE/jmJA9YDbC+p1+uh1+uhVqshiiLr9PmcNNei19BxwMacNLeShzl7BoYHUFRUBGuLFe5jbqjVakQiEVZQFEU4HA7mzDEYDGhtbWUd4HA4WNn0PABYvnw5wuEwHvjuAzhs78T16WnEZgks+42TiSR8Az4cO3rr3Yw3g4cJ7B3qx6JFRTh/7jxqn5X2v3a7HXVpc9aNwOVysVPY/gP78fCGhzAdm8Z0LIZ4LIZYfJbAORzw/8vYWLlJmoPlKx2DsRwajQYAYLVas7ZOC8Hk5CRbXTUaTcoRn7rFSCaRTM3FlLpyul3BA0CSkkgkpHu0fe17AUgCmUymDB9voZicnITRaGR1G3/emHKwJ2ZETrsyYovsrMX2dgEBoKbWJvKNDFLgop+e+OETGR41v9+/IE9XuidNMAkUuOgn38gg7W3fy9L/j8LMj7rnamnI76PADTjcI5EItbW1ZTjc16xdQxc+CNBQwEdNrU23+kNvSWDX9jKaW5tQaRKgVCpx2HYYr7/2Ostb6JWRdV8b4vE4BgYG8cxTz2A+pE8P8smSiDJOmbN/5+PJV0d+R6GOpnxtWhDH7NDc2iRZ8kU/dbteJY1GU3CPaTQachxxUOCin4YCPnr51y8XXJeI5oynp83HM1/9QrhylVkoR5YFy6h7rhY1W2vYVY/o6cWJ4yfmvLZ/VHgUBkM5u9A8fvwE9lv3F9DHEnJZS3reQqyO47i8z4VgtrXOXoTn48srMACsuqsMza0tKF6qSbuNSHc3ImPfKv/xZGJ8HC902nGu99yCP+azTA35eABkCbxQsXN1UiEccwos4/7y+7GhYgPuWn0XvqJSpf46Jb9ZetHVaBTDQ8M4ffL0goVN/wjWsJtgwbl+L2T+nG9NuGkCf4EbB09EX77VjbhdQUTcvwFtwhQyXNo3TwAAAABJRU5ErkJggg==";
return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.floor,g,c,e,b,m,h,d,n,r,k,s,q,u;a.Color=function(a,d){this.b=this.g=this.r=0;this.a=1;this.evaluator=d;if(a){if(babel[a]&&("net"===babel[a]&&(a="rojo"),a=babel[a],this.r=parseInt("0x"+a.substring(1,3),16),this.g=parseInt("0x"+a.substring(3,5),16),this.b=parseInt("0x"+a.substring(5,7),16),this.colorStr=a,this.getColor=this.getColorString),6===a.length&&(this.r=parseInt("0x"+a.substring(0,2),16),this.g=parseInt("0x"+
a.substring(2,4),16),this.b=parseInt("0x"+a.substring(4,6),16),this.colorStr="#"+a,this.getColor=this.getColorString),8===a.length&&(this.r=parseInt("0x"+a.substring(2,4),16),this.g=parseInt("0x"+a.substring(4,6),16),this.b=parseInt("0x"+a.substring(6,8),16),this.a=1-parseInt("0x"+a.substring(0,2),16)/255,this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString),"("===a[0]){c=[];e=this.splitComa(a.substring(1,a.length-1));for(var h=0,f=e.length;h<f;h++)b=
parseInt(e[h],16),e[h]!=b.toString(16)&&e[h]!=="0"+b.toString(16)?("["===e[h].charAt(0)&&"]"===e[h].charAt(e[h].length-1)&&(e[h]=e[h].substring(1,e[h].length-1)),c.push(this.evaluator.parser.parse(e[h]))):c.push(this.evaluator.parser.parse((b/255).toString()));this.rExpr=c[0];this.gExpr=c[1];this.bExpr=c[2];this.aExpr=c[3];this.getColor=this.getColorExpression}}else this.colorStr="rgba("+this.r+","+this.g+","+this.b+","+this.a+")",this.getColor=this.getColorString};a.Color.prototype.splitComa=function(a){m=
[];for(var b=n=d=h=0,c=a.length;b<c;b++)r=a.charAt(b),"("===r?h++:")"===r?h--:"["===r?d++:"]"===r?d--:","===r&&0===h&&0===d&&(m.push(a.substring(n,b)),n=b+1);m.push(a.substring(n));return m};a.Color.prototype.getColorString=function(){return this.colorStr};a.Color.prototype.getColorExpression=function(){g=this.evaluator;this.r=f(255*g.evalExpression(this.rExpr));this.g=f(255*g.evalExpression(this.gExpr));this.b=f(255*g.evalExpression(this.bExpr));this.a=1-g.evalExpression(this.aExpr);return"rgba("+
this.r+","+this.g+","+this.b+","+this.a+")"};a.Color.prototype.borderColor=function(){return 380>this.r+this.g+this.b?"#ffffff":"#000000"};a.RGBAToHexColor=function(b){b=b.substring(5,b.length-1).split(",");k=parseInt(b[0]).toString(16);s=parseInt(b[1]).toString(16);q=parseInt(b[2]).toString(16);u=(255-parseInt(255*parseFloat(b[3]))).toString(16);k=1==k.length?"0"+k:k;s=1==s.length?"0"+s:s;q=1==q.length?"0"+q:q;u=1==u.length?"0"+u:u;return new a.Color(u+k+s+q)};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var f=document.head,g=document.createElement("meta");g.setAttribute("http-equiv","X-UA-Compatible");g.setAttribute("content","IE=edge,chrome=1");f.appendChild(g);g=document.createElement("meta");g.setAttribute("name","viewport");g.setAttribute("content","width=device-width, initial-scale=1.0, user-scalable=yes");document.querySelector("meta[name=viewport]")||f.appendChild(g);g=document.createElement("meta");g.setAttribute("name","apple-mobile-web-app-capable");g.setAttribute("content",
"yes");f.appendChild(g);g=document.createElement("meta");g.setAttribute("name","apple-mobile-web-app-status-bar-style");g.setAttribute("content","black");f.appendChild(g);(f=document.getElementById("StyleDescartesApps2"))&&f.parentNode.removeChild(f);f=document.createElement("style");f.type="text/css";f.id="StyleDescartesApps2";f.setAttribute("rel","stylesheet");document.head.appendChild(f);f.innerHTML="div.DescartesCatcher{ background-color:rgba(255, 255, 255, 0); cursor:pointer; position:absolute; }\ndiv.DescartesAppContainer{ border:0px solid black; position:relative; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoader{ background-color :#CACACA; position:absolute; overflow:hidden; top:0px; left:0px; }\ndiv.DescartesLoaderImage{ background-repeat:no-repeat; background-position:center; position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesLoaderBar{ position:absolute; overflow:hidden; top:0px; left:0px; }\ncanvas.DescartesSpace2DCanvas, canvas.DescartesSpace3DCanvas, div.blocker{ position:absolute; overflow:hidden; left:0px; top:0px; }\ndiv.DescartesSpace2DContainer, div.DescartesSpace3DContainer{ position:absolute; overflow:hidden; line-height:0px; }\ncanvas.DescartesButton{ position:absolute; cursor:pointer; }\ndiv.DescartesButtonContainer{ position:absolute; background-repeat:no-repeat; }\ndiv.DescartesSpinnerContainer, div.DescartesTextFieldContainer, div.DescartesMenuContainer{ background:lightgray; position:absolute; overflow:hidden; }\ninput.DescartesSpinnerField, input.DescartesTextFieldField, input.DescartesMenuField, input.DescartesScrollbarField{ -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family:descartesJS_sansserif,Arial,Helvetica,Sans-serif; padding:0px; border:solid #666 1px; position:absolute; top:0px; }\nlabel.DescartesSpinnerLabel, label.DescartesMenuLabel, label.DescartesScrollbarLabel, label.DescartesTextFieldLabel{ font-family:descartesJS_sansserif,Arial,Helvetica,Sans-serif; font-weight:normal; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:#e0e4e8; position:absolute; left:0px; top:0px; }\ndiv.DescartesGraphicControl{ border-style:none; position:absolute; }\ndiv.DescartesTextAreaContainer{ position:absolute; overflow:hidden; background:#c0d0d8; }\nselect.DescartesMenuSelect{ font-family:descartesJS_sansserif,Arial,Helvetica,Sans-serif; padding-top:0px; text-align:center; text-overflow:ellipsis; white-space:nowrap; overflow:hidden; background-color:white; position:absolute; left:0px; top:0px; }\ndiv.DescartesScrollbarContainer{ background:#eee; overflow:hidden; position:absolute; }\ndiv.DescartesEditorContainer{ font-family:descartesJS_sansserif,Arial,Helvetica,Sans-serif; position:fixed; left:0px; top:0px; width:100%; height:100%; background-color:#2e2e2e; z-index:10001; }\ndiv.DescartesEditorTabContainer{ width:100%; height:100%; position:absolute; padding:0px;  }\n.DescartesTabs{ height: 37px; }\n.DescartesTabs > ul{ font-size:18px; list-style:none; padding:0 1px 1px; margin-left:4px; text-align:center; }\n.DescartesTabs > ul > li{ margin-right:1px; padding:8px 8px; float:left; color:#fff; -webkit-user-select:none; -moz-user-select:none; user-select:none; border-radius:7px 7px 0px 0px; background:#0C91EC; background:-moz-linear-gradient(top, #0C91EC 0%, #257AB6 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#0C91EC), color-stop(100%,#257AB6)); }\n.DescartesTabs > ul > li:hover{ background:#fff; background:-moz-linear-gradient(top, #FFFFFF 0%, #F3F3F3 10%, #F3F3F3 50%, #FFFFFF 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(10%,#F3F3F3), color-stop(50%,#F3F3F3), color-stop(100%,#FFFFFF)); cursor:pointer; color:#000; }\n.DescartesTabs > ul > li.tabActiveHeader{ background:#fff; background:-moz-linear-gradient(top, #FFFFFF 0%, #F3F3F3 10%, #F3F3F3 50%, #FFFFFF 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(10%,#F3F3F3), color-stop(50%,#F3F3F3), color-stop(100%,#FFFFFF)); cursor:pointer; color:#000; }\n.DescartesTabscontent{ position:absolute; left:5px; right:5px; top:55px; bottom:45px; overflow:y-scroll; padding:10px 10px 25px; background:#000; background:-moz-linear-gradient(top, #FFFFFF 0%, #FFFFFF 90%, #e4e9ed 100%); background:-webkit-gradient(linear, left top, left bottom, color-stop(0%,#FFFFFF), color-stop(90%,#FFFFFF), color-stop(100%,#e4e9ed)); margin:0px; color:#000; background-color:#000; }\ndiv.DescartesConfigPanel{ position:absolute; left:10px; right:10px; top:10px; bottom:10px; overflow:y-scroll; border:solid 1px #000; border-radius:5px; font-size:18px; padding:10px; line-height:1.5em; overflow:auto; }\ndiv.DescartesLeftPanelClass{ position:absolute; left:10px; top:10px; bottom:10px; width:200px; background-color:; border:1px solid black; overflow:auto; }\ndiv.DescartesLeftPanelClass li:nth-child(odd){ background-color:#6495ED; }\ndiv.DescartesLeftPanelClass li:nth-child(even){ background-color:#ED6495; }\ndiv.DescartesLeftPanelClass > div > ul{ list-style:none; background:#bbb; padding:5px; }\ndiv.DescartesLeftPanelClass > div > ul > li{ padding:5px; -webkit-user-select:none; -moz-user-select:none; user-select:none; cursor:pointer; white-space: nowrap; overflow: hidden; }\ndiv.DescartesRightPanelClass{ position:absolute; left:220px; right: 10px; top:10px; bottom:10px; background-color:; border:1px solid black; overflow:auto; }\ndiv.DescartesLabelAndElementContainer{ padding:4px 8px; margin:4px; display:inline-block; background-color:lightgray; border-radius:3px; }\ndiv.DescartesLabelAndElementContainer > select{ font-family:Monospace; font-size:18px; }\ndiv.DescartesLabelAndElementContainer > input{ font-family:Monospace; font-size:18px; }\ndiv.DescarteslistContainer{ font-family:Arial,Helvetica,Sans-serif; font-size:20px; position:absolute; left:5px; right:5px; top:45px; bottom:45px; border-radius:5px; background-color:#DDD; overflow:auto; }\ndiv.DescarteslistContainer > ul{ margin:5px; padding:5px; padding-bottom:15px; list-style:none; }\ndiv.DescarteslistContainer > ul > li{ padding:7px; margin:1px; }\ndiv.DescarteslistContainer li:nth-child(odd){ background-color:#BBB; }\ndiv.DescarteslistContainer li:nth-child(even){ background-color:#999; }\ndiv.DescartesExtraInfo{ padding: 12px; }\nspan.DescartesSpanName{ background-color:lightblue; margin:5px; }\nspan.DescartesSpanValue{ background-color:#333; color:white; margin:0px; padding:5px; border-radius:3px; line-height:1.75em; }\nspan.DescartesSpanValue br{ display: none; }\nspan.DescartesSpanValue * { display: inline }\ndiv.Descartes_param_name{ background-color:#669; color:#ee5; margin-bottom:10px; }\n.DescartesToolbarPlace{ -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; text-align:center; border-radius:4px 4px 4px 4px;  position:absolute; left:5px; right:5px; top:0px; height:40px; min-width:290px; background: #ccc; padding:4px; }\n.DescartesButtonsPlace{ -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; text-align:center; border-radius:4px 4px 4px 4px;  position:absolute; left:5px; right:5px; bottom:0px; height:40px; min-width:290px; background: #ccc; padding:4px; }\ndiv.DescartesAddPanel{ position:absolute; top:10px; left:10px; width:350px; background-color:white; }\ndiv.DescarteslistContainer li.DescartesElementSelected{ border:1px solid black; background-color:#D66; }\ninput.DescartesEditorButton{ cursor:pointer; width:110px; height:30px; padding:5px 25px; margin:0px 2px; background:#257AB6; border:1px solid #fff; border-radius:7px; box-shadow: inset 0px 1px 0px #3e9cbf, 0px 2px 0px 0px #205c73, 0px 4px 5px #999; color:#fff; font-size:1em; }\ninput.DescartesEditorButton:hover, input.DescartesEditorButton:focus{ background-color:#0C91EC; box-shadow:0 0 1px rgba(0,0,0, .75); }\n";
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.sin,g=Math.floor,c=Math.random,e=Math.round,b=Math.abs,m=String.fromCharCode,h,d,n,r,k,s,q,u,l,v;a.Krypto=function(a){this.key=(a||0).toString()};a.Krypto.prototype.getKey=function(a){h=[];for(var c=0;256>c;c++)h[c]=m(this.alfanum(g(b(7.5*(f(1*c-a)+f(1.4*c+a)+f(.6*c-a)+f(2.2*c+a))))));return h.join("")};a.Krypto.prototype.encode=function(a){d=g(31*c());this.key=this.getKey(d);r=m(this.alfanum(d));return r+this.encripta(a)};
a.Krypto.prototype.decode=function(a){d=this.numalfa(a.charCodeAt(0));this.key=this.getKey(d);return this.desencripta(a.substring(1))};a.Krypto.prototype.encripta=function(a){return this.bytesToString(this.encriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.encriptaAux=function(a){if(null==a||null==this.key)return null;s=Array(3*a.length);for(var b=0,d=a.length;b<d;b++)l=256*g(a[b]+128)+e(255*c())+65536*e(255*c()),v=g((l<<this.shift(b))/256),s[3*b]=this.alfanum(v%32),s[3*b+1]=this.alfanum(v/32%
32),s[3*b+2]=this.alfanum(v/1024%32);return s};a.Krypto.prototype.desencripta=function(a){return this.bytesToString(this.desencriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.desencriptaAux=function(a){if(null==a||null==this.key)return null;q=Array(a.length/3);for(var b=0,c=q.length;b<c;b++)v=this.numalfa(a[3*b])+32*this.numalfa(a[3*b+1])+1024*this.numalfa(a[3*b+2]),l=g(256*v>>this.shift(b)),u=g(l/256)%256-128,0>u&&(u+=256),q[b]=u;return q};a.Krypto.prototype.alfanum=function(a){a=g(a);return 10>
a?48+a:87+a};a.Krypto.prototype.numalfa=function(a){return 58>a?a-48:a-87};a.Krypto.prototype.stringToBytes=function(a){r=Array(a.length);for(var b=0,c=a.length;b<c;b++)r[b]=a.charCodeAt(b);return r};a.Krypto.prototype.bytesToString=function(a){for(var b=0,c=a.length;b<c;b++)a[b]=m(a[b]);return a.join("")};a.Krypto.prototype.shift=function(a){n=this.key.charCodeAt(a%this.key.length);r=this.numalfa(n);k=g(r/2%8);0==k&&(k=4);return k};a.Krypto.prototype.parseByte=function(a){a=parseInt(a);a=0>a?0:a;
return 255<a?255:a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.max;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame;a.Animation=function(g,c){this.parent=g;var e=g.evaluator,b=e.parser,m=new a.Auxiliary(g);this.start=null;this.delay=c.delay?b.parse(c.delay):b.parse("60");
this.loop=c.loop?c.loop:!1;this.auto=void 0==c.auto?!0:c.auto;this.controls=c.controls;this.pause=!1;this.init=m.splitInstructions(b,c.init);this.doExpr=m.splitInstructions(b,c.doExpr);c.whileExpr&&(this.whileExpr=b.parse(c.whileExpr));var h=this,d,n,r=h.doExpr.length;this.animationExec=function(){for(n=0;n<r;n++)e.evalExpression(h.doExpr[n]);h.parent.update();h.playing&&(0<e.evalExpression(h.whileExpr)||h.loop)?(d=e.evalExpression(h.delay),window.requestAnimationFrame||(h.timer=setTimeout(h.animationExec,
f(d,10)))):(h.stop(),h.pause=!1,h.parent.update())};this.playing=!1;this.auto&&this.play()};a.Animation.prototype.play=function(){var a=this;this.playing?(this.pause=!0,this.stop()):(this.pause||this.reinit(),this.playing=!0,this.pause=!1,delay=this.parent.evaluator.evalExpression(this.delay),this.timer=window.requestAnimationFrame?requestAnimationFrame(function(c){a.step(c)}):setTimeout(this.animationExec,f(delay,10)))};a.Animation.prototype.stop=function(){this.playing=!1;window.requestAnimationFrame?
window.cancelAnimationFrame(this.timer):clearInterval(this.timer)};a.Animation.prototype.reinit=function(){for(var a=0,c=this.init.length;a<c;a++)this.parent.evaluator.evalExpression(this.init[a])};a.Animation.prototype.step=function(a){var c=this;null===c.start&&(c.start=a);delay=f(c.parent.evaluator.evalExpression(c.delay),10);a-c.start>delay&&(c.animationExec(),c.start=null);c.playing&&(c.timer=requestAnimationFrame(function(a){c.step(a)}))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Action=function(a,g){this.parent=a;this.evaluator=this.parent.evaluator};a.Action.prototype.execute=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Message=function(f,g){a.Action.call(this,f,g);this.parameter=(g||"").replace(/\\n/g,"\n").replace(/&squot;/g,"'")};a.extend(a.Message,a.Action);a.Message.prototype.execute=function(){alert(this.parameter)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Calculate=function(f,g){a.Action.call(this,
f,g);var c=this.evaluator,e=c.parser;g=(g||"").replace(/&squot;/g,"'");g=g.replace(/;/g,"\\n");g=g.split("\\n")||[""];for(var b=[],m,h=0,d=g.length;h<d;h++)(m=e.parse(g[h],!0))&&b.push(m);d=b.length;this.execute=function(){for(h=0;h<d;h++)c.evalExpression(b[h])}};a.extend(a.Calculate,a.Action);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenURL=function(f,g){a.Action.call(this,f,g);this.parameter=g;this.target="_blank";var c=this.parameter.indexOf("target");-1!=c&&(this.target=
this.parameter.substring(c),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,c-1));if("javascript"==this.parameter.substring(0,10)){this.parameter=new a.SimpleText(f,this.parameter.substring(11).replace(/&squot;/g,"'"));var e=this;this.actionExec=function(){eval(e.parameter.toString())}}else"http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=
function(){window.open(this.parameter,this.target)}};a.extend(a.OpenURL,a.Action);a.OpenURL.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenScene=function(f,g){a.Action.call(this,f,g);this.parameter=g;this.target="_blank";var c=this.parameter.indexOf("target");-1!=c&&(this.target=this.parameter.substring(c),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,c-1));"_blank"!==
this.target&&"_parent"!==this.target&&"_self"!==this.target&&"_top"!==this.target?this.actionExec=function(){window.parent.postMessage({type:"changeTarget",name:this.target,value:this.parameter},"*")}:"javascript"==this.parameter.substring(0,10)?(this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),
this.actionExec=function(){window.open(this.parameter,this.target,"width="+this.parent.width+",height="+this.parent.height+",left="+(window.screen.width-this.parent.width)/2+", top="+(window.screen.height-this.parent.height)/2+"location=0,menubar=0,scrollbars=0,status=0,titlebar=0,toolbar=0")})};a.extend(a.OpenScene,a.Action);a.OpenScene.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.About=function(f,g){a.Action.call(this,
f,g);g||(this.urlAbout=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+g)};a.extend(a.About,a.Action);a.About.prototype.execute=function(){console.log("about");if(this.urlAbout)var a=window.open(this.urlAbout,"_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes");else a=window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes"),a.document.write("<hmtl><head><title>Cr\u00e9ditos</title></head><body><h1>Aqu\u00ed van los cr\u00e9ditos</h1></body></html>")};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Config=function(f,g){a.Action.call(this,f,g)};a.extend(a.Config,a.Action);a.Config.prototype.execute=function(){this.parent.editor?this.parent.editor.show():window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes").document.write("<xmp style='width:100%; height:100%;'><script type='text/javascript' src='http://arquimedes.matem.unam.mx/Descartes5/lib/descartes-min.js'>\x3c/script>\n"+
this.parent.applet.outerHTML.replace(/<applet/g,"<ajs").replace(/<\/applet/g,"</ajs")+"</xmp>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Init=function(f,g){a.Action.call(this,f,g)};a.extend(a.Init,a.Action);a.Init.prototype.execute=function(){this.parent.init()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Clear=function(f,g){a.Action.call(this,f,g)};a.extend(a.Clear,a.Action);a.Clear.prototype.execute=function(){this.parent.clear()};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animate=function(f,g){a.Action.call(this,f,g)};a.extend(a.Animate,a.Action);a.Animate.prototype.execute=function(){this.parent.play()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.InitAnimation=function(f,g){a.Action.call(this,f,g)};a.extend(a.InitAnimation,a.Action);a.InitAnimation.prototype.execute=function(){this.parent.reinitAnimation()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var f=/[\w\.\-//]*(\.ogg|\.oga|\.mp3|\.wav|\.OGG|\.OGA\.MP3|\.WAV)/g;a.PlayAudio=function(g,c){a.Action.call(this,g,c);c&&c.match(f)?this.filenameExpr=this.evaluator.parser.parse("'"+c.match(f)+"'"):this.filenameExpr=this.evaluator.parser.parse(c)};a.extend(a.PlayAudio,a.Action);a.PlayAudio.prototype.execute=function(){var a=this.theAudio=this.parent.getAudio(this.evaluator.evalExpression(this.filenameExpr));a.paused?a.play():(a.pause(),a.currentTime=0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Auxiliary=function(a,e){this.parent=a;this.evaluator=this.parent.evaluator;this.expresion=this.id="";this.evaluate="onlyOnce";this.local="";for(var b in e)e.hasOwnProperty(b)&&(this[b]=e[b])};a.Auxiliary.prototype.firstRun=function(){};a.Auxiliary.prototype.update=function(){};var f,g;a.Auxiliary.prototype.splitInstructions=function(a,e){g=[];e=e?e.split(";"):[""];for(var b=0,m=e.length;b<m;b++)(f=a.parse(e[b],!0))&&g.push(f);return g};a.Auxiliary.prototype.getPrivateVariables=function(a,e){g=[];
e=e?e.split(/;|,/):[""];for(var b=0,m=e.length;b<m;b++)(f=a.parse(e[b],!0))&&g.push(f);b=0;for(m=g.length;b<m;b++)g[b]="asign"===g[b].type?g[b].childs[0].value:"identifier"===g[b].type?g[b].value:"";return g};a.Auxiliary.prototype.parseExpressions=function(a){this.init=this.splitInstructions(a,this.init);this.privateVars=this.getPrivateVariables(a,this.local);this.doExpr=this.splitInstructions(a,this.doExpr);this.whileExpr=a.parse(this.whileExpr)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Variable=function(f,g){a.Auxiliary.call(this,f,g);var c=this.evaluator.parser;this.expresionString=this.expresion;(this.expresion=c.parse(this.expresionString))&&c.setVariable(this.id,this.expresion);this.editable&&(this.registerTextField(),this.parent.editableRegionVisible=!0)};a.extend(a.Variable,a.Auxiliary);a.Variable.prototype.registerTextField=function(){var a=document.createElement("div"),g=document.createElement("label");g.appendChild(document.createTextNode("___"+this.id+"=___"));var c=
document.createElement("input");c.value=this.expresionString;c.disabled=!this.editable;a.appendChild(g);a.appendChild(c);var e=this,b=e.evaluator.parser;c.onkeydown=function(a){13==a.keyCode&&(e.expresion=b.parse(this.value),b.setVariable(e.id,e.expresion),e.parent.update())};this.parent.editableRegion.textFields.push({container:a,type:"div"})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Constant=function(f,g){a.Auxiliary.call(this,f,g);this.expresion=this.evaluator.parser.parse(this.expresion);
this.update()};a.extend(a.Constant,a.Auxiliary);a.Constant.prototype.update=function(){this.evaluator.setVariable(this.id,this.evaluator.evalExpression(this.expresion))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c;a.Vector=function(c,b){f=c.evaluator;g=f.parser;this.size=g.parse("3");a.Auxiliary.call(this,c,b);this.expresion=this.expresion.split(";");this.parseFile=g.parse(this.file);this.update()};a.extend(a.Vector,a.Auxiliary);a.Vector.prototype.update=function(){var e=
this.expresion;f=this.evaluator;g=f.parser;this.oldFile=this.file;if(c=f.evalExpression(this.parseFile))this.file=c;var b;if(this.file){b=(vectorElement=document.getElementById(this.file))&&"descartes/vectorFile"==vectorElement.type?vectorElement.text:a.openExternalFile(this.file);if(null!=b){b=b.replace(/\r/g,"").split("\n");for(var m=[],h=0,d=b.length;h<d;h++)""!=b[h]&&m.push(b[h]);b=m}null==b||1==b.length&&""==b[0]?this.size=g.parse("0"):(e=b,this.size=null);null===this.size&&(this.size=g.parse(e.length+
""))}b=[];h=0;for(d=e.length;h<d;h++)(m=g.parse(e[h],!0))&&"asign"!=m.type&&(m=g.parse(this.id+"["+h+"]="+e[h],!0)),b.push(m);e=[];e._size_=f.evalExpression(this.size);h=0;for(d=this._size_;h<d;h++)e.push(0);f.vectors[this.id]=e;f.setVariable(this.id+".long",e._size_);h=0;for(d=b.length;h<d;h++)f.evalExpression(b[h])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Matrix=function(f,g){var c=f.evaluator,e=c.parser;this.rows=e.parse("3");this.columns=e.parse("3");a.Auxiliary.call(this,
f,g);this.expresion=this.splitInstructions(e,this.expresion);var e=c.evalExpression(this.rows),b=c.evalExpression(this.columns),m=[];m.type="matrix";for(var h,d=0;d<b;d++){h=[];for(var n=0,r=e;n<r;n++)h.push(0);m[d]=h}c.matrices[this.id]=m;this.update()};a.extend(a.Matrix,a.Auxiliary);a.Matrix.prototype.update=function(){var a=this.evaluator,g=a.evalExpression(this.rows),c=a.evalExpression(this.columns);a.setVariable(this.id+".filas",g);a.setVariable(this.id+".columnas",c);var e=a.matrices[this.id];
e.rows=g;e.cols=c;g=0;for(c=this.expresion.length;g<c;g++)a.evalExpression(this.expresion[g])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Function=function(f,g){a.Auxiliary.call(this,f,g);var c=this.evaluator,e=c.parser,b=this.id.indexOf("(");this.name=this.id.substring(0,b);this.params=this.id.substring(b+1,this.id.indexOf(")"));this.domain=this.range?e.parse(this.range):e.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;
this.algorithm||(this.whileExpr=this.doExpr=this.init="");this.parseExpressions(e);this.expresion=e.parse(this.expresion);var m=this;this.functionExec=function(){this.iterations=0;if(m.numberOfParams<=arguments.length){for(var b=[],d=0,e=m.privateVars.length;d<e;d++)b.push(c.getVariable(m.privateVars[d])),c.setVariable(m.privateVars[d],0);for(var f=[],d=0,e=m.params.length;d<e;d++)f[d]=c.getVariable(m.params[d])||0,c.setVariable(m.params[d],arguments[d]);d=0;for(e=m.init.length;d<e;d++)c.evalExpression(m.init[d]);
do{d=0;for(e=m.doExpr.length;d<e;d++)c.evalExpression(m.doExpr[d]);if(1E5<++this.iterations)return console.log("se ha excedido el l\u00edmite de 100000 repeticiones en la funci\u00f3n",this.id),0}while(0<c.evalExpression(m.whileExpr));var k=c.evalExpression(m.expresion);a.rangeOK=c.evalExpression(m.domain);d=0;for(e=m.params.length;d<e;d++)c.setVariable(m.params[d],f[d]);d=0;for(e=m.privateVars.length;d<e;d++)c.setVariable(m.privateVars[d],b[d]);return k}return 0};c.setFunction(this.name,this.functionExec)};
a.extend(a.Function,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Algorithm=function(f,g){a.Auxiliary.call(this,f,g);var c=this.evaluator;this.parseExpressions(c.parser);this.algorithmExec=function(){for(var a=this.iterations=0,b=this.init.length;a<b;a++)c.evalExpression(this.init[a]);do{a=0;for(b=this.doExpr.length;a<b;a++)c.evalExpression(this.doExpr[a]);if(1E5<++this.iterations)return console.log("se ha excedido el l\u00edmite de 100000 repeticiones en el algoritmo",
this.id),0}while(0<c.evalExpression(this.whileExpr))}};a.extend(a.Algorithm,a.Auxiliary);a.Algorithm.prototype.update=function(){this.algorithmExec();"onlyOnce"===this.evaluate&&(this.update=function(){})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Event=function(f,g){a.Auxiliary.call(this,f,g);var c=this.evaluator;delete this.evaluate;this.condition=c.parser.parse(this.condition);this.lastEvaluation=!1;this.action=this.parent.lessonParser.parseAction(this);"onlyOnce"==
this.execution&&(this.eventExec=function(){0<this.evaluator.evalExpression(this.condition)&&!this.lastEvaluation&&(this.lastEvaluation=!0,this.action.execute())});"alternate"==this.execution&&(this.eventExec=function(){var a=0<this.evaluator.evalExpression(this.condition);3==this.parent.version?a!=this.lastEvaluation&&(this.action.execute(),this.lastEvaluation=a?!0:!1):a&&!this.lastEvaluation?(this.action.execute(),this.lastEvaluation=!0):!a&&this.lastEvaluation&&(this.lastEvaluation=!1)});"always"==
this.execution&&(this.eventExec=function(){0<this.evaluator.evalExpression(this.condition)&&this.action.execute()})};a.extend(a.Event,a.Auxiliary);a.Event.prototype.update=function(){this.eventExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b;a.Graphic=function(b,c){this.parent=b;this.evaluator=b.evaluator;var d=this.evaluator.parser;this.spaceID="";this.background=!1;this.type="";this.drawif=d.parse("1");this.abs_coord=!1;this.color=new a.Color("blue");
2!==this.parent.version&&(this.color=new a.Color("20303a"),this.parent.arquimedes&&(this.color=new a.Color("black")));this.trace="";this.expresion=d.parse("(0,0)");this.family="";this.family_interval=d.parse("[0,1]");this.family_steps=d.parse("8");this.editable=!1;this.font=5<=this.parent.version?"Monospaced,PLAIN,15":"Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=d.parse("2");for(var e in c)c.hasOwnProperty(e)&&(this[e]=c[e]);this.space=this.getSpace();this.canvas=this.background?
this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/([\d\.]+)px/))?parseFloat(this.fontSize[1]):10};a.Graphic.prototype.getSpace=function(){for(var a=this.parent.spaces,b,c=0,e=a.length;c<e;c++)if(b=a[c],b.id==this.spaceID)return b;return a[0]};a.Graphic.prototype.getFamilyValues=function(){f=this.evaluator;g=f.evalExpression(this.family_interval);
this.familyInf=g[0][0];this.familySup=g[0][1];this.fSteps=Math.round(f.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic.prototype.drawFamilyAux=function(a,b,d){f=this.evaluator;this.getFamilyValues();c=f.getVariable(this.family);if(0<=this.fSteps)for(var e=0,g=this.fSteps;e<=g;e++)f.setVariable(this.family,this.familyInf+e*this.family_sep),0<f.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,b,d));f.setVariable("_Text_H_",
0);f.setVariable(this.family,c)};a.Graphic.prototype.draw=function(a,b){""!=this.family?this.drawFamilyAux(this.ctx,a,b):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,b))};a.Graphic.prototype.drawTrace=function(a,b){""!=this.family?this.drawFamilyAux(this.traceCtx,a,b):0<this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.traceCtx,a,b))};a.Graphic.prototype.drawText=function(a,c,d,n,g,k,s,q,u,l,v){if("rtfNode"===c.type)a.fillStyle=g.getColor(),
a.strokeStyle=g.getColor(),a.textBaseline="alphabetic",c.draw(a,d,n+1,u,l,s,v,g.getColor());else for("simpleText"===c.type&&(c=c.toString(u,l).split("\\n")),d+=k.match("Arial")?-2:k.match("Times")?-2:0,f=this.evaluator,a.fillStyle=g.getColor(),a.font=k,a.textAlign=s,a.textBaseline=q,this.border&&(a.strokeStyle=this.border.getColor(),a.lineWidth=4),b=1.2*this.fontSize||0,g=0,k=c.length;g<k;g++)e=c[g],this.border&&(a.lineJoin="round",a.miterLimit=2,a.strokeText(e,d,n+b*g)),a.fillText(e,d,n+b*g)};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.SimpleText=function(a,e){this.text=e=e.replace("&#x2013","\u2013").replace(/\&squot;/g,"'");this.textElements=[];this.textElementsMacros=[];this.parent=a;this.evaluator=a.evaluator;this.type="simpleText";for(var b="'",f=0,h=0,d=-1,n,g;f<e.length;)n=e.charAt(f),g=e.charAt(f-1),"["===n&&"\\"===g?(this.textElements.push(e.substring(h,f-1)+"["),this.textElementsMacros.push("'"+e.substring(h,f-1)+"['"),h=f+1):"]"===n&&"\\"===g?(this.textElements.push(e.substring(h,
f-1)+"]"),this.textElementsMacros.push("'"+e.substring(h,f-1)+"]'"),h=f+1):"["===n&&-1===d?(this.textElements.push(e.substring(h,f)),this.textElementsMacros.push("'"+e.substring(h,f)+"'"),h=f,d++):"["===n?d++:"]"===n&&0===d?(this.textElements.push(this.evaluator.parser.parse(e.substring(h,f+1))),this.textElementsMacros.push("["+e.substring(h,f+1)+"]"),h=f+1,d--):("]"==e.charAt(f)&&(d=0>d?d:d-1),b+=e.charAt(f)),f++;this.textElements.push(e.substring(h,f));this.textElementsMacros.push("'"+e.substring(h,
f)+"'")};var f,g;a.SimpleText.prototype.toString=function(c,e){f="";for(var b=0,m=this.textElements.length;b<m;b++)"string"===typeof this.textElements[b]?f+=this.textElements[b]:(g=this.evaluator.evalExpression(this.textElements[b])[0][0],""!==g&&("string"===typeof g?f+=g:(g=parseFloat(g),g=e?g.toFixed(c):a.removeNeedlessDecimals(g.toFixed(c)),f+=g.toString().replace(".",this.parent.decimal_symbol))));return f};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,
m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z,B,E,D,y,I;a._debug_vez=0;a.Equation=function(b,c){this.width=b.evaluator.parser.parse("1");this.fillM=this.fillP="";a.Graphic.call(this,b,c);this.parseExpression();(this.visible=2===this.parent.version&&void 0==this.visible?!0:this.visible)&&this.registerTextField();s=new a.R2;q=new a.R2;u=new a.R2;p=new a.R2;l=new a.R2};a.extend(a.Equation,a.Graphic);a.Equation.prototype.parseExpression=function(){if("compOperator"===this.expresion.type){var b=this.expresion.childs[0],
c=this.expresion.childs[1];"identifier"!=b.type||"y"!=b.value||c.contains("y")?"identifier"!=c.type||"y"!=c.value||b.contains("y")?"identifier"!=b.type||"x"!=b.value||c.contains("x")?"identifier"!=c.type||"x"!=c.value||b.contains("x")||(this.of_y=!0,this.funExpr=c,this.drawAux=this.drawAuxFun):(this.funExpr=c,this.of_y=!0,this.drawAux=this.drawAuxFun):(this.funExpr=b,this.of_y=!1,this.drawAux=this.drawAuxFun):(this.funExpr=c,this.of_y=!1,this.drawAux=this.drawAuxFun)}this.newt=new a.R2Newton(this.evaluator,
this.expresion)};a.Equation.prototype.update=function(){};a.Equation.prototype.draw=function(){""!=this.family?this.drawFamilyAux(this.ctx,this.fill,this.color):(this.update(),this.drawAux(this.ctx,this.fill,this.color))};a.Equation.prototype.drawFamilyAux=function(a,b,c){g=this.evaluator;this.getFamilyValues();tempParam=g.getVariable(this.family);if(0<=this.fSteps)for(var d=0,h=this.fSteps;d<=h;d++)g.setVariable(this.family,this.familyInf+d*this.family_sep),this.update(),this.drawAux(a,b,c);g.setVariable(this.family,
tempParam)};a.Equation.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Equation.prototype.drawAux=function(G,H,J){if(!(0>=this.evaluator.evalExpression(this.drawif))){var x,K,F;g=this.evaluator;c=g.parser;e=this.space;b=g.evalExpression(this.width);G.strokeStyle=this.color.getColor();G.lineWidth=b;m=c.getVariable("x");h=c.getVariable("y");d=e.w+24;n=e.h+24;r=d/9;3>r&&(r=3);k=n/7;3>k&&(k=3);f=[];s.set(0,0);q.set(0,0);u.set(0,0);var L=.25,M=8;this.abs_coord||(L/=
e.scale,M/=e.scale);G.beginPath();for(I=parseInt(k/2);I<n;I+=k)for(y=parseInt(r/2);y<d;y+=r){if(this.abs_coord){p.set(y,I);v=this.newt.findZero(p,L);if(null==v)continue;g.setVariable("x",v.x);g.setVariable("y",v.y);l.set(v.x,v.y)}else{p.set(e.getRelativeX(y),e.getRelativeY(I));v=this.newt.findZero(p,L);if(null==v)continue;g.setVariable("x",v.x);g.setVariable("y",v.y);l.set(e.getAbsoluteX(v.x),e.getAbsoluteY(v.y))}t=l.ix();w=l.iy();if(-12<=t&&t<d+24&&-12<=w&&w<n+24){if(f[t+12+(w+12)*e.w])continue;
f[t+12+(w+12)*e.w]=!0}a.rangeOK&&(G.moveTo(t,w),G.lineTo(t,w));s.x=v.x;s.y=v.y;q.x=v.x;q.y=v.y;A=this.newt.getUnitNormal();if(0!=A.x||0!=A.y)for(A.rotL90(),u.x=A.x,u.y=A.y,z=C=0,B=!1;2>z;)if(B&&(u.x=-A.x,u.y=-A.y,v.x=s.x,v.y=s.y,q.x=v.x,q.y=v.y,this.abs_coord?l.set(v.x,v.y):l.set(e.getAbsoluteX(v.x),e.getAbsoluteY(v.y)),t=l.ix(),w=l.iy(),B=!1,C=0),v.x+=M*u.x,v.y+=M*u.y,v=this.newt.findZero(v,L),null!=v){g.setVariable("x",v.x);g.setVariable("y",v.y);u.x=v.x-q.x;u.y=v.y-q.y;u.normalize();if(0==u.x&&
0==u.y)break;q.x=v.x;q.y=v.y;this.abs_coord?l.set(v.x,v.y):l.set(e.getAbsoluteX(v.x),e.getAbsoluteY(v.y));E=parseInt(l.ix());D=parseInt(l.iy());if(E!=t||D!=w)if(H=t,J=w,t=E,w=D,-12<=t&&t<d+24&&-12<=w&&w<n+24){C=0;x=f[t+12+(w+12)*e.w];f[t+12+(w+12)*e.w]=!0;for(var N=1;8>N;N++)K=H+Math.round((t-H)*N/8),F=J+Math.round((w-J)*N/8),0<=K&&K<d&&0<=F&&F<n&&(f[K+12+(F+12)*e.w]=!0);a.rangeOK&&(G.moveTo(H,J),G.lineTo(t,w));if(x)break}else B=!0,z++;else 4<++C&&(B=!0,z++)}}G.stroke()}};a.Equation.prototype.X=function(a,
b,c){c||(b=this.space.w/2+this.space.Ox+this.space.scale*b);b<-a&&(b=-a);b>this.space.w+a&&(b=this.space.w+a);return b};a.Equation.prototype.Y=function(a,b,c){c||(b=this.space.h/2+this.space.Oy-this.space.scale*b);b<-a&&(b=-a);b>this.space.h+a&&(b=this.space.h+a);return b};a.Equation.prototype.XX=function(a,b,c){return Math.round(this.X(a,b,c))};a.Equation.prototype.YY=function(a,b,c){return Math.round(this.Y(a,b,c))};a.Equation.prototype.extrapolate=function(b,c,d,h,l,e){for(var f=this.evaluator.getVariable(c),
k=e/2,m=0;1E-12<Math.abs(k);){var n=this.evaluator.getVariable(c),g=this.evaluator.getVariable(c)+k;this.evaluator.setVariable(c,g);var u=!0,r=l;l=this.evaluator.evalExpression(this.funExpr);this.evaluator.setVariable(d,l);if(0<this.evaluator.evalExpression(b)){var q=new a.R2(Math.min(r,l),Math.max(r,l)),p=0,p=0<e?this.Singularity(Math.abs(k),c,h,n,r,g,l,q):this.Singularity(Math.abs(k),c,h,g,l,n,r,q);0<p&&(u=!1)}else u=!1;u?m+=k:this.evaluator.setVariable(c,n);k/=2}this.evaluator.setVariable(c,f);
return new a.R2(m/Math.abs(e),l)};a.Equation.prototype.extrapolateOnSingularity=function(b,c,d,h,l,e){h=this.evaluator.getVariable(c);for(var f=e/2,k=0,m=l;1E-12<Math.abs(f);){this.evaluator.setVariable(this.evaluator.getVariable(c)+f);var n=!0;0<this.evaluator.evalExpression(b)?(m=this.evaluator.evalExpression(this.funExpr),this.evaluator.setVariable(d,m),0>=this.evaluator.evalExpression(b)&&(n=!1)):n=!1;n?k+=f:this.evaluator.setVariable(this.evaluator.getVariable(c)-f);f/=2}if(0==k)for(f=e/2,k=
e,m=l;1E-12<Math.abs(f);)this.evaluator.setVariable(this.evaluator.getVariable(c)-f),n=!0,0<this.evaluator.evalExpression(b)?m=this.evaluator.evalExpression(this.funExpr):n=!1,n?k+=-f:this.evaluator.setVariable(this.evaluator.getVariable(c)+f),f/=2;this.evaluator.setVariable(h);return new a.R2(k/Math.abs(e),m)};a.Equation.prototype.Singularity=function(a,b,c,d,h,l,e,f){if(d>=l)return 2;var k=this.evaluator.getVariable(b),m=0;if(1E-12>Math.abs(l-d)||1E-8>Math.abs(l-d)&&Math.abs(e-h)>Math.abs(a))return this.evaluator.setVariable(b,
k),1;var n=(d+l)/2;this.evaluator.setVariable(b,n);var g=this.evaluator.evalExpression(this.funExpr);if(Math.abs(e-h)>a){this.evaluator.setVariable(b,d-1E-6);var r=this.evaluator.evalExpression(this.funExpr),r=(h-r)/1E-6;this.evaluator.setVariable(b,l+1E-6);var u=(this.evaluator.evalExpression(this.funExpr)-e)/1E-6,q=(e-h)/(l-d);if((10>Math.abs(u)||10>Math.abs(r))&&(0<=u&&0<=r||0>=u&&0>=r)&&8*Math.abs(u)<Math.abs(q))return this.evaluator.setVariable(b,k),2}f.x<=g&&g<=f.y||(this.evaluator.setVariable(b,
n),f.x=Math.min(h,g),f.y=Math.max(h,g),d=this.Singularity(a/2,b,c,d,h,n,g,f),this.evaluator.setVariable(b,l),f.x=Math.min(e,g),f.y=Math.max(e,g),a=this.Singularity(a/2,b,c,n,g,l,e,f),m=Math.max(d,a));this.evaluator.setVariable(b,k);return m};a.Equation.prototype.drawAuxFun=function(b,c,d){m=this.evaluator.parser.getVariable("x");h=this.evaluator.parser.getVariable("y");a.rangeOK=1;c="x";d="y";this.of_y&&(c="y",d="x");var l=this.drawif,e=this.evaluator.evalExpression(this.width),f=!1,k=new a.R2(this.space.w/
2+this.space.Ox,this.space.h/2+this.space.Oy),k=this.of_y?k.ix():k.iy(),n=0,g=0,r=0,u=1/this.space.scale,q=u*(this.of_y?-this.space.h+(this.space.h/2+this.space.Oy):-(this.space.w/2+this.space.Ox)),n=0;this.abs_coord&&(q=0,u=1);for(var p=this.of_y?this.space.h+2:this.space.w+2;g<=p;){var s=!0,t=0;this.evaluator.setVariable(c,q);var v=this.evaluator.evalExpression(this.funExpr);if(isNaN(v))s=!1;else{this.evaluator.setVariable(d,v);if(0<this.evaluator.evalExpression(this.drawif)&&a.rangeOK){if(f){var t=
Math.min(n,v),w=Math.max(n,v),w=new a.R2(t,w),t=this.Singularity(u,c,0,q-u,n,q,v,w);0===t?(n<=v?(n=w.x,v=w.y):(v=w.x,n=w.y),t=this.of_y?this.XX(e,n,this.abs_coord):this.YY(e,n,this.abs_coord),n=this.abs_coord?Math.round(v):this.of_y?this.XX(e,v,this.abs_coord):this.YY(e,v,this.abs_coord),this.fillM&&n>k&&(b.lineWidth=1,b.strokeStyle=this.fillM.getColor(),b.beginPath(),this.of_y?(b.moveTo(k+1,this.space.h-g+.5),b.lineTo(n,this.space.h-g+.5)):(b.moveTo(g+.5,k+1),b.lineTo(g+.5,n)),b.stroke()),this.fillP&&
n<k&&(b.lineWidth=1,b.strokeStyle=this.fillP.getColor(),b.beginPath(),this.of_y?(b.moveTo(k-1,this.space.h-g+.5),b.lineTo(n,this.space.h-g+.5)):(b.moveTo(g+.5,k-1),b.lineTo(g+.5,n)),b.stroke()),b.lineWidth=e,b.strokeStyle=this.color.getColor(),b.beginPath(),this.of_y?(b.moveTo(t+.5,this.space.h-r),b.lineTo(n+.5,this.space.h-g)):(b.moveTo(r+.5,t),b.lineTo(g+.5,n)),b.stroke()):(1===t&&(this.evaluator.setVariable(c,q-u),r=this.extrapolate(l,c,d,0,n,u),this.YY(e,r.y,this.abs_coord),this.evaluator.setVariable(c,
q),r=this.extrapolate(l,c,d,0,v,-u),this.YY(e,r.y,this.abs_coord)),this.YY(e,v,this.abs_coord))}else r=this.extrapolateOnSingularity(l,c,d,0,v,-u),this.YY(e,r.y,this.abs_coord),this.YY(e,v,this.abs_coord);n=v}else s=!1;f&&!s&&(this.evaluator.setVariable(c,q-u),this.evaluator.setVariable(d,n),r=this.extrapolate(l,c,d,0,n,u),this.YY(e,r.y,this.abs_coord),this.evaluator.setVariable(c,q))}f=s;q+=u;r=g++}this.evaluator.parser.setVariable("x",m);this.evaluator.parser.setVariable("y",h)};a.Equation.prototype.registerTextField=
function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var b=this;a.onkeydown=function(a){13==a.keyCode&&(b.expresion=b.evaluator.parser.parse(this.value),b.parseExpression(),b.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.round;a.Curve=function(b,c){this.parameter="t";this.parameter_interval=b.evaluator.parser.parse("[0,1]");this.parameter_steps=
b.evaluator.parser.parse("8");this.width=b.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,b,c);(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Curve,a.Graphic);var g,c,e,b,m,h,d,n,r,k,s;a.Curve.prototype.update=function(){g=this.evaluator;c=g.evalExpression(this.parameter_interval);this.paraInf=c[0][0];this.paraSup=c[0][1];this.pSteps=g.evalExpression(this.parameter_steps);this.paraSep=0<this.pSteps?Math.abs(this.paraSup-this.paraInf)/
this.pSteps:0};a.Curve.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Curve.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Curve.prototype.drawAux=function(c,u,l){g=this.evaluator;e=this.space;b=f(g.evalExpression(this.width));c.lineWidth=0<b?b:1E-6;c.lineCap="round";c.lineJoin="round";c.strokeStyle=l.getColor();m=g.getVariable(this.parameter);c.beginPath();g.setVariable(this.parameter,this.paraInf);h=g.evalExpression(this.expresion);
this.exprX=this.abs_coord?f(h[0][0]):f(e.getAbsoluteX(h[0][0]));this.exprY=this.abs_coord?f(h[0][1]):f(e.getAbsoluteY(h[0][1]));this.rotateExp&&(d=a.degToRad(g.evalExpression(this.rotateExp)),n=Math.cos(d),r=Math.sin(d),k=this.exprX*n-this.exprY*r,s=this.exprX*r+this.exprY*n,this.exprX=k,this.exprY=s);c.moveTo(this.exprX+.5,this.exprY+.5);for(l=1;l<=this.pSteps;l++)g.setVariable(this.parameter,this.paraInf+l*this.paraSep),h=g.evalExpression(this.expresion),this.exprX=this.abs_coord?f(h[0][0]):f(e.getAbsoluteX(h[0][0])),
this.exprY=this.abs_coord?f(h[0][1]):f(e.getAbsoluteY(h[0][1])),this.rotateExp&&(k=this.exprX*n-this.exprY*r,s=this.exprX*r+this.exprY*n,this.exprX=k,this.exprY=s),c.lineTo(this.exprX+.5,this.exprY+.5);this.fill&&(c.fillStyle=u.getColor(),c.fill("evenodd"));c.stroke();g.setVariable(this.parameter,m)};a.Curve.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var b=this;a.onkeydown=function(a){13==a.keyCode&&(b.expresion=
b.evaluator.parser.parse(this.value),b.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=2*Math.PI,g=Math.round,c,e,b,m,h,d,n,r,k,s,q,u,l,v;a.Sequence=function(b,c){this.size=b.evaluator.parser.parse("2");this.range=b.evaluator.parser.parse("[1, 100]");a.Graphic.call(this,b,c)};a.extend(a.Sequence,a.Graphic);a.Sequence.prototype.update=function(){c=this.evaluator;b=c.evalExpression(this.expresion);this.exprX=
b[0][0];this.exprY=b[0][1];this.rotateExp&&(m=a.degToRad(c.evalExpression(this.rotateExp)),h=Math.cos(m),d=Math.sin(m),n=this.exprX*h-this.exprY*d,r=this.exprX*d+this.exprY*h,this.exprX=n,this.exprY=r);q=c.evalExpression(this.range);this.rangeInf=q[0][0];this.rangeMax=q[0][1]};a.Sequence.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Sequence.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Sequence.prototype.drawAux=function(a,d){c=
this.evaluator;e=this.space;l=u=Math.ceil(c.evalExpression(this.size)-.4);a.fillStyle=d.getColor();a.beginPath();this.rangeInf>this.rangeMax&&(v=this.rangeInf,this.rangeInf=this.rangeMax,this.rangeMax=v);for(var h=c.getVariable("n"),n=this.rangeInf,m=this.rangeMax;n<=m;n++)c.setVariable("n",n),b=c.evalExpression(this.expresion),this.exprX=b[0][0],this.exprY=b[0][1],k=this.abs_coord?g(this.exprX):g(e.getAbsoluteX(this.exprX)),s=this.abs_coord?g(this.exprY):g(e.getAbsoluteY(this.exprY)),a.beginPath(),
a.arc(k,s,u,0,f,!0),a.fill();a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,k+l,s-l,this.color,this.font,"start","alphabetic",c.evalExpression(this.decimals),this.fixed,!0);c.setVariable("n",h)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=2*Math.PI,g=Math.round,c,e,b,m,h,d,n,r,k,s,q,u;a.Point=function(b,c){this.size=b.evaluator.parser.parse("2");a.Graphic.call(this,b,c)};a.extend(a.Point,a.Graphic);a.Point.prototype.update=function(){c=this.evaluator;
b=c.evalExpression(this.expresion);this.exprX=b[0][0];this.exprY=b[0][1];this.rotateExp&&(m=a.degToRad(c.evalExpression(this.rotateExp)),h=Math.cos(m),d=Math.sin(m),n=this.exprX*h-this.exprY*d,r=this.exprX*d+this.exprY*h,this.exprX=n,this.exprY=r)};a.Point.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Point.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Point.prototype.drawAux=function(a,b){c=this.evaluator;e=this.space;q=g(c.evalExpression(this.size));
u=q+1;a.fillStyle=b.getColor();k=this.abs_coord?g(this.exprX):g(e.getAbsoluteX(this.exprX));s=this.abs_coord?g(this.exprY):g(e.getAbsoluteY(this.exprY));a.beginPath();a.arc(k,s,q,0,f,!0);a.fill();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,k+u+1,s-u,this.color,this.font,"start","alphabetic",c.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.round,g=2*Math.PI,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A;a.Segment=
function(b,c){this.width=b.evaluator.parser.parse("1");this.size=b.evaluator.parser.parse("2");a.Graphic.call(this,b,c)};a.extend(a.Segment,a.Graphic);a.Segment.prototype.update=function(){c=this.evaluator;b=c.evalExpression(this.expresion);this.endPoints=[];for(var l=0,e=b.length;l<e;l++)this.endPoints[l]={x:b[l][0],y:b[l][1]};if(this.rotateExp)for(m=a.degToRad(c.evalExpression(this.rotateExp)),h=Math.cos(m),d=Math.sin(m),l=0,e=this.endPoints.length;l<e;l++)n=this.endPoints[l].x*h-this.endPoints[l].y*
d,r=this.endPoints[l].x*d+this.endPoints[l].y*h,this.endPoints[l].x=n,this.endPoints[l].y=r};a.Segment.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Segment.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Segment.prototype.drawAux=function(a,b,d){c=this.evaluator;e=this.space;k=f(c.evalExpression(this.width));a.lineWidth=0<k?k:1E-6;l=c.evalExpression(this.size);0>l&&(l=0);a.fillStyle=b.getColor();a.strokeStyle=d.getColor();a.lineCap=
"round";s=10+a.lineWidth;v=0==a.lineWidth%2?0:.5;this.abs_coord?(p=f(this.endPoints[0].x),t=f(this.endPoints[0].y),w=f(this.endPoints[1].x),A=f(this.endPoints[1].y)):(p=f(e.getAbsoluteX(this.endPoints[0].x)),t=f(e.getAbsoluteY(this.endPoints[0].y)),w=f(e.getAbsoluteX(this.endPoints[1].x)),A=f(e.getAbsoluteY(this.endPoints[1].y)));a.beginPath();a.moveTo(p+v,t+v);a.lineTo(w+v,A+v);a.stroke();a.beginPath();a.arc(p,t,l,0,g,!0);a.arc(w,A,l,0,g,!0);a.fill();this.text!=[""]&&(q=parseInt((p+w)/2)-3,u=parseInt((t+
A)/2)+3,this.uber.drawText.call(this,a,this.text,q+s,u-s,this.color,this.font,"start","alphabetic",c.evalExpression(this.decimals),this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.floor,g=Math.round,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A;a.Arrow=function(b,c){this.width=b.evaluator.parser.parse("5");this.size=b.evaluator.parser.parse("2");this.spear=b.evaluator.parser.parse("8");this.arrow=new a.Color("ee0022");a.Graphic.call(this,b,c)};a.extend(a.Arrow,
a.Graphic);a.Arrow.prototype.update=function(){c=this.evaluator;e=c.evalExpression(this.expresion);this.endPoints=[];for(var l=0,f=e.length;l<f;l++)this.endPoints[l]={x:e[l][0],y:e[l][1]};if(this.rotateExp)for(b=a.degToRad(c.evalExpression(this.rotateExp)),m=Math.cos(b),h=Math.sin(b),l=0,f=this.endPoints.length;l<f;l++)d=this.endPoints[l].x*m-this.endPoints[l].y*h,n=this.endPoints[l].x*h+this.endPoints[l].y*m,this.endPoints[l].x=d,this.endPoints[l].y=n};a.Arrow.prototype.draw=function(){this.uber.draw.call(this,
this.arrow,this.color)};a.Arrow.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.arrow,this.trace)};a.Arrow.prototype.drawAux=function(b,d,h){c=this.evaluator;r=this.space;c.evalExpression(this.size);q=c.evalExpression(this.width);0>q&&(q=0);u=Math.ceil(q/2);l=r.scale;this.vect=new a.Vector2D(this.endPoints[1].x-this.endPoints[0].x,this.endPoints[1].y-this.endPoints[0].y);v=this.vect.vectorLength();this.angle=this.vect.angleBetweenVectors(a.Vector2D.AXIS_X);b.fillStyle=d.getColor();
b.strokeStyle=h.getColor();b.lineWidth=2;this.abs_coord?(p=g(this.endPoints[0].x),t=g(this.endPoints[0].y),w=g(this.endPoints[1].x),A=g(this.endPoints[1].y)):(p=g(r.getAbsoluteX(this.endPoints[0].x)),t=g(r.getAbsoluteY(this.endPoints[0].y)),w=g(r.getAbsoluteX(this.endPoints[1].x)),A=g(r.getAbsoluteY(this.endPoints[1].y)));d=c.evalExpression(this.spear);0>d&&(d=0);b.save();b.translate(p,t,v);this.abs_coord?0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?b.rotate(this.angle):b.rotate(-this.angle):
(v*=l,0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?b.rotate(-this.angle):b.rotate(this.angle));b.beginPath();b.moveTo(-u,f(-u));b.lineTo(f(v-d-q),f(-u));b.lineTo(f(v-2*d),f(-d-u));b.lineTo(f(v),0);b.lineTo(f(v-2*d),f(d+u));b.lineTo(f(v-d-q),f(u));b.lineTo(-u,f(u));b.closePath();b.stroke();b.fill();b.restore();this.text!=[""]&&(k=parseInt((p+w)/2)-3,s=parseInt((t+A)/2)+3,this.uber.drawText.call(this,b,this.text,k,s,h,this.font,"start","alphabetic",c.evalExpression(this.decimals),
this.fixed,!0))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.round,g,c,e,b,m,h,d,n,r,k,s,q;a.Polygon=function(b,c){this.width=b.evaluator.parser.parse("1");this.fill="";a.Graphic.call(this,b,c);this.endPoints=[]};a.extend(a.Polygon,a.Graphic);a.Polygon.prototype.update=function(){g=this.evaluator;e=g.evalExpression(this.expresion);for(var c=0,l=e.length;c<l;c++)this.endPoints[c]={x:e[c][0],y:e[c][1]};if(this.rotateExp)for(b=a.degToRad(g.evalExpression(this.rotateExp)),
m=Math.cos(b),h=Math.sin(b),c=0,l=this.endPoints.length;c<l;c++)d=this.endPoints[c].x*m-this.endPoints[c].y*h,n=this.endPoints[c].x*h+this.endPoints[c].y*m,this.endPoints[c].x=d,this.endPoints[c].y=n};a.Polygon.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Polygon.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Polygon.prototype.drawAux=function(a,b,d){g=this.evaluator;c=this.space;r=f(g.evalExpression(this.width));a.lineWidth=0<
r?r:1E-6;a.strokeStyle=d.getColor();a.lineCap="round";a.lineJoin="round";k=0<r?.5:0;s=this.abs_coord?f(this.endPoints[0].x):f(c.getAbsoluteX(this.endPoints[0].x));q=this.abs_coord?f(this.endPoints[0].y):f(c.getAbsoluteY(this.endPoints[0].y));a.beginPath();a.moveTo(s+k,q+k);d=1;for(var h=this.endPoints.length;d<h;d++)s=this.abs_coord?f(this.endPoints[d].x):f(c.getAbsoluteX(this.endPoints[d].x)),q=this.abs_coord?f(this.endPoints[d].y):f(c.getAbsoluteY(this.endPoints[d].y)),a.lineTo(s+k,q+k);this.fill&&
(a.fillStyle=b.getColor(),a.fill());a.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.round,g,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z;a.Arc=function(b,c){this.width=b.evaluator.parser.parse("1");this.fill="";this.center=b.evaluator.parser.parse("(0,0)");this.radius=b.evaluator.parser.parse("1");this.init="0";this.end="90";a.Graphic.call(this,b,c);this.init.match(/^_\(/)&&(this.initFlag=!0,this.init=this.init.substring(1));this.end.match(/^_\(/)&&(this.endFlag=
!0,this.end=this.end.substring(1));this.initExpr=b.evaluator.parser.parse(this.init);this.endExpr=b.evaluator.parser.parse(this.end)};a.extend(a.Arc,a.Graphic);a.Arc.prototype.update=function(){g=this.evaluator;c=g.evalExpression(this.center);this.exprX=c[0][0];this.exprY=c[0][1];e=0;this.rotateExp&&(e=a.degToRad(g.evalExpression(this.rotateExp)),b=Math.cos(e),m=Math.sin(e),h=this.exprX*b-this.exprY*m,d=this.exprX*m+this.exprY*b,this.exprX=h,this.exprY=d);var f=g.evalExpression(this.initExpr),p=g.evalExpression(this.endExpr);
"(expr)"==this.initExpr.type&&"(expr)"==this.endExpr.type||"[expr]"==this.initExpr.type&&"[expr]"==this.endExpr.type||"(expr)"==this.initExpr.type&&"[expr]"==this.endExpr.type||"[expr]"==this.initExpr.type&&"(expr)"==this.endExpr.type?(n=f[0][0],r=f[0][1],k=p[0][0],s=p[0][1],this.vectors?this.abs_coord&&(r=-r,s=-s):this.abs_coord?(n-=this.exprX,r=-r+this.exprY,k-=this.exprX,s=-s+this.exprY):(n-=this.exprX,r-=this.exprY,k-=this.exprX,s-=this.exprY),q=0==n?0>r?-Math.PI/2:Math.PI/2:Math.acos(1*n/Math.sqrt(n*
n+r*r)),u=0==k?0>s?-Math.PI/2:Math.PI/2:Math.acos(1*k/Math.sqrt(k*k+s*s)),q+=e,u+=e,0<n&&0<r&&this.abs_coord&&(q=2*Math.PI-q),0<n&&0>r&&!this.abs_coord&&(q=2*Math.PI-q),0>n&&0>r&&!this.abs_coord&&(q=2*Math.PI-q),0>n&&0<r&&this.abs_coord&&(q=2*Math.PI-q),0<k&&0<s&&this.abs_coord&&(u=2*Math.PI-u),0<k&&0>s&&!this.abs_coord&&(u=2*Math.PI-u),0>k&&0>s&&!this.abs_coord&&(u=2*Math.PI-u),0>k&&0<s&&this.abs_coord&&(u=2*Math.PI-u),l=Math.min(q,u),v=Math.max(q,u),q=l,u=v,u-q>Math.PI&&this.abs_coord&&(q=v,u=l),
u-q<=Math.PI&&!this.abs_coord&&(q=v,u=l),this.iniAng=q,this.endAng=u,this.drawPoints=!0):(this.iniAng=a.degToRad(f)+e,this.endAng=a.degToRad(p)+e,this.drawAngle=!0)};a.Arc.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Arc.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Arc.prototype.drawAux=function(a,b,c){g=this.evaluator;p=this.space;A=g.evalExpression(this.radius);0>A&&(A=0);z=f(g.evalExpression(this.width));a.lineWidth=0<z?z:
1E-6;a.lineCap="round";a.strokeStyle=c.getColor();this.drawAngle?(this.abs_coord?(t=f(this.exprX),w=f(this.exprY)):(t=f(p.getAbsoluteX(this.exprX)),w=f(p.getAbsoluteY(this.exprY)),A*=p.scale,this.iniAng=-this.iniAng,this.endAng=-this.endAng),this.iniAng>this.endAng&&(C=this.iniAng,this.iniAng=this.endAng,this.endAng=C)):this.drawPoints&&(this.abs_coord?(t=f(this.exprX),w=f(this.exprY)):(t=f(p.getAbsoluteX(this.exprX)),w=f(p.getAbsoluteY(this.exprY)),A*=p.scale,this.iniAng=-this.iniAng,this.endAng=
-this.endAng));this.fill&&(a.fillStyle=b.getColor(),a.beginPath(),a.moveTo(t,w),a.arc(t,w,A,this.iniAng,this.endAng,void 0),a.fill());a.beginPath();a.arc(t,w,A,this.iniAng,this.endAng,void 0);a.stroke();this.text!=[""]&&this.uber.drawText.call(this,a,this.text,t+4,w-2,this.color,this.font,"start","alphabetic",g.evalExpression(this.decimals),this.fixed,!0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t;a.Text=function(b,c){this.width=
b.evaluator.parser.parse("0");a.Graphic.call(this,b,c);this.align||(this.align="start");this.ascent=this.fontSize-Math.ceil(this.fontSize/7)-(this.font.match("Courier")?3:0);this.abs_coord=!0};a.extend(a.Text,a.Graphic);a.Text.prototype.update=function(){f=this.evaluator;g=f.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1];this.rotateExp&&(c=a.degToRad(f.evalExpression(this.rotateExp)),e=Math.cos(c),b=Math.sin(c),m=this.exprX*e-this.exprY*b,h=this.exprX*b+this.exprY*e,this.exprX=
m,this.exprY=h)};a.Text.prototype.draw=function(){this.uber.draw.call(this,this.color)};a.Text.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.color)};a.Text.prototype.drawAux=function(a,b){t=this.evaluator.evalExpression(this.decimals);"rtfNode"===this.text.type?(k=this.text,this.ascent=0):k=this.splitText(this.text.toString(t,this.fixed).split("\\n"));this.text!=[""]&&this.uber.drawText.call(this,a,k,parseInt(this.exprX)+5,parseInt(this.exprY)+this.ascent,b,this.font,this.align,
"alphabetic",t,this.fixed)};a.Text.prototype.splitText=function(a){f=this.evaluator;d=f.evalExpression(this.width);k=[];this.ctx.font=this.font;if(20<=d&&"undefined"!=a.type){for(var b=0,c=a.length;b<c;b++)n=a[b],r=this.ctx.measureText(n).width,r>d?k=k.concat(this.splitWords(n,d)):k.push(n);s=Math.floor(1.2*this.fontSize)*k.length;f.setVariable("_Text_H_",s);return k}f.setVariable("_Text_H_",0);f.setVariable("_Text_W_",1E3);return a};a.Text.prototype.splitWords=function(a,b){q=a;u=[];l="";p=0;for(var c,
d=0,h=a.length;d<h;d++)v=q.charAt(d)," "===v&&(lastIndexOfWhite=d),l+=v,Math.round(this.ctx.measureText(l).width)>b&&(c=a.substring(p,d+1)," "!==v&&(-1===c.indexOf(" ")?(lastIndexOfWhite=d,d--):d=lastIndexOfWhite),u.push(a.substring(p,lastIndexOfWhite)),l="",p=d+1);u.push(a.substring(p));return u};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.round,g,c,e,b,m,h,d,n,r,k,s,q,u,l;a.Image=function(b,c){this.file="";this.inirot=b.evaluator.parser.parse("0");this.pattern=
!1;a.Graphic.call(this,b,c);this.img=new Image;this.scaleY=this.scaleX=1;this.update()};a.extend(a.Image,a.Graphic);a.Image.prototype.update=function(){g=this.evaluator;c=g.evalExpression(this.expresion);this.exprX=c[0][0];this.exprY=c[0][1];this.rotateExp&&(e=a.degToRad(g.evalExpression(this.rotateExp)),b=Math.cos(e),m=Math.sin(e),h=this.exprX*b-this.exprY*m,d=this.exprX*m+this.exprY*b,this.exprX=h,this.exprY=d);4<=c[0].length&&(this.centered=!0,this.scaleX=c[0][2],0==this.scaleX&&(this.scaleX=1E-5),
this.scaleY=c[0][3],0==this.scaleY&&(this.scaleY=1E-5),c[0][4]&&(this.pattern=1==c[0][4]?!0:!1));c[1]&&2==c[1].length&&(this.centered=!0,this.scaleX=c[1][0],0==this.scaleX&&(this.scaleX=1E-5),this.scaleY=c[1][1],0==this.scaleY&&(this.scaleY=1E-5));if((n=g.evalExpression(this.file))||""==n)this.img=this.parent.getImage(n)};a.Image.prototype.draw=function(){this.uber.draw.call(this)};a.Image.prototype.drawTrace=function(){this.uber.drawTrace.call(this)};a.Image.prototype.drawAux=function(b){g=this.evaluator;
r=this.space;this.img&&this.img.ready&&this.img.complete&&(k=this.centered?0:f(this.img.width/2),s=this.centered?0:f(this.img.height/2),q=this.abs_coord?f(this.exprX):f(r.getAbsoluteX(this.exprX)),u=this.abs_coord?f(this.exprY):f(r.getAbsoluteY(this.exprY)),l=a.degToRad(-g.evalExpression(this.inirot)),b.save(),b.translate(q+k,u+s),b.rotate(l),this.opacity&&(b.globalAlpha=g.evalExpression(this.opacity)),this.pattern?(b.fillStyle=b.createPattern(this.img,"repeat"),b.drawImage(this.img,-this.img.width/
2*this.scaleX,-this.img.height/2*this.scaleY),b.fillRect(0,0,this.img.width*this.scaleX,this.img.height*this.scaleY)):(b.scale(this.scaleX,this.scaleY),b.drawImage(this.img,-this.img.width/2,-this.img.height/2)),b.restore())};return a}(descartesJS||{}),descartesJS=function(a){function f(a,b,c){d=4*(b+c*a.width);return{r:a.data[d],g:a.data[d+1],b:a.data[d+2],a:a.data[d+3]}}if(a.loadLib)return a;var g,c,e,b,m,h,d;a.Fill=function(b,c){a.Graphic.call(this,b,c)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=
function(){g=this.evaluator.evalExpression(this.expresion);this.exprX=g[0][0];this.exprY=g[0][1]};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Fill.prototype.drawTrace=function(){};a.Fill.prototype.drawAux=function(a,g){g.getColor();imageData=this.ctx.getImageData(0,0,this.space.w,this.space.h);this.abs_coord?(c=parseInt(this.exprX),e=parseInt(this.exprY)):(c=parseInt(this.space.getAbsoluteX(this.exprX)),e=parseInt(this.space.getAbsoluteY(this.exprY)));if(!(0>
c||0>e||c>=this.space.w||e>=this.space.h)){b=[{x:c,y:e}];for(h=f(imageData,c,e);0<b.length;){m=b.pop();c=m.x;e=m.y;var k=f(imageData,c,e);if(h.r===k.r&&h.g===k.g&&h.b===k.b&&h.a===k.a){var k=imageData,s=g;d=4*(c+e*k.width);k.data[d+0]=s.r;k.data[d+1]=s.g;k.data[d+2]=s.b;k.data[d+3]=255*s.a;0<c&&b.push({x:c-1,y:e});c<imageData.width-1&&b.push({x:c+1,y:e});b.push({x:c,y:e-1});b.push({x:c,y:e+1})}}this.ctx.putImageData(imageData,0,0)}};return a}(descartesJS||{}),descartesJS=function(a,f){if(a.loadLib)return a;
var g=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,c;a.Macro=function(c,b){this.hasExpresion=!1;this.inirot=c.evaluator.parser.parse("0");this.inipos=c.evaluator.parser.parse("(0,0)");a.Graphic.call(this,c,b);for(var m in b)"expresion"==m&&(this.hasExpresion=!0),b.hasOwnProperty(m)&&(this[m]=b[m]);this.graphics=[];m=c.lessonParser;var h=new a.Tokenizer;if(this.hasExpresion){"'"!==this.expresion.charAt(0)&&(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);
var d=this.evaluator.evalExpression(this.expresion),n;d&&((n=document.getElementById(d))&&"descartes/macro"==n.type?n=n.text:(n=a.openExternalFile(d))&&!n.match(/tipo_de_macro/g)&&(n=null));var r,k;if(n){k=n.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,
"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").replace(/\r/g,"").split("\n");n=[];for(var d=0,s=k.length;d<s;d++)if(r=k[d].indexOf("="),-1!==r){r=m.split(k[d]);for(var q=0,u=r.length;q<u;q++)r[q]&&1<r.length&&("id"!==f[r[q][0]]&&"type"!==f[r[q][0]]||n.push(r))}for(var l,v,d=0,s=n.length;d<s;d++)for(u=(q=n[d]||[],q[0])&&"id"===q[0][0],k=0,r=q.length;k<r;k++)if(l=q[k][0].indexOf("."),-1===l||u?l=f[q[k][0]]:(l=f[q[k][0].substring(l+1)],q[k][0]=
this.name+"."+q[k][0]),!("font"===l||("fill"===l||"color"===l||"arrow"===l)&&"("!==q[k][1].charAt(0)||"file"===l&&q[k][1].match(g)||"id"!==l&&void 0!==f[q[k][1]]))if("text"==l)if(q[k][1].match(/\{\\rtf1/)){l=q[k][1];var p=this;v=function(a,b){for(var c=h.tokenize(b.replace(/\&squot;/g,"'")),d=0,l=c.length;d<l;d++)"identifier"!=c[d].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
c[d].value+"-")||(c[d].value=p.name+"."+c[d].value);return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+h.flatTokens(c)};l=l.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.'\+\-]*)/gi,v);l=l.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.'\+\-]*)/gi,v);q[k][1]=l}else{v=m.parseText(q[k][1]).textElementsMacros;for(var t=0,w=v.length;t<w;t++){l=h.tokenize(v[t].replace(/\&squot;/g,"'"));for(var A=0,C=l.length;A<C;A++)"identifier"!==l[A].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
l[A].value+"-")||(l[A].value=this.name+"."+l[A].value);l=h.flatTokens(l).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");v[t]=l.substring(1,l.length-1)}q[k][1]=v.join("")}else{v=q[k][1].replace(/\&squot;/g,"'").split(";");t=0;for(w=v.length;t<w;t++){l=h.tokenize(v[t].replace(/\\n/g,";"));A=0;for(C=l.length;A<C;A++)"identifier"!==l[A].type||"-rnd-pi-e-sqr-ra\u00edz-sqrt-exp-log-log10-abs-ent-sgn-ind-sen-sin-cos-tan-cot-sec-csc-senh-sinh-cosh-tanh-coth-sech-csch-asen-asin-acos-atan-min-max-_Num_-_Trace_-_Stop_Audios_-esCorrecto-escorrecto-_GetValues_-_GetMatrix_-_Save_-_Open_-_SaveState_-_OpenState_-_AnchoDeCadena_-_Rojo_-_Verde_-_Azul_-".match("-"+
l[A].value+"-")||(l[A].value=this.name+"."+l[A].value);v[t]=h.flatTokens(l)}q[k][1]=v.join(";")}d=0;for(s=n.length;d<s;d++)if(n[d][0]){q="";u=!1;k=0;for(r=n[d].length;k<r;k++)"type"===f[n[d][k][0]]&&(q="espacio='"+this.spaceID+"' ",u=!0),q=q+n[d][k][0]+"='"+n[d][k][1]+"' ";n[d]=q;u?this.graphics.push(m.parseGraphic(n[d],this.abs_coord,this.background,this.inirot)):m.parseAuxiliar(n[d])}}}};a.extend(a.Macro,a.Graphic);a.Macro.prototype.update=function(){c=this.evaluator.evalExpression(this.inipos);
this.iniPosX=c[0][0];this.iniPosY=c[0][1]};a.Macro.prototype.drawAux=function(a){for(var b=0,c=this.graphics.length;b<c;b++)this.graphics[b]&&(a.save(),this.graphics[b].abs_coord?a.translate(this.iniPosX,this.iniPosY):a.translate(this.iniPosX*this.space.scale,-this.iniPosY*this.space.scale),this.graphics[b].draw(),a.restore())};return a}(descartesJS||{},babel),descartesJS=function(a){if(a.loadLib)return a;a.Generic=function(f,g){this.width=f.evaluator.parser.parse("1");a.Graphic.call(this,f,g)};a.extend(a.Generic,
a.Graphic);a.Generic.prototype.update=function(){};a.Generic.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Generic.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Generic.prototype.drawAux=function(a,g,c){var e=this.evaluator.getDefinition(this.expresionString);e&&e.draw(a,g,c,this)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.sqrt,g=Math.sin,c=Math.cos,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t;a.norm3D=
function(a){return f(a.x*a.x+a.y*a.y+a.z*a.z)};a.normalize3D=function(b){e=a.norm3D(b);if(0===e)return{x:0,y:0,z:0};if(1===e)return{x:b.x,y:b.y,z:b.z};e=1/e;return{x:b.x*e,y:b.y*e,z:b.z*e}};a.dotProduct3D=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};a.crossProduct3D=function(a,b){return{x:a.y*b.z-a.z*b.y,y:a.z*b.x-a.x*b.z,z:a.x*b.y-a.y*b.x}};a.scalarProduct3D=function(a,b){return{x:a.x*b,y:a.y*b,z:a.z*b}};a.subtract3D=function(a,b){return{x:a.x-b.x,y:a.y-b.y,z:a.z-b.z}};a.add3D=function(a,b){return{x:a.x+
b.x,y:a.y+b.y,z:a.z+b.z}};a.equals3DEpsilon=function(a,b,c){return Math.abs(a.x-b.x)<=c&&Math.abs(a.y-b.y)<=c&&Math.abs(a.z-b.z)<=c};a.Vector4D=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=d||0};a.Matrix4x4=function(a,b,c,d,h,l,e,f,k,n,m,g,r,u,q,p){this.a00=a||0;this.a01=b||0;this.a02=c||0;this.a03=d||0;this.a10=h||0;this.a11=l||0;this.a12=e||0;this.a13=f||0;this.a20=k||0;this.a21=n||0;this.a22=m||0;this.a23=g||0;this.a30=r||0;this.a31=u||0;this.a32=q||0;this.a33=p||0};a.Matrix4x4.prototype.setIdentity=
function(){this.a00=1;this.a10=this.a03=this.a02=this.a01=0;this.a11=1;this.a21=this.a20=this.a13=this.a12=0;this.a22=1;this.a32=this.a31=this.a30=this.a23=0;this.a33=1;return this};a.Matrix4x4.prototype.multiplyVector4=function(b){return new a.Vector4D(b.x*this.a00+b.y*this.a10+b.z*this.a20+b.w*this.a30,b.x*this.a01+b.y*this.a11+b.z*this.a21+b.w*this.a31,b.x*this.a02+b.y*this.a12+b.z*this.a22+b.w*this.a32,b.x*this.a03+b.y*this.a13+b.z*this.a23+b.w*this.a33)};a.Matrix4x4.prototype.translate=function(b){return new a.Matrix4x4(this.a00,
this.a01,this.a02,this.a03,this.a10,this.a11,this.a12,this.a13,this.a20,this.a21,this.a22,this.a23,this.a00*b.x+this.a10*b.y+this.a20*b.z+this.a30,this.a01*b.x+this.a11*b.y+this.a21*b.z+this.a31,this.a02*b.x+this.a12*b.y+this.a22*b.z+this.a32,this.a03*b.x+this.a13*b.y+this.a23*b.z+this.a33)};a.Matrix4x4.prototype.rotateX=function(d){b=g(d);m=c(d);k=this.a10;s=this.a11;q=this.a12;u=this.a13;l=this.a20;v=this.a21;p=this.a22;t=this.a23;return new a.Matrix4x4(this.a00,this.a01,this.a02,this.a03,k*m+l*
b,s*m+v*b,q*m+p*b,u*m+t*b,k*-b+l*m,s*-b+v*m,q*-b+p*m,u*-b+t*m,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateY=function(e){b=g(e);m=c(e);h=this.a00;d=this.a01;n=this.a02;r=this.a03;l=this.a20;v=this.a21;p=this.a22;t=this.a23;return new a.Matrix4x4(h*m+l*-b,d*m+v*-b,n*m+p*-b,r*m+t*-b,this.a10,this.a11,this.a12,this.a13,h*b+l*m,d*b+v*m,n*b+p*m,r*b+t*m,this.a30,this.a31,this.a32,this.a33)};a.Matrix4x4.prototype.rotateZ=function(l){b=g(l);m=c(l);h=this.a00;d=this.a01;n=this.a02;r=this.a03;
k=this.a10;s=this.a11;q=this.a12;u=this.a13;return new a.Matrix4x4(h*m+k*b,d*m+s*b,n*m+q*b,r*m+u*b,h*-b+k*m,d*-b+s*m,n*-b+q*m,r*-b+u*m,this.a20,this.a21,this.a22,this.a23,this.a30,this.a31,this.a32,this.a33)};return a}(descartesJS||{}),descartesJS=function(a){function f(a){0!==parseInt(this.size)&&(a.lineWidth=1,a.fillStyle=this.backColor,a.strokeStyle=this.frontColor,a.beginPath(),a.arc(this.newV[0].x,this.newV[0].y,this.size+.5,0,m),a.fill(),a.stroke())}function g(a,b){a.lineCap="round";a.lineJoin=
"round";a.lineWidth=1;a.beginPath();a.moveTo(this.newV[0].x,this.newV[0].y);for(var c=1,d=this.newV.length;c<d;c++)a.lineTo(this.newV[c].x,this.newV[c].y);a.closePath();"color"===this.model?(a.fillStyle=0<=this.direction?this.backColor:this.frontColor,a.strokeStyle=a.fillStyle,a.stroke(),a.fill()):"light"===this.model||"metal"===this.model?(a.fillStyle=0<=this.direction?b.computeColor(this.backColor,this,"metal"===this.model):b.computeColor(this.frontColor,this,"metal"===this.model),a.strokeStyle=
a.fillStyle,a.stroke(),a.fill()):"wire"===this.model&&(a.lineWidth=1.5,a.strokeStyle=this.frontColor,a.stroke());this.edges&&"wire"!==this.model&&(a.strokeStyle="#808080",a.stroke())}function c(a){s=this.evaluator.getVariable(this.family);this.evaluator.setVariable(this.family,this.familyValue);this.drawText(a,this.text,this.newV[0].x,this.newV[0].y+this.displace,this.frontColor,this.font,"left","alphabetic",this.decimals,this.fixed,!0);this.evaluator.setVariable(this.family,s)}function e(a){a.lineCap=
"round";a.lineJoin="round";a.lineWidth=this.lineWidth;a.strokeStyle=this.frontColor;a.beginPath();a.moveTo(this.newV[0].x,this.newV[0].y);a.lineTo(this.newV[1].x,this.newV[1].y);a.stroke()}function b(b,c,e){h=a.subtract3D(b,c);d=a.subtract3D(b,e);return a.normalize3D(a.crossProduct3D(h,d))}if(a.loadLib)return a;var m=2*Math.PI,h,d,n,r,k,s;a.Primitive3D=function(a,d){this.space=d;for(var h in a)a.hasOwnProperty(h)&&(this[h]=a[h]);this.newV=[];this.spaceVertices=[];"vertex"===this.type?this.draw=f:
"face"===this.type?(this.normal=b(this.vertices[0],this.vertices[1],this.vertices[2]),this.draw=g):"text"===this.type?(this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10,this.draw=c):"edge"===this.type&&(this.draw=e);this.isText&&(this.computeDepth=function(){this.newV=this.vertices;this.depth=this.vertices[0].z;this.average=this.vertices[0]})};a.Primitive3D.prototype.computeDepth=function(c){this.average={x:0,y:0,z:0};this.removeDoubles();this.normal={x:0,y:1,
z:0};this.direction={x:1,y:0,z:0};for(var d=0,h=this.vertices.length;d<h;d++)this.newV[d]=c.rotateVertex(this.vertices[d]),this.spaceVertices[d]=c.rotateVertex(this.vertices[d]),this.average.x+=this.newV[d].x,this.average.y+=this.newV[d].y,this.average.z+=this.newV[d].z;this.average=a.scalarProduct3D(this.average,1/h);this.averageP=c.project(this.average);this.depth=this.averageP.z;2<this.vertices.length&&(this.normal=b(this.newV[0],this.newV[1],this.newV[2]),this.direction=a.dotProduct3D(this.normal,
a.normalize3D(c.eye)));d=0;for(h=this.vertices.length;d<h;d++)this.newV[d]=c.project(this.newV[d])};var q;a.Primitive3D.prototype.removeDoubles=function(){if("edge"!==this.type){q=[];for(var a=0,b=this.vertices.length;a<b;a++)this.vertices[a].x===this.vertices[(a+1)%b].x&&this.vertices[a].y===this.vertices[(a+1)%b].y&&this.vertices[a].z===this.vertices[(a+1)%b].z&&this.vertices[a].w===this.vertices[(a+1)%b].w||q.push(this.vertices[a]);0===q.length&&q.push(this.vertices[0]);this.vertices=q}};a.Primitive3D.prototype.drawText=
function(b,c,d,h,e,f,m,g,q,s,E){if("rtfNode"==c.type)b.fillStyle=e,b.strokeStyle=e,b.textBaseline="alphabetic",c.draw(b,d,h,q,s,m,E);else for("simpleText"===c.type&&(c=c.toString(q,s).split("\\n")),d+=f.match("Arial")?-2:f.match("Times")?-2:0,n=this.evaluator,b.fillStyle=a.getColor(n,e),b.font=f,b.textAlign=m,b.textBaseline=g,r=1.2*this.fontSize||0,e=0,f=c.length;e<f;e++)k=c[e],this.border&&b.strokeText(k,d,h+r*e),b.fillText(k,d,h+r*e)};a.Primitive3D.prototype.splitFace=function(b){if(this.intersects(b)){for(var c=
null,d=null,h=0,e=0,f=0,k=b.vertices.length;f<k;f++){var n=this.intersection(b.vertices[f],b.vertices[(f+1)%k]);if(null!==n)if(null===c){if(c=n,h=f,2===b.vertices.length){d=c;break}}else if(!a.equals3DEpsilon(n,c,1E-8)){d=n;e=f;break}}if(null!==c&&null!==d){var f=this.isInterior(c)||this.isInterior(d),m=null,g=null;if(!f&&3<=b.vertices.length)for(var k=0,r=this.vertices.length;k<r;k++)if(n=b.intersection(this.vertices[k],this.vertices[(k+1)%r]),null!==n)if(null===m)m=n;else if(!a.equals3DEpsilon(n,
m,1E-8)){g=n;break}if(f||null!==m&&null!==g&&b.isInterior(m)&&b.isInterior(g)){g=!0;r=b.vertices;m=n=null;if(2===r.length)a.equals(c,r[0],1E-8)||a.equals(c,r[1],1E-8)?g=!1:(n=[],n[0]=r[0],n[1]=c,m=[],m[0]=c,m[1]=r[1]);else for(var n=[],m=[],q=0,f=k=0;f<r.length;f++)f<h?n[q++]=r[f]:f==h?(n[q++]=r[f],n[q++]=c,m[k++]=c):f<e?m[k++]=r[f]:f==e?(m[k++]=r[f],m[k++]=d,n[q++]=d):n[q++]=r[f];if(g)return c=[],c[0]=new a.Primitive3D({vertices:n,type:"face",frontColor:b.frontColor,backColor:b.backColor,edges:b.edges,
model:b.model},this.space),c[0].normal=b.normal,c[1]=new a.Primitive3D({vertices:m,type:"face",frontColor:b.frontColor,backColor:b.backColor,edges:b.edges,model:b.model},this.space),c[1].normal=b.normal,c}}}return[b]};a.Primitive3D.prototype.intersects=function(a){return this.intersectsPlane(a)&&a.intersectsPlane(this)};a.Primitive3D.prototype.intersectsPlane=function(b){var c=a.dotProduct3D(b.vertices[0],b.normal),d=a.dotProduct3D(this.vertices[0],b.normal);if(1E-8>Math.abs(c-d))return!0;for(var h=
1,e=this.vertices.length;h<e;h++){var f=a.dotProduct3D(this.vertices[h],b.normal);if(1E-8>Math.abs(c-f)||f>c&&d<c||f<c&&d>c)return!0}return!1};a.Primitive3D.prototype.intersection=function(b,c){if(0<this.vertices.length){var d=a.subtract3D(c,b),h=a.dotProduct3D(d,this.normal);if(0!==h&&(h=a.dotProduct3D(a.subtract3D(this.vertices[0],b),this.normal)/h,-1E-8<h&&1.00000001>h))return a.add3D(b,a.scalarProduct3D(d,h))}return null};a.Primitive3D.prototype.isInterior=function(b){if(0<this.vertices.length)for(var c=
0,d=a.subtract3D(this.vertices[0],b),h=0,e=this.vertices.length;h<e;h++){var f=a.subtract3D(this.vertices[(h+1)%e],b),k=a.dotProduct3D(a.crossProduct3D(d,f),this.normal);if(1E-8>Math.abs(k)){if(0>a.dotProduct3D(d,f))break}else{if(0>c&&0<k||0<c&&0>k)return!1;d=f;c=k}}return!0};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f={x:0,y:0,z:0},g,c,e,b,m,h;a.Graphic3D=function(b,c){this.parent=b;this.evaluator=b.evaluator;var d=b.evaluator.parser;this.spaceID="E0";this.background=
!1;this.type="";this.color=new a.Color("eeffaa");this.backcolor=new a.Color("6090a0");this.Nu=this.evaluator.parser.parse("7");this.Nv=this.evaluator.parser.parse("7");this.drawif=d.parse("1");this.abs_coord=!1;this.family="";this.family_interval=d.parse("[0,1]");this.family_steps=d.parse("8");this.font="Monospaced,PLAIN,12";this.fixed=!0;this.text="";this.decimals=d.parse("2");this.inirot="(0,0,0)";this.inirotEuler=!1;this.inipos=d.parse("(0,0,0)");this.endrot="(0,0,0)";this.endrotEuler=!1;this.endpos=
d.parse("(0,0,0)");this.model="color";for(var h in c)c.hasOwnProperty(h)&&(this[h]=c[h]);void 0==this.expresion&&"macro"!=this.type&&(this.expresion=d.parse("(0,0)"));this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.font=a.convertFont(this.font);this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?parseInt(this.fontSize[1]):10;this.inirot.match("Euler")&&(this.inirot=this.inirot.replace("Euler",""),
this.inirotEuler=!0);this.endrot.match("Euler")&&(this.endrot=this.endrot.replace("Euler",""),this.endrotEuler=!0);this.inirot=d.parse(this.inirot);this.endrot=d.parse(this.endrot);this.inirotM=new a.Matrix4x4;this.inirotM_X=new a.Matrix4x4;this.inirotM_Y=new a.Matrix4x4;this.inirotM_Z=new a.Matrix4x4;this.iniposM=new a.Matrix4x4;this.endrotM=new a.Matrix4x4;this.endrotM_X=new a.Matrix4x4;this.endrotM_Y=new a.Matrix4x4;this.endrotM_Z=new a.Matrix4x4;this.endposM=new a.Matrix4x4};a.Graphic3D.prototype.getSpace=
function(){for(var a=this.parent.spaces,b,c=0,d=a.length;c<d;c++)if(b=a[c],b.id==this.spaceID)return b;return a[0]};a.Graphic3D.prototype.getFamilyValues=function(){g=this.evaluator;c=g.evalExpression(this.family_interval);this.familyInf=c[0][0];this.familySup=c[0][1];this.fSteps=Math.round(g.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic3D.prototype.buildFamilyPrimitives=function(){g=this.evaluator;this.getFamilyValues();
e=g.getVariable(this.family);if(0<=this.fSteps)for(var a=0,b=this.fSteps;a<=b;a++)g.setVariable(this.family,this.familyInf+a*this.family_sep),this.familyValue=this.familyInf+a*this.family_sep,g.evalExpression(this.drawif)&&this.buildPrimitives();g.setVariable(this.family,e)};a.Graphic3D.prototype.update=function(){this.primitives=[];this.evaluator.evalExpression(this.drawif)&&(this.family||this.buildPrimitives());this.family&&this.buildFamilyPrimitives()};a.Graphic3D.prototype.updateMVMatrix=function(){m=
this.evaluator.evalExpression(this.inirot);this.inirotEuler?(this.inirotM=this.inirotM.setIdentity(),this.inirotM=this.inirotM.rotateZ(a.degToRad(m[0][0])),this.inirotM=this.inirotM.rotateX(a.degToRad(m[0][1])),this.inirotM=this.inirotM.rotateZ(a.degToRad(m[0][2]))):(this.inirotM_X=this.inirotM_X.setIdentity().rotateX(a.degToRad(m[0][0])),this.inirotM_Y=this.inirotM_Y.setIdentity().rotateY(a.degToRad(m[0][1])),this.inirotM_Z=this.inirotM_Z.setIdentity().rotateZ(a.degToRad(m[0][2])));m=this.evaluator.evalExpression(this.inipos);
f={x:m[0][0],y:m[0][1],z:m[0][2]};this.iniposM=this.iniposM.setIdentity().translate(f);m=this.evaluator.evalExpression(this.endrot);this.endrotEuler?(this.endrotM=this.endrotM.setIdentity(),this.endrotM=this.endrotM.rotateZ(a.degToRad(m[0][0])),this.endrotM=this.endrotM.rotateX(a.degToRad(m[0][1])),this.endrotM=this.endrotM.rotateZ(a.degToRad(m[0][2]))):(this.endrotM_X=this.endrotM_X.setIdentity().rotateX(a.degToRad(m[0][0])),this.endrotM_Y=this.endrotM_Y.setIdentity().rotateY(a.degToRad(m[0][1])),
this.endrotM_Z=this.endrotM_Z.setIdentity().rotateZ(a.degToRad(m[0][2])));m=this.evaluator.evalExpression(this.endpos);f={x:m[0][0],y:m[0][1],z:m[0][2]};this.endposM=this.endposM.setIdentity().translate(f)};a.Graphic3D.prototype.transformVertex=function(a){this.inirotEuler?b=this.inirotM.multiplyVector4(a):(b=this.inirotM_X.multiplyVector4(a),b=this.inirotM_Y.multiplyVector4(b),b=this.inirotM_Z.multiplyVector4(b));b=this.iniposM.multiplyVector4(b);this.endrotEuler?b=this.endrotM.multiplyVector4(b):
(b=this.endrotM_X.multiplyVector4(b),b=this.endrotM_Y.multiplyVector4(b),b=this.endrotM_Z.multiplyVector4(b));b=this.endposM.multiplyVector4(b);this.macroChildren&&(b=this.applyMacroTransform(b));return b};a.Graphic3D.prototype.applyMacroTransform=function(a){this.macro_inirotEuler?b=this.macro_inirotM.multiplyVector4(a):(b=this.macro_inirotM_X.multiplyVector4(a),b=this.macro_inirotM_Y.multiplyVector4(b),b=this.macro_inirotM_Z.multiplyVector4(b));b=this.macro_iniposM.multiplyVector4(b);this.macro_endrotEuler?
b=this.macro_endrotM.multiplyVector4(b):(b=this.macro_endrotM_X.multiplyVector4(b),b=this.macro_endrotM_Y.multiplyVector4(b),b=this.macro_endrotM_Z.multiplyVector4(b));return b=this.macro_endposM.multiplyVector4(b)};a.Graphic3D.prototype.parseExpression=function(){h=[];for(var a=this.expresion.replace(/\n/g," ").replace(/ ( )+/g," ").trim(),b=[],c=0,d,f=a.length,e=a.length-1;-1<e;e--)d=a.charAt(e),0==c?"="==d&&(c=1):1==c?" "!=d&&(c="<"==d||">"==d?0:2):2==c&&" "==d&&(b.unshift(a.substring(e+1,f)),
f=e,c=0);b.unshift(a.substring(0,f));e=0;for(a=b.length;e<a;e++)h.push(this.evaluator.parser.parse(b[e],!0));return h};var d;a.Graphic3D.prototype.splitFace=function(a){for(var b=0,c=this.primitives.length;b<c;b++)if(d=[],"face"===this.primitives[b].type){for(var h=0,e=a.primitives.length;h<e;h++)"face"===a.primitives[h].type?d=d.concat(this.primitives[b].splitFace(a.primitives[h])):d.push(a.primitives[h]);a.primitives=d}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,
g,c,e,b;a.Point3D=function(b,c){a.Graphic3D.call(this,b,c)};a.extend(a.Point3D,a.Graphic3D);a.Point3D.prototype.buildPrimitives=function(){f=this.evaluator;this.updateMVMatrix();g=f.evalExpression(this.expresion);c=g[0][0];e=g[0][1];b=g[0][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(c,e,b,1))],type:"vertex",backColor:this.backcolor.getColor(),frontColor:this.color.getColor(),size:f.evalExpression(this.width)}));""!==this.text&&this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(c,
e,b,1))],type:"text",frontColor:this.color.getColor(),font:this.font,decimals:f.evalExpression(this.decimals),fixed:this.fixed,displace:this.fontSize,evaluator:f,text:this.text,family:this.family,familyValue:this.familyValue},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h;a.Segment3D=function(b,c){this.width=b.evaluator.parser.parse("1");a.Graphic3D.call(this,b,c)};a.extend(a.Segment3D,a.Graphic3D);a.Segment3D.prototype.buildPrimitives=function(){evaluator=
this.evaluator;this.updateMVMatrix();h=evaluator.getVariable("u");evaluator.setVariable("u",this.Nu);expr=evaluator.evalExpression(this.expresion);f=expr[0][0];g=expr[0][1];c=expr[0][2];e=expr[1][0];b=expr[1][1];m=expr[1][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(f,g,c,1)),this.transformVertex(new a.Vector4D(e,b,m,1))],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},this.space));evaluator.setVariable("u",h)};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r;a.Surface3D=function(b,c){this.parameter="t";this.parameter_interval=b.evaluator.parser.parse("[0,1]");this.parameter_steps=b.evaluator.parser.parse("8");a.Graphic3D.call(this,b,c);this.expresion=this.parseExpression()};a.extend(a.Surface3D,a.Graphic3D);a.Surface3D.prototype.buildPrimitives=function(){f=this.evaluator;this.updateMVMatrix();e=f.getVariable("x");b=f.getVariable("y");m=f.getVariable("z");
g=f.getVariable("u");c=f.getVariable("v");f.setVariable("u",0);f.setVariable("v",0);h=f.evalExpression(this.Nu);d=f.evalExpression(this.Nv);n=[];for(var k=0;k<=h;k++){f.setVariable("u",k/h);for(var s=0;s<=d;s++){f.setVariable("v",s/d);for(var q=0,u=this.expresion.length;q<u;q++)f.evalExpression(this.expresion[q]);n.push(this.transformVertex(new a.Vector4D(f.getVariable("x"),f.getVariable("y"),f.getVariable("z"),1)))}}for(k=0;k<h;k++)for(s=0;s<d;s++)r=[],r.push(n[s+k*d+k]),r.push(n[s+1+k*d+k]),r.push(n[s+
2+(k+1)*d+k]),r.push(n[s+1+(k+1)*d+k]),this.primitives.push(new a.Primitive3D({vertices:r,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space));f.setVariable("x",e);f.setVariable("y",b);f.setVariable("z",m);f.setVariable("u",g);f.setVariable("v",c)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m;a.Polygon3D=function(b,c){this.width=b.evaluator.parser.parse("1");a.Graphic3D.call(this,
b,c)};a.extend(a.Polygon3D,a.Graphic3D);a.Polygon3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);for(var h=0,d=expr.length-1;h<d;h++)f=expr[h][0],g=expr[h][1],c=expr[h][2],e=expr[h+1][0],b=expr[h+1][1],m=expr[h+1][2],this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(f,g,c,1)),this.transformVertex(new a.Vector4D(e,b,m,1))],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},
this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m;a.Curve3D=function(b,c){this.width=b.evaluator.parser.parse("1");a.Graphic3D.call(this,b,c);this.expresion=this.parseExpression()};a.extend(a.Curve3D,a.Graphic3D);a.Curve3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();e=evaluator.getVariable("x");b=evaluator.getVariable("y");m=evaluator.getVariable("z");c=evaluator.getVariable("u");evaluator.setVariable("u",
0);g=evaluator.evalExpression(this.Nu);f=[];for(var h=0;h<=g;h++){evaluator.setVariable("u",h/g);for(var d=0,n=this.expresion.length;d<n;d++)evaluator.evalExpression(this.expresion[d]);f.push(this.transformVertex(new a.Vector4D(evaluator.getVariable("x"),evaluator.getVariable("y"),evaluator.getVariable("z"),1)))}h=0;for(d=f.length-1;h<d;h++)this.primitives.push(new a.Primitive3D({vertices:[f[h],f[h+1]],type:"edge",frontColor:this.color.getColor(),lineWidth:evaluator.evalExpression(this.width)},this.space));
evaluator.setVariable("x",e);evaluator.setVariable("y",m);evaluator.setVariable("z",b);evaluator.setVariable("u",c)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n;a.Triangle3D=function(b,c){a.Graphic3D.call(this,b,c)};a.extend(a.Triangle3D,a.Graphic3D);a.Triangle3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);f=expr[0][0];g=expr[0][1];c=expr[0][2];e=expr[1][0];b=expr[1][1];
m=expr[1][2];h=expr[2][0];d=expr[2][1];n=expr[2][2];this.primitives.push(new a.Primitive3D({vertices:[this.transformVertex(new a.Vector4D(f,g,c,1)),this.transformVertex(new a.Vector4D(h,d,n,1)),this.transformVertex(new a.Vector4D(e,b,m,1))],type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f;a.Face3D=function(f,c){a.Graphic3D.call(this,f,c)};
a.extend(a.Face3D,a.Graphic3D);a.Face3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();expr=evaluator.evalExpression(this.expresion);f=[];for(var g=expr.length-1;0<=g;g--)f.push(this.transformVertex(new a.Vector4D(expr[g][0],expr[g][1],expr[g][2],1)));this.primitives.push(new a.Primitive3D({vertices:f,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var f,g,c,e,b;a.Polireg3D=function(b,c){this.width=b.evaluator.parser.parse("2");this.length=b.evaluator.parser.parse("2");a.Graphic3D.call(this,b,c)};a.extend(a.Polireg3D,a.Graphic3D);a.Polireg3D.prototype.buildPrimitives=function(){evaluator=this.evaluator;this.updateMVMatrix();f=evaluator.evalExpression(this.Nu);g=[this.transformVertex(new a.Vector4D(0,0,0,1))];c=evaluator.evalExpression(this.width)/2;e=evaluator.evalExpression(this.length)/2;b=2*Math.PI/f;for(var m=
0;m<f;m++)g.push(this.transformVertex(new a.Vector4D(c*Math.cos(b*m),e*Math.sin(b*m),0,1)));for(m=0;m<f;m++)this.primitives.push(new a.Primitive3D({vertices:[g[0],m+2<=f?g[m+2]:g[1],g[m+1]],type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e;a.Text3D=function(b,c){a.Graphic3D.call(this,b,c)};a.extend(a.Text3D,a.Graphic3D);a.Text3D.prototype.buildPrimitives=
function(){f=this.evaluator;g=f.evalExpression(this.expresion);c=g[0][0];e=g[0][1];this.primitives.push(new a.Primitive3D({vertices:[new a.Vector4D(c,e,0,1)],type:"text",frontColor:this.color.getColor(),font:this.font,decimals:f.evalExpression(this.decimals),fixed:this.fixed,displace:0,isText:!0,evaluator:f,text:this.text,family:this.family,familyValue:this.familyValue,joel:"hola"},this.space))};return a}(descartesJS||{}),descartesJS=function(a,f){if(a.loadLib)return a;var g=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,
c,e;a.Macro3D=function(b,c){this.expresion=void 0;this.inirot="(0,0,0)";this.inirotEuler=!1;this.inipos=b.evaluator.parser.parse("(0,0,0)");this.endrot="(0,0,0)";this.endrotEuler=!1;this.endpos=b.evaluator.parser.parse("(0,0,0)");a.Graphic.call(this,b,c);for(var h in c)c.hasOwnProperty(h)&&(this[h]=c[h]);this.inirot.match("Euler")&&(this.inirot=this.inirot.replace("Euler",""),this.inirotEuler=!0);this.endrot.match("Euler")&&(this.endrot=this.endrot.replace("Euler",""),this.endrotEuler=!0);this.inirot=
this.evaluator.parser.parse(this.inirot);this.endrot=this.evaluator.parser.parse(this.endrot);this.inirotM=new a.Matrix4x4;this.inirotM_X=new a.Matrix4x4;this.inirotM_Y=new a.Matrix4x4;this.inirotM_Z=new a.Matrix4x4;this.iniposM=new a.Matrix4x4;this.endrotM=new a.Matrix4x4;this.endrotM_X=new a.Matrix4x4;this.endrotM_Y=new a.Matrix4x4;this.endrotM_Z=new a.Matrix4x4;this.endposM=new a.Matrix4x4;this.graphics=[];h=b.lessonParser;var d=new a.Tokenizer;if(void 0!=this.expresion){"'"!==this.expresion.charAt(0)&&
(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);var e=this.evaluator.evalExpression(this.expresion),r;e&&((r=document.getElementById(e))&&"descartes/macro"==r.type?r=r.text:(r=a.openExternalFile(e))&&!r.match(/tipo_de_macro/g)&&(r=null));var k,s;if(r){s=r.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,
"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").replace(/\r/g,"").split("\n");r=[];for(var e=0,q=s.length;e<q;e++)k=s[e].indexOf("="),-1!==k&&(k=s[e].substring(0,k),"id"!==f[k]&&"type"!==f[k]||r.push(h.split(s[e])));for(var u,l,v,p,e=0,q=r.length;e<q;e++)for(p=(u=r[e]||[],u[0])&&"id"===u[0][0],s=0,k=u.length;s<k;s++)if(l=
u[s][0].indexOf("."),-1===l||p?l=f[u[s][0]]:(l=f[u[s][0].substring(l+1)],u[s][0]=this.name+"."+u[s][0]),!("font"===l||("fill"===l||"color"===l||"backcolor"===l||"arrow"===l)&&"("!==u[s][1].charAt(0)||"file"===l&&u[s][1].match(g)||"id"!==l&&void 0!==f[u[s][1]])||"width"===l||"height"===l||"length"===l)if("text"==l)if(u[s][1].match(/\{\\rtf1/)){l=u[s][1];var t=this;v=function(a,b){for(var c=d.tokenize(b.replace(/\&squot;/g,"'")),h=0,e=c.length;h<e;h++)"identifier"!=c[h].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+
c[h].value+"-")||(c[h].value=t.name+"."+c[h].value);return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+d.flatTokens(c)};l=l.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,v);l=l.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,v);u[s][1]=l}else{v=h.parseText(u[s][1]).textElementsMacro3Ds;for(var w=0,A=v.length;w<A;w++){l=d.tokenize(v[w].replace(/\&squot;/g,"'"));for(var C=0,z=l.length;C<z;C++)"identifier"!==l[C].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+
l[C].value+"-")||(l[C].value=this.name+"."+l[C].value);l=d.flatTokens(l).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");v[w]=l.substring(1,l.length-1)}u[s][1]=v.join("")}else{l=d.tokenize(u[s][1]);v=0;for(w=l.length;v<w;v++)"identifier"!==l[v].type||"-rnd-pi-e-sqr-sqrt-ra\u00edz-exp-log-log10-abs-ent-sgn-ind-sin-sen-cos-tan-cot-sec-csc-sinh-senh-cosh-tanh-coth-sech-csch-asin-asen-acos-atan-min-max-".match("-"+l[v].value+"-")||(l[v].value=this.name+"."+l[v].value);u[s][1]=d.flatTokens(l)}e=
0;for(q=r.length;e<q;e++)if(r[e][0]){u="";p=!1;s=0;for(k=r[e].length;s<k;s++)"type"===f[r[e][s][0]]&&(u="espacio='"+this.spaceID+"' ",p=!0),u=u+r[e][s][0]+"='"+r[e][s][1]+"' ";r[e]=u;p?this.graphics.push(h.parse3DGraphic(r[e],this.abs_coord,this.background,this.inirot)):h.parseAuxiliar(r[e])}}e=0;for(q=this.graphics.length;e<q;e++)this.graphics[e].macroChildren=!0}};a.extend(a.Macro3D,a.Graphic);a.Macro3D.prototype.update=function(){this.updateTransformation();if(this.inipos){var a=this.evaluator.evalExpression(this.inipos);
this.iniPosX=a[0][0];this.iniPosY=a[0][1]}this.primitives=[];for(var a=0,f=this.graphics.length;a<f;a++)c=this.graphics[a],c.macro_inirotEuler=this.inirotEuler,c.macro_inirotM=this.inirotM,c.macro_inirotM_X=this.inirotM_X,c.macro_inirotM_Y=this.inirotM_Y,c.macro_inirotM_Z=this.inirotM_Z,c.macro_iniposM=this.iniposM,c.macro_endrotEuler=this.endrotEuler,c.macro_endrotM=this.endrotM,c.macro_endrotM_X=this.endrotM_X,c.macro_endrotM_Y=this.endrotM_Y,c.macro_endrotM_Z=this.endrotM_Z,c.macro_endposM=this.endposM,
c.update();a=0;for(f=this.graphics.length;a<f;a++){c=this.graphics[a];if(c.split||this.split)for(var h=a+1;h<f;h++)e=this.graphics[h],(e.split||this.split)&&c.splitFace(e);this.primitives=this.primitives.concat(c.primitives||[])}};a.Macro3D.prototype.updateTransformation=function(){tmpExpr=this.evaluator.evalExpression(this.inirot);this.inirotEuler?(this.inirotM=this.inirotM.setIdentity(),this.inirotM=this.inirotM.rotateZ(a.degToRad(tmpExpr[0][0])),this.inirotM=this.inirotM.rotateX(a.degToRad(tmpExpr[0][1])),
this.inirotM=this.inirotM.rotateZ(a.degToRad(tmpExpr[0][2]))):(this.inirotM_X=this.inirotM_X.setIdentity().rotateX(a.degToRad(tmpExpr[0][0])),this.inirotM_Y=this.inirotM_Y.setIdentity().rotateY(a.degToRad(tmpExpr[0][1])),this.inirotM_Z=this.inirotM_Z.setIdentity().rotateZ(a.degToRad(tmpExpr[0][2])));tmpExpr=this.evaluator.evalExpression(this.inipos);translate={x:tmpExpr[0][0],y:tmpExpr[0][1],z:tmpExpr[0][2]};this.iniposM=this.iniposM.setIdentity().translate(translate);tmpExpr=this.evaluator.evalExpression(this.endrot);
this.endrotEuler?(this.endrotM=this.endrotM.setIdentity(),this.endrotM=this.endrotM.rotateZ(a.degToRad(tmpExpr[0][0])),this.endrotM=this.endrotM.rotateX(a.degToRad(tmpExpr[0][1])),this.endrotM=this.endrotM.rotateZ(a.degToRad(tmpExpr[0][2]))):(this.endrotM_X=this.endrotM_X.setIdentity().rotateX(a.degToRad(tmpExpr[0][0])),this.endrotM_Y=this.endrotM_Y.setIdentity().rotateY(a.degToRad(tmpExpr[0][1])),this.endrotM_Z=this.endrotM_Z.setIdentity().rotateZ(a.degToRad(tmpExpr[0][2])));tmpExpr=this.evaluator.evalExpression(this.endpos);
translate={x:tmpExpr[0][0],y:tmpExpr[0][1],z:tmpExpr[0][2]};this.endposM=this.endposM.setIdentity().translate(translate)};a.Macro3D.prototype.drawAux=function(a){};return a}(descartesJS||{},babel),descartesJS=function(a){function f(a,b,c,d,h){g.call(this,a/1.8,a/1.8,a/1.8,d,h)}function g(a,b,c,d,h){a/=2;b/=2;c/=2;this.changeGeometry(a,b,c,d,h)||(this.vertices=[new l(a,c,b,1),new l(a,-c,b,1),new l(a,c,-b,1),new l(a,-c,-b,1),new l(-a,c,b,1),new l(-a,-c,b,1),new l(-a,c,-b,1),new l(-a,-c,-b,1)],this.faces=
[[2,3,1,0],[1,5,4,0],[5,7,6,4],[6,7,3,2],[4,6,2,0],[3,7,5,1]],this.updateValues(a,b,c,d,h))}function c(a,b,c,d,h){a/=2;this.changeGeometry(a,b,c,d,h)||(this.vertices=[new l(0,0,a,1),new l(-.49*a,-.86*a,-.32*a,1),new l(-.49*a,.86*a,-.32*a,1),new l(1*a,0,-.32*a,1)],this.faces=[[3,2,1],[1,2,0],[2,3,0],[3,1,0]],this.updateValues(a,b,c,d,h))}function e(a,b,c,d,h){a/=2;this.changeGeometry(a,b,c,d,h)||(this.vertices=[new l(0,0,a,1),new l(a,0,0,1),new l(-a,0,0,1),new l(0,a,0,1),new l(0,-a,0,1),new l(0,0,
-a,1)],this.faces=[[3,1,0],[2,3,0],[1,4,0],[4,2,0],[1,3,5],[3,2,5],[4,1,5],[2,4,5]],this.updateValues(a,b,c,d,h))}function b(b,c,d,h,e){b/=3.4;if(!this.changeGeometry(b,c,d,h,e)){B=b/1.6180339887;E=1.6180339887*b;this.vertices=[new l(b,b,b,1),new l(b,b,-b,1),new l(b,-b,b,1),new l(b,-b,-b,1),new l(-b,b,b,1),new l(-b,b,-b,1),new l(-b,-b,b,1),new l(-b,-b,-b,1),new l(0,B,E,1),new l(0,B,-E,1),new l(0,-B,E,1),new l(0,-B,-E,1),new l(B,E,0,1),new l(B,-E,0,1),new l(-B,E,0,1),new l(-B,-E,0,1),new l(E,0,B,1),
new l(E,0,-B,1),new l(-E,0,B,1),new l(-E,0,-B,1)];D=(new a.Matrix4x4).setIdentity().rotateY(-q/6);for(var f=0,k=this.vertices.length;f<k;f++)this.vertices[f]=D.multiplyVector4(this.vertices[f]);this.faces=[[0,16,2,10,8],[12,1,17,16,0],[8,4,14,12,0],[2,16,17,3,13],[13,15,6,10,2],[6,18,4,8,10],[3,17,1,9,11],[13,3,11,7,15],[1,12,14,5,9],[11,9,5,19,7],[5,14,4,18,19],[6,15,7,19,18]];this.updateValues(b,c,d,h,e)}}function m(b,c,d,h,e){b/=4;if(!this.changeGeometry(b,c,d,h,e)){E=1.6180339887*b;this.vertices=
[new l(0,b,E,1),new l(0,b,-E,1),new l(0,-b,E,1),new l(0,-b,-E,1),new l(b,E,0,1),new l(b,-E,0,1),new l(-b,E,0,1),new l(-b,-E,0,1),new l(E,0,b,1),new l(E,0,-b,1),new l(-E,0,b,1),new l(-E,0,-b,1)];this.faces=[[10,0,2],[0,8,2],[8,5,2],[5,7,2],[7,10,2],[6,0,10],[11,6,10],[7,11,10],[7,3,11],[5,3,7],[9,3,5],[8,9,5],[4,9,8],[0,4,8],[6,4,0],[11,3,1],[6,11,1],[4,6,1],[9,4,1],[3,9,1]];D=(new a.Matrix4x4).setIdentity().rotateY(-1.029);for(var f=0,k=this.vertices.length;f<k;f++)this.vertices[f]=D.multiplyVector4(this.vertices[f]);
this.updateValues(b,c,d,h,e)}}function h(a,b,c,d,h){a/=2;this.isSphere?c=b=a:(b/=2,c/=2);if(!this.changeGeometry(a,b,c,d,h)){this.vertices=[new l(0,0,b,1)];for(var e=1;e<d;e++){z=e*q/d;for(var f=0;f<h;f++)C=f*u/h,t=a*k(z)*s(C),w=c*k(z)*k(C),A=b*s(z),this.vertices.push(new l(t,w,A,1))}this.vertices.push(new l(0,0,-b,1));this.faces=[];for(e=0;e<h;e++)this.faces.push([0,(e+1)%h+1,e%h+1]);for(e=1;e<d-1;e++)for(f=0;f<h;f++)this.faces.push([f+1+(e-1)*h,(f+1)%h+1+(e-1)*h,(f+1)%h+1+e*h,f+1+e*h]);for(e=0;e<
h;e++)this.faces.push([this.vertices.length-1,this.vertices.length-1-h+e,this.vertices.length-1-h+(e+1)%h]);this.updateValues(a,b,c,d,h)}}function d(a,b,c,d,h){a/=2;b/=2;c/=2;if(!this.changeGeometry(a,b,c,d,h)){this.vertices=[];for(var e=0;e<h;e++)for(var f=0;f<d;f++)t=a*(h-e)/h*s(f*u/d),w=c*(h-e)/h*k(f*u/d),A=b-2*e*b/h,this.vertices.push(new l(t,w,A,1));this.vertices.push(new l(0,0,-b,1));this.faces=[];for(e=0;e<h-1;e++)for(f=0;f<d;f++)this.faces.push([f+e*d,(f+1)%d+e*d,(f+1)%d+(e+1)*d,f+(e+1)*d]);
for(e=0;e<d;e++)this.faces.push([this.vertices.length-1,this.vertices.length-1-d+e,this.vertices.length-1-d+(e+1)%d]);this.updateValues(a,b,c,d,h)}}function n(a,b,c,d,h){a/=2;b/=2;c/=2;if(!this.changeGeometry(a,b,c,d,h)){this.vertices=[];for(var e=0;e<h+1;e++)for(var f=0;f<d;f++)t=a*s(f*u/d),w=c*k(f*u/d),A=b-2*e*b/h,this.vertices.push(new l(t,w,A,1));this.faces=[];for(e=0;e<h;e++)for(f=0;f<d;f++)this.faces.push([f+e*d,(f+1)%d+e*d,(f+1)%d+(e+1)*d,f+(e+1)*d]);this.updateValues(a,b,c,d,h)}}function r(){function a(b){return parseInt(b)}
function b(a){return parseFloat(a)}this.vertices=[];this.faces=[];for(var c=0,d=this.fileData.length;c<d;c++)y=this.fileData[c],y.match(/^V\(/)?(I=y.substring(2,y.length-1).split(",").map(b),this.vertices.push(new l(I[0]||0,I[1]||0,I[2]||0,1))):y.match(/^F\(/)&&(I=y.substring(2,y.length-1).split(",").map(a),this.faces.push(I.reverse()))}if(a.loadLib)return a;var k=Math.sin,s=Math.cos,q=Math.PI,u=2*q,l,v,p,t,w,A,C,z,B,E,D,y,I;a.OtherGeometry=function(k,q){this.width=k.evaluator.parser.parse("2");this.height=
k.evaluator.parser.parse("2");this.length=k.evaluator.parser.parse("2");l=a.Vector4D;a.Graphic3D.call(this,k,q);switch(this.type){case "cube":this.buildGeometry=f;break;case "box":this.buildGeometry=g;break;case "tetrahedron":this.buildGeometry=c;break;case "octahedron":this.buildGeometry=e;break;case "sphere":this.isSphere=!0;case "ellipsoid":this.buildGeometry=h;break;case "dodecahedron":this.buildGeometry=b;break;case "icosahedron":this.buildGeometry=m;break;case "cone":this.buildGeometry=d;break;
case "cylinder":this.buildGeometry=n;break;case "mesh":this.fileData=a.openExternalFile(this.evaluator.evalExpression(this.file)).split(/\r/),this.buildGeometry=r}};a.extend(a.OtherGeometry,a.Graphic3D);a.OtherGeometry.prototype.buildPrimitives=function(){v=this.evaluator;this.updateMVMatrix();this.buildGeometry(v.evalExpression(this.width),v.evalExpression(this.height),v.evalExpression(this.length),v.evalExpression(this.Nu),v.evalExpression(this.Nv));for(var b=0,c=this.faces.length;b<c;b++){p=[];
for(var d=0,h=this.faces[b].length;d<h;d++)p.push(this.transformVertex(this.vertices[this.faces[b][d]]));this.primitives.push(new a.Primitive3D({vertices:p,type:"face",frontColor:this.color.getColor(),backColor:this.backcolor.getColor(),edges:this.edges,model:this.model},this.space))}};a.OtherGeometry.prototype.changeGeometry=function(a,b,c,d,h){return this.oldWidth===a&&this.oldHeight===b&&this.oldLength===c&&this.oldNu===d&&this.oldNv===h};a.OtherGeometry.prototype.updateValues=function(a,b,c,d,
h){this.oldWidth=a;this.oldHeight=b;this.oldLength=c;this.oldNv=h;this.oldNu=d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.max,g=Math.min,c=Math.PI,e=Math.cos,b=Math.sin,m=Math.abs,h=Math.round,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z,B,E,D;a.R2=function(a,b){this.x=a||0;this.y=b||0};a.R2.prototype.set=function(a,b){this.x=a||0;this.y=b||0;return this};a.R2.prototype.copy=function(){return new a.R2(this.x,this.y)};a.R2.prototype.ix=function(){return h(f(g(this.x,32E3),
-32E3))};a.R2.prototype.iy=function(){return h(f(g(this.y,32E3),-32E3))};a.R2.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};a.R2.prototype.norm2=function(){return this.x*this.x+this.y*this.y};a.R2.prototype.norm=function(){return Math.sqrt(this.norm2())};a.R2.prototype.distance=function(a){n=this.copy();n.sub(a);return n.norm()};a.R2.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.R2.prototype.det=function(a){return this.x*a.y-this.y*a.x};a.R2.prototype.mul=function(a){this.x*=
a;this.y*=a};a.R2.prototype.div=function(a){this.x/=a;this.y/=a};a.R2.prototype.add=function(a){this.x+=a.x;this.y+=a.y};a.R2.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};a.R2.prototype.normalize=function(){d=this.norm();0!=d&&this.div(d)};a.R2.prototype.rotR90=function(){d=this.x;this.x=this.y;this.y=-d};a.R2.prototype.rotL90=function(){d=this.x;this.x=-this.y;this.y=d};a.R2.prototype.rot=function(a){r=this.copy();q=e(a);u=b(a);this.x=r.x*q-r.y*u;this.y=r.x*u+r.y*q};a.R2.prototype.rot=function(a){this.rot(a*
c/180)};a.R2.prototype.intersection=function(b,c,d,h){l=c.x-b.x;v=d.x-h.x;p=d.x-b.x;t=c.y-b.y;w=d.y-h.y;A=d.y-b.y;D=l*w-v*t;return 1E-6<m(D)?(k=(p*w-A*v)/D,s=(-p*t+A*l)/D,0<=k&&1>=k&&0<=s&&1>=s?new a.R2(b.x+l*k,b.y+t*k):null):(c.x-d.x)*A!=(c.y-d.y)*p?null:b.x!=c.x?(C=g(b.x,c.x),z=f(b.x,c.x),C<=d.x&&d.x<=z?d:C<=h.x&&h.x<=z?h:null):d.x!=h.x?(B=g(d.x,h.x),E=f(d.x,h.x),B<=b.x&&b.x<=E?b:B<=c.x&&c.x<=E?c:null):b.y!=c.y?(C=g(b.y,c.y),z=f(b.y,c.y),C<=d.y&&d.y<=z?d:C<=h.y&&h.y<=z?h:null):d.y!=h.y?(B=g(d.y,
h.y),E=f(d.y,h.y),B<=b.y&&b.y<=E?b:B<=c.y&&c.y<=E?c:null):b.x==d.x&&b.y==d.y?b:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n;a.R2Newton=function(c,d){this.evaluator=c;this.constraint=d;if("=="==this.constraint.value||"<"==this.constraint.value||"<="==this.constraint.value||">"==this.constraint.value||">="==this.constraint.value)this.sign="<"==this.constraint.value||"<="==this.constraint.value?"menor":">"==this.constraint.value||">="==this.constraint.value?
"mayor":"igual",this.constraint=this.constraint.equalToMinus(),this.constraint=this.constraint.childs[0];m=new a.R2(0,0);b=new a.R2(0,0);n=new a.R2(0,0)};a.R2Newton.prototype.getUnitNormal=function(){this.normal.normalize();return n.set(this.normal.x,this.normal.y)};a.R2Newton.prototype.gradient=function(a){f=this.evaluator;m.x=0;m.y=0;h=f.getVariable("x");d=f.getVariable("y");f.setVariable("x",a.x);f.setVariable("y",a.y);this.f0=f.evalExpression(this.constraint);f.setVariable("x",f.getVariable("x")+
1E-6);g=f.evalExpression(this.constraint);m.x=(g-this.f0)/1E-6;m.x=isNaN(m.x)?Infinity:m.x;f.setVariable("x",f.getVariable("x")-1E-6);f.setVariable("y",f.getVariable("y")+1E-6);g=f.evalExpression(this.constraint);m.y=(g-this.f0)/1E-6;m.y=isNaN(m.y)?Infinity:m.y;f.setVariable("x",h);f.setVariable("y",d);return m};a.R2Newton.prototype.findZero=function(a,k,m){f=this.evaluator;b.x=a.x;b.y=a.y;h=f.getVariable("x");d=f.getVariable("y");f.setVariable("x",a.x);f.setVariable("y",a.y);this.f0=f.evalExpression(this.constraint);
if("menor"===this.sign&&0>=this.f0||"mayor"===this.sign&&0<=this.f0)return b;f.setVariable("x",h);f.setVariable("y",d);for(var g=0;16>g;g++)if(c=b.x,e=b.y,this.normal=this.gradient(b),0!=this.normal.norm2()&&this.normal.mul(-this.f0/this.normal.norm2()),b.x=c+this.normal.x,b.y=e+this.normal.y,this.normal.norm()<k)return 0===this.normal.x&&0===this.normal.y&&(this.normal.x=b.x-a.x,this.normal.y=b.y-a.y),b;return m?b:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector2D=
function(a,g){this.x=a;this.y=g};a.Vector2D.AXIS_X=new a.Vector2D(1,0);a.Vector2D.AXIS_Y=new a.Vector2D(0,1);a.Vector2D.prototype.vectorLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.dotProduct=function(a){return this.x*a.x+this.y*a.y};a.Vector2D.prototype.angleBetweenVectors=function(a){return Math.acos(this.dotProduct(a)/(this.vectorLength()*a.vectorLength()))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.floor,g=Math.round,
c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z;a.Control=function(b,c){this.parent=b;this.evaluator=b.evaluator;var d=this.parser=b.evaluator.parser;this.id="graphic"!==c.type?"C":"G";this.gui=this.type="";this.region="south";this.y=this.x=0;this.w="video"!==c.type?100:350;this.h="video"!==c.type?23:120;"graphic"!==c.type&&"audio"!==c.type&&"video"!==c.type?"text"!==c.type?this.expresion=d.parse("(0,0,100,23)"):(this.expresion=d.parse("(0,0,300,200)"),this.w=300,this.h=200):this.expresion=d.parse("(0,0)");
this.fixed=2!=this.parent.version?!1:!0;this.visible=!0;this.color=4>this.parent.version?new a.Color("000000"):new a.Color("222222");this.colorInt="graphic"!==c.type?new a.Color("f0f8ff"):new a.Color("cc0022");this.underlined=this.italics=this.bold="";this.font_size=4>this.parent.version?-1:d.parse("12");this.parameter=this.action="";this.parameterFont="Monospace 12px";this.drawif=d.parse("1");this.activeif=d.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont=
"Monospace 12px";this.cID=this.msg_pos="";this.valueExpr=d.parse("0");this.decimals=d.parse("2");this.min=d.parse("-Infinity");this.max=d.parse("Infinity");this.incr=d.parse("0.1");this.exponentialif=this.discrete=!1;this.zIndex=-1;for(var h in c)c.hasOwnProperty(h)&&(this[h]=c[h]);"video"!==this.type&&"audio"!==this.type||"interior"===this.region||(this.region="interior");void 0==this.name&&(this.name=2==this.parent.version?this.id:"_nada_");this.name="_._"==this.name||"_nada_"==this.name||"_void_"==
this.name?"":this.name;d=this.evaluator.evalExpression(this.expresion);this.x=g(d[0][0]);this.y=g(d[0][1]);4==d[0].length&&(this.w=g(d[0][2]),this.h=g(d[0][3]));this.actionExec=b.lessonParser.parseAction(this)};a.Control.prototype.init=function(){};a.Control.prototype.update=function(){};a.Control.prototype.draw=function(){};a.Control.prototype.getContainer=function(){var a=this.parent.spaces,b;if("interior"===this.region)for(var c=0,d=a.length;c<d;c++){if(b=a[c],b.id===this.spaceID)return b.addCtr(this),
this.zIndex=b.zIndex,b.numericalControlContainer}else{if("external"===this.region)return this.parent.externalSpace.addCtr(this),this.parent.externalSpace.container;if("scenario"===this.region)return this.cID?(this.expresion=this.evaluator.parser.parse("(0,-1000,"+this.w+","+this.h+")"),this.parent.scenarioRegion.scenarioSpace.addCtr(this),this.zIndex=this.parent.scenarioRegion.scenarioSpace.zIndex,this.parent.scenarioRegion.scenarioSpace.numericalControlContainer):this.parent.externalSpace.container;
if("north"===this.region)return this.parent.northSpace.controls.push(this),this.parent.northSpace.container;if("south"===this.region)return this.parent.southSpace.controls.push(this),this.parent.southSpace.container;if("east"===this.region)return this.parent.eastSpace.controls.push(this),this.parent.eastSpace.container;if("west"===this.region)return this.parent.westSpace.controls.push(this),this.parent.westSpace.container;if("special"===this.region)return this.parent.specialSpace.controls.push(this),
this.parent.specialSpace.container}a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].numericalControlContainer};a.Control.prototype.addControlContainer=function(a){var b=this.getContainer();b.childNodes[0]?b.insertBefore(a,b.childNodes[0]):b.appendChild(a);b.childNodes[0]?b.insertBefore(a,b.childNodes[0]):b.appendChild(a)};a.Control.prototype.updatePositionAndSize=function(){b=m=h=d=!1;n=this.evaluator.evalExpression(this.expresion);r=g(n[0][0]);b=g(this.x)!==r;this.x=r;r=g(n[0][1]);m=g(this.y)!==
r;this.y=r;4===n[0].length&&(r=g(n[0][2]),h=g(this.w)!==r,this.w=r,r=g(n[0][3]),d=g(this.h)!==r,this.h=r);if(h||d||b||m)this.init(!0),this.draw()};a.Control.prototype.formatOutputValue=function(a){l=this.parent;k=a+"";s=this.evaluator.evalExpression(this.decimals);q=k.indexOf(".");-1!=q&&(u=k.substring(q+1),u.length>s&&(k=parseFloat(k).toFixed(s)));this.fixed&&(2!==l.version||2===l.version&&!this.exponentialif)&&(k=parseFloat(a).toFixed(s));this.exponentialif&&0!=parseFloat(k)&&(k=this.fixed&&2!==
l.version?parseFloat(k).toExponential(s):parseFloat(k).toExponential(),k=k.toUpperCase(),k=k.replace("+",""));return k=k.replace(".",l.decimal_symbol)};a.Control.prototype.updateAndExecAction=function(){this.parent.updateControls();"init"===this.action&&(this.click=!1);this.actionExec.execute();this.parent.updateControls();"animate"!==this.action&&this.parent.update()};a.Control.prototype.createGradient=function(a,b){this.linearGradient=this.ctx.createLinearGradient(0,0,0,b);c=b*b;for(var d=0;d<b;d++)e=
f(d-35*b/100),this.linearGradient.addColorStop(d/b,"rgba(0,0,0,"+e*e*192/c/255+")")};a.Control.prototype.getScreenshot=function(){t=this;v=document.createElement("canvas");v.setAttribute("width",t.w);v.setAttribute("height",t.h);p=v.getContext("2d");p.font=t.fieldFontSize+"px Arial, Helvetica, 'Droid Sans', Sans-serif";t.canvas&&(w=t.canvas.offsetLeft,A=t.canvas.offsetTop,p.drawImage(t.canvas,w,A));t.label&&(w=t.label.offsetLeft,A=t.label.offsetTop,C=t.label.offsetWidth,z=t.label.offsetHeight,p.fillStyle=
"#e0e4e8",p.fillRect(w,A,C,z),p.fillStyle="black",p.textAlign="center",p.textBaseline="middle",p.fillText(t.name,w+C/2,A+z/2));t.field&&(w=t.field.offsetLeft,A=t.field.offsetTop,C=t.field.offsetWidth,z=t.field.offsetHeight,p.fillStyle="white",p.strokeStyle="#666666",p.lineWidth=1,p.fillRect(w,0,C,z),p.strokeRect(w+.5,.5,C-1,z-1),p.fillStyle="black",p.textAlign="center",p.textAlign="left",p.fillText(t.field.value,w+2,z/2));t.select&&(w=t.select.offsetLeft,A=t.select.offsetTop,C=t.select.offsetWidth,
z=t.select.offsetHeight,p.fillStyle="#e0e4e8",p.strokeStyle="#666666",p.lineWidth=1,p.fillRect(w,0,C,z),p.strokeRect(w+.5,.5,C,z-1),p.fillStyle="black",p.textAlign="center",p.textAlign="left",p.fillText(t.select.value,w+2,z/2),p.fillStyle="#c0c0c0",p.fillRect(w+C-15+.5,.5,15,z-1),p.strokeRect(w+C-15+.5,.5,15,z-1),p.fillStyle="black",p.beginPath(),p.moveTo(w+C-15+4.5,z/2-2.5),p.lineTo(w+C-15+8,z/2+2.5),p.lineTo(w+C-15+11.5,z/2-2.5),p.closePath(),p.fill());return v};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;var f=Math.floor,g=Math.abs,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z=/[\w\.\-//]*(\.gif)/gi,B,E,D,y,I,G,H,J,x,K,F,L,M;a.Button=function(b,c){this.imageSrc="";this.image=new Image;this.imageOver=new Image;this.imageDown=new Image;a.Control.call(this,b,c);-1===this.font_size&&(this.fontSizeNotSet=!0);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+
this.name+"'");var d;if(this.imageSrc.trim().match("^_STYLE_")){this.customStyle=!0;this.canvasStyle=[];this.containerStyle=[];d=this.imageSrc.trim().substring(8).split("|");for(var h,e=0,f=d.length;e<f;e++)h=d[e],h.match("border=")&&(this.canvasStyle.push({type:"border-style",value:"solid"}),this.canvasStyle.push({type:"border-width",value:h.substring(7).trim()+"px"})),h.match("borderRadius=")&&(this.canvasStyle.push({type:"border-radius",value:h.substring(13).trim()+"px"}),this.containerStyle.push({type:"border-radius",
value:h.substring(13).trim()+"px"})),h.match("borderColor=")&&this.canvasStyle.push({type:"border-color",value:"#"+h.substring(12).trim()}),h.match("overColor=")&&(this.containerStyle.overColor="#"+h.substring(10).trim()),h.match("downColor=")&&(this.containerStyle.downColor="#"+h.substring(10).trim()),h.match("font=")&&(this.containerStyle.font=h.substring(5).trim().toLowerCase()),h.match("inactiveColor=")&&(this.containerStyle.inactiveColor="#"+h.substring(14).trim()),h.match("inactiveColorBorder=")&&
(this.containerStyle.inactiveColorBorder="#"+h.substring(20).trim()),h.match("shadowTextBlur=")&&(this.containerStyle.shadowTextBlur=parseFloat(h.substring(15).trim())),h.match("shadowTextOffsetX=")&&(this.containerStyle.shadowTextOffsetX=parseFloat(h.substring(18).trim())),h.match("shadowTextOffsetY=")&&(this.containerStyle.shadowTextOffsetY=parseFloat(h.substring(18).trim())),h.match("shadowTextColor=")&&(this.containerStyle.shadowTextColor="#"+h.substring(16).trim()),h.match("shadowBoxBlur=")&&
(this.containerStyle.shadowBoxBlur=parseFloat(h.substring(14).trim())),h.match("shadowBoxOffsetX=")&&(this.containerStyle.shadowBoxOffsetX=parseFloat(h.substring(17).trim())),h.match("shadowBoxOffsetY=")&&(this.containerStyle.shadowBoxOffsetY=parseFloat(h.substring(17).trim())),h.match("shadowBoxColor=")&&(this.containerStyle.shadowBoxColor="#"+h.substring(15).trim()),h.match("shadowInsetBoxBlur=")&&(this.containerStyle.shadowInsetBoxBlur=parseFloat(h.substring(19).trim())),h.match("shadowInsetBoxOffsetX=")&&
(this.containerStyle.shadowInsetBoxOffsetX=parseFloat(h.substring(22).trim())),h.match("shadowInsetBoxOffsetY=")&&(this.containerStyle.shadowInsetBoxOffsetY=parseFloat(h.substring(22).trim())),h.match("shadowInsetBoxColor=")&&(this.containerStyle.shadowInsetBoxColor="#"+h.substring(20).trim());this.imageSrc="vacio.gif"}this.imageSrc.match("_COLORES_")&&(d=this.imageSrc.split("_"),this.colorInt=new a.Color(d[2]),this.color=new a.Color(d[3]),this.font_size=this.parser.parse(d[5]),this.imageSrc="");
"["==this.imageSrc.charAt(0)?this.imageSrc=this.parser.parse(this.imageSrc.substring(1,this.imageSrc.length-1)):this.imageSrc=this.parser.parse("'"+this.imageSrc+"'");d=this.evaluator.evalExpression(this.imageSrc).toString().trim();""!=d&&(h=d.substr(0,d.lastIndexOf(".")),e=d.substr(d.lastIndexOf(".")),d.toLowerCase().match(/vacio.gif$/)?(this.imageSrc=this.parser.parse("'vacio.gif'"),this.image.ready=1,3===this.parent.version&&(this.name=this.parser.parse("")),this.emptyImage={ready:!0},this.parser.parse("'vacio.gif'")):
(this.image=this.parent.getImage(d),h&&(this.imageOver=this.parent.getImage(h+"_over"+e),this.imageDown=this.parent.getImage(h+"_down"+e))));this.container=document.createElement("div");this.container.setAttribute("class","DescartesButtonContainer");this.container.setAttribute("id",this.id);this.container.setAttribute("style","width:"+this.w+"px; height:"+this.h+"px; left:"+this.x+"px; top:"+this.y+"px; z-index:"+this.zIndex+";");this.canvas=document.createElement("canvas");this.canvas.width=this.w*
a._ratio;this.canvas.height=this.h*a._ratio;this.canvas.setAttribute("style","position:absolute; left:0px; top:0px; width:"+this.w+"px; height:"+this.h+"px; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box;");this.ctx=this.canvas.getContext("2d");this.ctx.imageSmoothingEnabled=!1;this.ctx.mozImageSmoothingEnabled=!1;this.ctx.webkitImageSmoothingEnabled=!1;this.container.appendChild(this.canvas);this.addControlContainer(this.container);this.registerMouseAndTouchEvents();
this.init()};a.extend(a.Button,a.Control);a.Button.prototype.init=function(d){c=this.evaluator;B=this.container;e=this.canvas;b=this.ctx;m=c.evalExpression(this.expresion);this.x=m[0][0];this.y=m[0][1];4==m[0].length&&(this.w=parseInt(m[0][2]),this.h=parseInt(m[0][3]));e.width=this.w*a._ratio;e.height=this.h*a._ratio;e.setAttribute("style","position:absolute; left:0px; top:0px; width:"+this.w+"px; height:"+this.h+"px; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box;");
B.setAttribute("style","width:"+this.w+"px; height:"+this.h+"px; left:"+this.x+"px; top:"+this.y+"px; z-index:"+this.zIndex+"; display:block;");if(this.canvasStyle)for(var h=0,f=this.canvasStyle.length;h<f;h++)e.style[this.canvasStyle[h].type]=this.canvasStyle[h].value;if(this.containerStyle){h=0;for(f=this.containerStyle.length;h<f;h++)B.style[this.containerStyle[h].type]=this.containerStyle[h].value;if(this.containerStyle.shadowBoxColor){var h=this.containerStyle.shadowBoxOffsetX||0,f=this.containerStyle.shadowBoxOffsetY||
2,l=this.containerStyle.shadowBoxBlur||2;B.style.boxShadow=h+"px "+f+"px "+l+"px 1px "+this.containerStyle.shadowBoxColor}this.containerStyle.shadowInsetBoxColor&&(h=this.containerStyle.shadowInsetBoxOffsetX||0,f=this.containerStyle.shadowInsetBoxOffsetY||-2,l=this.containerStyle.shadowInsetBoxBlur||1,e.style.boxShadow=h+"px "+f+"px "+l+"px 1px "+this.containerStyle.shadowInsetBoxColor+" inset");this.containerStyle.shadowTextColor&&(b.shadowBlur=this.containerStyle.shadowTextBlur||0,b.shadowOffsetX=
this.containerStyle.shadowTextOffsetX||0,b.shadowOffsetY=this.containerStyle.shadowTextOffsetY||2,b.shadowColor=this.containerStyle.shadowTextColor)}this.fontSizeNotSet&&(this.font_size=c.parser.parse(a.getFieldFontSize(this.h)+""));this.fs_evaluated=c.evalExpression(this.font_size);this.createGradient(this.w,this.h);B.style.display=0<c.evalExpression(this.drawif)?"block":"none";b.textAlign="center";b.textBaseline="middle";b.lineJoin="round";b.font=this.italics+" "+this.bold+" "+this.fs_evaluated+
"px descartesJS_sansserif,Arial,Helvetica,Sans-serif";this.customStyle&&("serif"==this.containerStyle.font?b.font=this.italics+" "+this.bold+" "+this.fs_evaluated+"px descartesJS_serif,Times,'Times New Roman', serif":"monospace"==this.containerStyle.font?b.font=this.italics+" "+this.bold+" "+this.fs_evaluated+"px descartesJS_monospace,Courier,'Courier New',Monospace":"icons"==this.containerStyle.font&&(b.font=this.italics+" "+this.bold+" "+this.fs_evaluated+"px descartesJS_icons,Arial,Helvetica,Sans-serif"));
this.draw(d)};a.Button.prototype.update=function(){c=this.evaluator;B=this.container;e=this.canvas;this.activeIfValue=0<c.evalExpression(this.activeif);(this.drawIfValue=0<c.evalExpression(this.drawif))?(B.style.display="block",this.draw()):(B.style.display="none",this.buttonClick=!1);B.style.cursor=this.activeIfValue?"pointer":"not-allowed";e.style.cursor=this.activeIfValue?"pointer":"not-allowed";this.updatePositionAndSize()};a.Button.prototype.draw=function(m){B=this.container;c=this.evaluator;
e=this.canvas;b=this.ctx;d=c.evalExpression(this.name);n=c.evalExpression(this.imageSrc)+"";if(!m&&(E=this.over===this.oldOver,D=this.buttonClick===this.oldButtonClick,y=this.activeIfValue===this.oldActiveIfValue,I=this.drawIfValue===this.oldDrawIfValue,G=d===this.oldName,H=n===this.oldImageSrc,this.oldOver=this.over,this.oldButtonClick=this.buttonClick,this.oldActiveIfValue=this.activeIfValue,this.oldDrawIfValue=this.drawIfValue,this.oldName=d,this.oldImageSrc=n,E&&D&&y&&I&&G&&H))return;b.save();
b.setTransform(a._ratio,0,0,a._ratio,0,0);h=this.fs_evaluated;r="vacio.gif"===n?this.emptyImage:this.parent.getImage(n);J=n.substr(0,n.lastIndexOf("."));x=n.substr(n.lastIndexOf("."));K=J+"_over"+x;F=J+"_down"+x;L="vacio.gif"===n?this.emptyImage:this.parent.getImage(K);M="vacio.gif"===n?this.emptyImage:this.parent.getImage(F);b.clearRect(0,0,this.w,this.h);s=k=0;this.buttonClick&&(s=k=1);p=f(this.w/2+k)-.5;t=f(this.h/2+s)-.5;r&&(w=r.height||1E8,A=a.getFontMetrics(this.italics+" "+this.bold+" "+h+
"px descartesJS_sansserif, Arial, Helvetica, Sans-serif").h,C=""!=d?0<=this.h-w-A-2?!0:!1:!1,l=parseInt((this.w-r.width)/2)+k,v=C?parseInt((this.h-A-r.height+2)/2):parseInt((this.h-r.height)/2)+s,C&&(t=parseInt(this.h-A/2-2),B.style.backgroundColor=this.colorInt.getColor(),b.strokeStyle=this.color.getColor(),b.lineWidth=1,b.beginPath(),b.moveTo(.5,.5),b.lineTo(this.w-.5,.5),b.lineTo(this.w-.5,this.h-.5),b.lineTo(.5,this.h-.5),b.closePath(),b.stroke()));r&&r.ready?r!==this.emptyImage&&r.complete?n.match(z)?
(this.canvas.style.backgroundImage="url('"+n+"')",this.canvas.style.backgroundPosition=l+"px "+v+"px"):b.drawImage(r,l,v):this.emptyImage&&this.customStyle&&(B.style.backgroundColor=this.colorInt.getColor()):(B.style.backgroundColor=this.colorInt.getColor(),this.buttonClick||(a.drawLine(b,this.w-1,0,this.w-1,this.h,"rgba(0,0,0,0.5)"),a.drawLine(b,0,0,0,this.h,"rgba(0,0,0,0.09)"),a.drawLine(b,1,0,1,this.h,"rgba(0,0,0,0.03)")),b.fillStyle=this.linearGradient,b.fillRect(0,0,this.w,this.h));this.activeIfValue&&
(L!==this.emptyImage&&this.over&&L.ready&&L.complete?K.match(z)?(this.canvas.style.backgroundImage="url('"+K+"')",this.canvas.style.backgroundPosition=l+"px "+v+"px"):b.drawImage(L,l,v):this.customStyle&&this.containerStyle.overColor&&this.over&&(B.style.backgroundColor=this.containerStyle.overColor));this.activeIfValue?M!==this.emptyImage&&this.buttonClick&&M.ready&&M.complete?F.match(z)?(this.canvas.style.backgroundImage="url('"+F+"')",this.canvas.style.backgroundPosition=l+"px "+v+"px"):b.drawImage(M,
l,v):this.customStyle&&this.containerStyle.downColor&&this.buttonClick&&(B.style.backgroundColor=this.containerStyle.downColor):this.buttonClick&&!r&&(b.fillStyle="rgba(0,0,0,0.09)",b.fillRect(0,0,this.w,this.h));b.fillStyle=this.color.getColor();this.customStyle&&this.containerStyle.shadowTextColor&&(b.lineWidth=3,b.strokeStyle=this.containerStyle.shadowTextColor,b.strokeText(d,p,t));C||this.containerStyle||!this.drawTextBorder()||(b.lineWidth=parseInt(h/6),b.strokeStyle=this.colorInt.getColor(),
b.strokeText(d,p,t));b.fillText(d,p,t);this.underlined&&(q=b.measureText(d).width,b.strokeStyle=this.color.getColor(),b.lineWidth=f(h/10)||2,b.lineCap="round",b.beginPath(),b.moveTo(parseInt((this.w-q)/2)+k,t+f(h/2)+f(h/5)-1.5),b.lineTo(parseInt((this.w+q)/2)+k,t+f(h/2)+f(h/5)-1.5),b.stroke());this.activeIfValue||(this.customStyle&&this.containerStyle.inactiveColor?B.style.backgroundColor=this.containerStyle.inactiveColor:(b.fillStyle="rgba(240,240,240,0.6)",b.fillRect(0,0,this.w,this.h)));b.restore();
this._image_pos_x=l;this._image_pos_y=v};a.Button.prototype.drawTextBorder=function(){this.colorInt.getColor();this.color.getColor();return!(.5>(g(this.colorInt.r-this.color.r)+g(this.colorInt.g-this.color.g)+g(this.colorInt.b-this.color.b))/255)};a.Button.prototype.buttonPressed=function(){this.updateAndExecAction()};a.Button.prototype.registerMouseAndTouchEvents=function(){function b(a,c,d){clearInterval(l);f.buttonClick&&f.drawIfValue&&f.activeIfValue&&(c.call(f),a=d?a:100,l=setTimeout(function(){b(a,
c,!1)},a))}function c(h){this.focus();h.preventDefault();h.stopPropagation();document.activeElement!=document.body&&document.activeElement.blur();f.whichButton=a.whichButton(h);"L"==f.whichButton&&f.activeIfValue&&(f.buttonClick=!0,f.draw(),"calculate"==f.action&&(f.evaluator.setVariable(f.id,f.evaluator.evalExpression(f.valueExpr)),b(2E3,f.buttonPressed,!0)),u?(f.canvas.removeEventListener("touchend",d),f.canvas.addEventListener("touchend",d)):(f.canvas.removeEventListener("mouseup",d),f.canvas.addEventListener("mouseup",
d)))}function d(a){this.focus();a.preventDefault();a.stopPropagation();if(f.activeIfValue||f.buttonClick)f.buttonClick=!1,f.draw(),"calculate"!=f.action&&(f.evaluator.setVariable(f.id,f.evaluator.evalExpression(f.valueExpr)),f.buttonPressed()),u?f.canvas.removeEventListener("touchend",d):f.canvas.removeEventListener("mouseup",d);f.parent.update()}function h(a){a.preventDefault();a.stopPropagation();f.over=!0;f.draw()}function e(a){a.preventDefault();a.stopPropagation();f.over=!1;f.buttonClick=!1;
f.draw()}u=a.hasTouchSupport;var f=this,l;f.canvas.oncontextmenu=function(){return!1};this.over=this.buttonClick=!1;u?this.canvas.addEventListener("touchstart",c):(this.canvas.addEventListener("mousedown",c),this.canvas.addEventListener("mouseover",h),this.canvas.addEventListener("mouseout",e));document.addEventListener("visibilitychange",function(a){f.buttonClick=!1})};a.Button.prototype.getScreenshot=function(){var a=document.createElement("canvas");a.width=this.w;a.height=this.h;b=a.getContext("2d");
n=c.evalExpression(this.imageSrc);(r="vacio.gif"===n?this.emptyImage:this.parent.getImage(n))&&r.ready?b.drawImage(r,this._image_pos_x,this._image_pos_y):(b.fillStyle=this.colorInt.getColor(),b.fillRect(0,0,this.w,this.h));b.drawImage(this.canvas,0,0);return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t;a.Spinner=function(b,c){a.Control.call(this,b,c);this.tabindex=++this.parent.tabindex;"_._"==this.name&&(this.name="");"["===this.name.charAt(0)&&
"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);
this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.addControlContainer(this.containerControl);t=this.evaluator.parser.parse("1");this.originalIncr=this.incr;if(0>=this.evaluator.evalExpression(this.decimals)||0==this.evaluator.evalExpression(this.incr)){var d=this.evaluator.evalExpression(this.incr);0<d?this.originalIncr=this.incr=this.evaluator.parser.parse(parseInt(d).toString()):this.incr=t}this.registerMouseAndTouchEvents();
this.init()};a.extend(a.Spinner,a.Control);a.Spinner.prototype.init=function(){f=this.evaluator;var b=f.evalExpression(this.name).toString();this.label.innerHTML=b;this.value=this.validateValue(f.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=2!==this.parent.version?a.getFieldFontSize(this.h):10;var d=2!==this.parent.version?"__":"_____",h=a.getTextWidth(c+"_",this.fieldFontSize+"px Arial"),e=2+parseInt(this.h/2),l=parseInt(this.w/2-e/2),d=a.getTextWidth(b+
d,this.fieldFontSize+"px Arial");this.visible||(l=this.w-e,h=0);l<d&&(l=d);""==b&&(l=0);this.w-l-e<h&&(l=this.w-e-h);0>l&&(l=0);b=this.w-(l+e);this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.setAttribute("id",this.id);this.canvas.setAttribute("width",e+"px");this.canvas.setAttribute("height",this.h+"px");
this.canvas.setAttribute("style","position: absolute; left: "+l+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("class","up");this.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+e+"px; height : "+this.h/2+"px; left: "+l+"px; top: 0px;");this.divDown.setAttribute("class","down");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
e+"px; height : "+this.h/2+"px; left: "+l+"px; top: "+this.h/2+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_spinner");this.field.setAttribute("class","DescartesSpinnerField");this.field.setAttribute("style","font-family: Arial; font-size: "+this.fieldFontSize+"px; width : "+b+"px; height : "+this.h+"px; left: "+(e+l)+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=c;this.visible||(this.field.style.display="none");this.label.setAttribute("class",
"DescartesSpinnerLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+l+"px; height: "+this.h+"px; line-height: "+this.h+"px;");f.setVariable(this.id,this.value);this.createGradient(this.h/2,this.h)};a.Spinner.prototype.update=function(){f=this.evaluator;this.label.innerHTML=f.evalExpression(this.name).toString();0>=f.evalExpression(this.decimals)?(g=f.evalExpression(this.incr),0<g?this.originalIncr=this.incr=f.parser.parse(parseInt(g).toString()):this.incr=t):this.incr=
0!=f.evalExpression(this.originalIncr)?this.originalIncr:t;this.activeIfValue=0<f.evalExpression(this.activeif);this.drawIfValue=0<f.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):(this.click=!1,this.containerControl.style.display="none");this.updatePositionAndSize();this.parent.animation.playing&&document.activeElement==this.field||(c=this.field.value,e=this.value,this.value=this.validateValue(f.getVariable(this.id)),
this.field.value=this.formatOutputValue(this.value),this.value==e&&this.field.value!=c&&(this.value=this.validateValue(c),this.field.value=this.formatOutputValue(this.value)),f.setVariable(this.id,this.value))};a.Spinner.prototype.draw=function(){b=this.ctx;m=this.canvas.width;h=this.canvas.height;b.fillStyle="#f0f8ff";b.fillRect(0,0,m,h);b.fillStyle=this.linearGradient;b.fillRect(0,0,m,h);this.up?(d="gray",n="#f0f8ff"):(d="#f0f8ff",n="gray");a.drawLine(b,0,0,m,0,d);a.drawLine(b,0,0,0,h/2,d);a.drawLine(b,
0,h/2,m,h/2,n);this.down?(d="gray",n="#f0f8ff"):(d="#f0f8ff",n="gray");a.drawLine(b,0,h/2+1,m,h/2+1,d);a.drawLine(b,0,h/2+1,0,h,d);a.drawLine(b,0,h-1,m,h-1,n);r=[parseInt(m/2+1),parseInt(m/5+1),parseInt(m-m/5+1)];k=[parseInt(h/8+1),parseInt(h/8+1+h/4),parseInt(h/8+1+h/4)];b.fillStyle=this.activeIfValue?"#2244cc":"#8888aa";b.beginPath();b.moveTo(r[0],k[0]);b.lineTo(r[1],k[1]);b.lineTo(r[2],k[2]);b.fill();k=[parseInt(h-h/8),parseInt(h-h/8-h/4),parseInt(h-h/8-h/4)];b.fillStyle=this.activeIfValue?"#d00018":
"#aa8888";b.beginPath();b.moveTo(r[0],k[0]);b.lineTo(r[1],k[1]);b.lineTo(r[2],k[2]);b.fill();b.fillStyle="rgba(0,0,0,"+24/255+")";this.up&&b.fillRect(0,0,m,h/2);this.down&&b.fillRect(0,h/2,m,h)};a.Spinner.prototype.validateValue=function(a){f=this.evaluator;isNaN(parseFloat(a))||a.toString().match("e")&&(a=parseFloat(a).toFixed(20));a=void 0!=a?a.toString():"0";a=a.replace(this.parent.decimal_symbol,".");s=a==parseFloat(a)?parseFloat(a):parseFloat(f.evalExpression(f.parser.parse(a)));isNaN(s)&&(s=
0);l=f.evalExpression(this.min);v=f.evalExpression(this.max);""===l&&(l=-Infinity);""===v&&(v=Infinity);s<l&&(s=l);s>v&&(s=v);this.discrete&&(q=f.evalExpression(this.incr),s=0==q?0:q*Math.round(s/q));u=f.evalExpression(this.decimals);0>=u&&(u=0);return s=parseFloat(parseFloat(s).toFixed(u))};a.Spinner.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.evaluator.evalExpression(this.incr))};
a.Spinner.prototype.changeValue=function(a){this.activeIfValue&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Spinner.prototype.registerMouseAndTouchEvents=function(){function b(a,c,d){clearInterval(g);if(k.up||k.down)c.call(k),a=d?a:30,g=setTimeout(function(){b(a,c)},a)}function c(d){d.preventDefault();k.whichButton=a.whichButton(d);"L"==k.whichButton&&k.activeIfValue&&(k.up=!0,b(m,
k.increase,!0),k.draw())}function d(c){c.preventDefault();k.whichButton=a.whichButton(c);"L"==k.whichButton&&k.activeIfValue&&(k.down=!0,b(m,k.decrease,!0),k.draw())}function h(a){k.up=!1;clearInterval(g);k.draw();a.preventDefault()}function e(a){k.down=!1;clearInterval(g);k.draw();a.preventDefault()}function f(a){k.up=!1;clearInterval(g);k.draw()}function l(a){k.down=!1;clearInterval(g);k.draw()}p=a.hasTouchSupport;var k=this,m=p?500:200,g;k.divUp.oncontextmenu=k.divDown.oncontextmenu=k.field.oncontextmenu=
k.label.oncontextmenu=function(){return!1};p?this.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):this.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("keydown",function(a){13==a.keyCode&&k.changeValue(k.field.value)});p?this.divUp.addEventListener("touchstart",c):this.divUp.addEventListener("mousedown",c);p?this.divDown.addEventListener("touchstart",d):this.divDown.addEventListener("mousedown",d);p||this.divUp.addEventListener("mouseout",
h);p||this.divDown.addEventListener("mouseout",e);p?(this.divUp.addEventListener("touchend",f),window.addEventListener("touchend",f)):(this.divUp.addEventListener("mouseup",f),window.addEventListener("mouseup",f));p?(this.divDown.addEventListener("touchend",l),window.addEventListener("touchend",l)):(this.divDown.addEventListener("mouseup",l),window.addEventListener("mouseup",l));document.addEventListener("visibilitychange",function(a){k.up=!1;k.down=!1;clearInterval(g);k.draw()});k.field.addEventListener("click",
function(a){this.select();this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h;a.TextField=function(b,c){a.Control.call(this,b,c);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name.trim()+"'");void 0===this.valueExprString&&(this.valueExprString=this.onlyText?"0":"");this.emptyString=!1;this.ok=0;this.tabindex=++this.parent.tabindex;
this.regExpDecimalSymbol=new RegExp("\\"+this.parent.decimal_symbol,"g");if(this.answer)if(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answerPattern=this.answer,this.answer=a.buildRegularExpresionsPatterns(this.answer,this.evaluator),this.onlyText){var h=this.answerPattern.indexOf("|");this.firstAnswer=-1==h?this.answerPattern:this.answerPattern.substring(0,h)}else this.firstAnswer=this.parser.parse(this.answerPattern.substring(1,this.answerPattern.indexOf(",")));
this.onlyText&&(this.valueExprString.match(/^'/)&&this.valueExprString.match(/'$/)||(this.valueExpr=this.evaluator.parser.parse("'"+this.valueExprString+"'")),this.validateValue=function(a){a=a.toString();return"''"==a||"'"==a?"":a&&a.match(/^'/)&&a.match(/'$/)?a.substring(1,a.length-1):a},this.formatOutputValue=function(a){return a.toString()});""==name.trim()&&(name="");this.containerControl=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");
this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextField,a.Control);a.TextField.prototype.init=function(){f=this.evaluator;var b=f.evalExpression(this.name).toString();this.label.innerHTML=b;this.value=this.validateValue(f.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=a.getFieldFontSize(this.h);var h=a.getTextWidth(c+
"_",this.fieldFontSize+"px Arial"),e=parseInt(this.w/2),m=a.getTextWidth(b,this.fieldFontSize+"px Arial");this.visible||(e=this.w,h=0);e<m&&(e=m);""==b&&(e=0);this.w-e<h&&(e=this.w-h);0>e&&(e=0);b=this.w-e;this.containerControl.setAttribute("class","DescartesTextFieldContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.field.setAttribute("type","text");this.field.setAttribute("id",
this.id+"TextField");this.field.setAttribute("class","DescartesTextFieldField");this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+b+"px; height : "+this.h+"px; left: "+e+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.value=c;this.label.setAttribute("class","DescartesTextFieldLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+e+"px; height: "+this.h+"px; line-height: "+this.h+"px;");this.evaluate&&(this.ok=this.evaluateAnswer());
this.evaluator.setVariable(this.id,this.value);this.evaluator.setVariable(this.id+".ok",this.ok);this.oldValue=this.value;this.update()};a.TextField.prototype.update=function(){f=this.evaluator;this.label.innerHTML=f.evalExpression(this.name).toString();this.activeIfValue=0<f.evalExpression(this.activeif);this.drawIfValue=0<f.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.containerControl.style.display=this.drawIfValue?"block":"none";this.updatePositionAndSize();this.parent.animation.playing&&
document.activeElement==this.field||(g=this.field.value,c=this.value,this.value=this.validateValue(f.getVariable(this.id)),this.field.value=this.formatOutputValue(this.value),this.value===c&&this.field.value!=g&&(this.value=this.validateValue(g),this.field.value=this.formatOutputValue(this.value)),f.setVariable(this.id,this.value))};a.TextField.prototype.validateValue=function(a){if(""===a||"''"==a)return"";f=this.evaluator;a=a.toString().replace(this.regExpDecimalSymbol,".","g");e=a==parseFloat(a)?
parseFloat(a):parseFloat(f.evalExpression(f.parser.parse(a)));isNaN(e)&&(e=0);b=f.evalExpression(this.min);""==b&&(b=-Infinity);m=f.evalExpression(this.max);""==m&&(m=Infinity);this.discrete&&(a=f.evalExpression(this.incr),e=0==a?0:a*Math.round(e/a));return e=parseFloat(parseFloat(e).toFixed(f.evalExpression(this.decimals)))};a.TextField.prototype.formatOutputValue=function(a){return""===a?"":this.uber.formatOutputValue.call(this,a)};a.TextField.prototype.changeValue=function(a,b){this.activeIfValue&&
(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluate&&(this.ok=this.evaluateAnswer()),this.evaluator.setVariable(this.id,this.value),this.evaluator.setVariable(this.id+".ok",this.ok),this.updateAndExecAction())};a.TextField.prototype.evaluateAnswer=function(){return a.esCorrecto(this.answer,this.value,this.evaluator,this.answer)};a.TextField.prototype.getFirstAnswer=function(){return this.answer?this.onlyText?this.firstAnswer:this.evaluator.evalExpression(this.firstAnswer):
""};a.TextField.prototype.registerMouseAndTouchEvents=function(){h=a.hasTouchSupport;var b=this;b.field.oncontextmenu=b.label.oncontextmenu=function(){return!1};h?b.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):b.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.field.addEventListener("blur",function(a){b.evaluator.evalExpression(b.drawIf)&&b.changeValue(b.field.value,!0)});this.field.addEventListener("keydown",function(a){b.activeIfValue&&
13==a.keyCode&&b.changeValue(b.field.value,!0)});b.field.addEventListener("click",function(a){this.select();this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.abs,g,c,e,b,m,h,d,n,r,k,s;a.Menu=function(b,d){this.options="";a.Control.call(this,b,d);g=this.parser;c=this.evaluator;this.ok=0;this.tabindex=++this.parent.tabindex;this.answer&&(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answer=parseInt(this.answer.split(",")[0].replace("[",
""))||0);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.options=this.options.split(",");this.menuOptions=[];this.strValue=[];for(var h,e=0,f=this.options.length;e<f;e++)h=this.customSplit(this.options[e]),1==h.length?(this.menuOptions.push(h[0]),this.strValue.push(e.toString())):2==h.length&&(this.menuOptions.push(h[0]),""==h[1]?this.strValue.push(e.toString()):
this.strValue.push(h[1]));e=0;for(f=this.menuOptions.length;e<f;e++)this.menuOptions[e].match(/^\[/)&&this.menuOptions[e].match(/\]$/)?this.menuOptions[e]=g.parse(this.menuOptions[e].substring(1,this.menuOptions[e].length-1)):this.menuOptions[e]=g.parse("'"+this.menuOptions[e]+"'");e=0;for(f=this.strValue.length;e<f;e++)this.strValue[e].match(/^\[/)&&this.strValue[e].match(/\]$/)?this.strValue[e]=g.parse(this.strValue[e].substring(1,this.strValue[e].length-1)):this.strValue[e]=g.parse(this.strValue[e]);
this.containerControl=document.createElement("div");this.label=document.createElement("label");this.select=document.createElement("select");e=0;for(f=this.menuOptions.length;e<f;e++)h=document.createElement("option"),h.innerHTML=c.evalExpression(this.menuOptions[e]),this.select.appendChild(h);this.field=document.createElement("input");this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.select);this.visible&&this.containerControl.appendChild(this.field);this.addControlContainer(this.containerControl);
this.registerMouseAndTouchEvents();this.init()};a.extend(a.Menu,a.Control);a.Menu.prototype.init=function(b){c=this.evaluator;var d=c.evalExpression(this.name).toString();this.label.innerHTML=d;this.fieldFontSize=2!=this.parent.version?a.getFieldFontSize(this.h):10;var h=0,e=0,f=0;this.value=b?this.value:c.evalExpression(this.valueExpr);this.indexValue=this.getIndex(this.value);b=0;for(var k=this.menuOptions.length;b<k;b++)f=a.getTextWidth(c.evalExpression(this.menuOptions[b]).toString(),this.fieldFontSize+
"px Arial"),f>h&&(h=f,e=b);h+=25;f=a.getTextWidth(this.formatOutputValue(c.evalExpression(this.strValue[e])),this.fieldFontSize+"px Arial")+7;e=a.getTextWidth(d,this.fieldFontSize+"px Arial")+10;""==d&&(e=0);this.visible||(f=0);for(d=this.w-f-e;d<h&&0<e;)e--,d++;for(;d<h&&0<f;)f--,d++;for(;e+d+f+1<this.w;)d++,f++;h=e;b=h+d;f=this.w-b;k=this.formatOutputValue(c.evalExpression(this.strValue[this.indexValue]));this.containerControl.setAttribute("class","DescartesMenuContainer");this.containerControl.setAttribute("style",
"width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index:"+this.zIndex+";");this.label.setAttribute("class","DescartesMenuLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width:"+e+"px; height:"+this.h+"px; line-height:"+this.h+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_menuField");this.field.value=k;this.field.setAttribute("class","DescartesMenuField");this.field.setAttribute("style","font-size: "+
this.fieldFontSize+"px; width: "+f+"px; height: "+this.h+"px; left:"+b+"px;");this.field.setAttribute("tabindex",this.tabindex);this.select.setAttribute("id",this.id+"_menuSelect");this.select.setAttribute("class","DescartesMenuSelect");this.select.setAttribute("style","text-align:left; font-size:"+this.fieldFontSize+"px; width: "+d+"px; height: "+this.h+"px; left: "+h+"px; border: 1.5px solid #7a8a99; background-color: #eeeeee;");this.select.setAttribute("tabindex",this.tabindex);this.select.selectedIndex=
this.indexValue;c.setVariable(this.id,parseFloat(k.replace(this.parent.decimal_symbol,".")));this.update()};a.Menu.prototype.update=function(){c=this.evaluator;this.activeIfValue=0<c.evalExpression(this.activeif);this.drawIfValue=0<c.evalExpression(this.drawif);this.field.disabled=this.activeIfValue?!1:!0;this.select.disabled=this.activeIfValue?!1:!0;this.drawIfValue?this.containerControl.style.display="block":(this.click=!1,this.containerControl.style.display="none");if(!this.parent.animation.playing||
document.activeElement!=this.select){this.label.innerHTML=c.evalExpression(this.name).toString();for(var a=0,b=this.menuOptions.length;a<b;a++)this.select.options[a].innerHTML=c.evalExpression(this.menuOptions[a]);this.value=c.getVariable(this.id);isNaN(this.value)&&(this.value=0);this.field.value=this.formatOutputValue(this.value);c.setVariable(this.id,parseFloat(this.value));this.select.selectedIndex=parseFloat(this.getIndex(this.value))}this.ok=this.value==this.answer?1:0;this.evaluator.setVariable(this.id+
".ok",this.ok);this.updatePositionAndSize()};a.Menu.prototype.customSplit=function(a){d=!1;n="";r=0;for(k=-1;r<a.length;){s=a.charAt(r);a.charAt(r-1);if("["===s&&-1===k){if(d||""!=n)n+="\u00a6";k++}else"["===s?k++:"]"===s&&0===k?(d=!0,k--):"]"==a.charAt(r)&&(k=0>k?k:k-1);n+=a.charAt(r);r++}return n.split("\u00a6")};a.Menu.prototype.getIndex=function(a){a=parseFloat(a.toString().replace(this.parent.decimal_symbol,"."));e=-1;b=Infinity;for(var c=0,d=this.strValue.length;c<d;c++)m=f(a-parseFloat(this.evaluator.evalExpression(this.strValue[c]))),
m<=b&&(b=m,e=c);return e};a.Menu.prototype.changeValue=function(){this.activeIfValue&&(this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction())};a.Menu.prototype.registerMouseAndTouchEvents=function(){h=a.hasTouchSupport;var b=this;b.select.oncontextmenu=b.label.oncontextmenu=b.field.oncontextmenu=function(){return!1};h?b.label.addEventListener("touchstart",function(a){a.preventDefault();return!1}):b.label.addEventListener("mousedown",function(a){a.preventDefault();return!1});this.select.addEventListener("change",
function(a){b.value=b.evaluator.evalExpression(b.strValue[this.selectedIndex]);b.field.value=b.formatOutputValue(b.value);b.evaluator.setVariable(b.id,b.field.value);b.changeValue();a.preventDefault()});this.field.addEventListener("keydown",function(a){13==a.keyCode&&(b.indexValue=b.getIndex(b.field.value),b.value=b.evaluator.evalExpression(b.strValue[b.indexValue]),b.field.value=b.formatOutputValue(b.indexValue),b.select.selectedIndex=b.indexValue,b.changeValue())});b.field.addEventListener("click",
function(a){this.focus()})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.floor,g,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z;a.Scrollbar=function(b,c){a.Control.call(this,b,c);"["===this.name.charAt(0)&&"]"===this.name.charAt(this.name.length-1)?this.name=this.parser.parse(this.name.substring(1,this.name.length-1)):this.name=this.parser.parse("'"+this.name+"'");this.orientation=this.w>=this.h?"h":"v";this.containerControl=document.createElement("div");this.canvas=
document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.scrollManipulator=document.createElement("div");this.label=document.createElement("label");this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.scrollManipulator);
this.addControlContainer(this.containerControl);this.registerMouseAndTouchEvents();this.init()};a.extend(a.Scrollbar,a.Control);a.Scrollbar.prototype.init=function(){g=this.evaluator;this.findOffset();0==g.evalExpression(this.decimals)?this.incr=1:this.incr=(g.evalExpression(this.max)-g.evalExpression(this.min))/100;this.value=this.validateValue(g.evalExpression(this.valueExpr));e=this.formatOutputValue(this.value);b=this.evaluator.evalExpression(this.expresion);this.x=b[0][0];this.y=b[0][1];4==b[0].length&&
(this.w=b[0][2],this.h=b[0][3]);this.orientation=this.w>=this.h?"h":"v";this.initScroll(e);this.changeScrollPositionFromValue();this.prePos=this.pos;g.setVariable(this.id,this.value)};a.Scrollbar.prototype.initScroll=function(b){c=this;g=c.evaluator;var d=g.evalExpression(c.name).toString();c.label.innerHTML=d;var h="v"===c.orientation?parseInt(19+5*(c.h-100)/100):c.h;c.fieldFontSize="v"===c.orientation?h-parseInt(c.h/20)-1:2!==c.parent.version?a.getFieldFontSize(h):10;var e=a.getTextWidth(b+"_",
c.fieldFontSize+"px Arial"),f=c.parent.getSpaceById(c.spaceID).h;c.labelHeight=""==d?0:h;c.fieldHeight=""==c.visible?0:h;if("v"===c.orientation)c.canvasWidth=c.w,c.canvasHeight=c.h-c.labelHeight-c.fieldHeight,18<=c.canvasHeight+c.y-f&&(c.canvasHeight=f),d=0,d=c.fieldHeight,e=d+c.canvasHeight,c.canvasX=0,c.canvasY=c.fieldHeight,c.labelWidth=c.w,c.labelY=e,c.upWidth=c.downW=c.w,c.upHeight=c.downH=15,c.upX=0,c.upY=c.fieldHeight,c.downX=0,c.downY=e-c.downH,c.fieldWidth=c.w,c.fieldX=0,c.scrollManipulatorW=
c.w,c.scrollManipulatorH=parseInt((c.canvasHeight-c.upHeight-c.downH-c.labelHeight-c.fieldHeight)/10),c.scrollManipulatorH=15>c.scrollManipulatorH?15:c.scrollManipulatorH,c.scrollManipulatorLimInf=e-c.downH-c.scrollManipulatorH,c.scrollManipulatorLimSup=d+c.downH;else{h=a.getTextWidth(d,c.fieldFontSize+"px Arial")+10;c.labelWidth=h;c.fieldWidth=e;""==d&&(c.labelWidth=0);c.visible||(c.fieldWidth=0);for(e=c.w-c.fieldWidth-c.labelWidth;58>e&&0<c.labelWidth;)c.labelWidth--,e++;for(;58>e&&0<c.fieldWidth;)c.fieldWidth--,
e++;d=c.labelWidth;h=d+e;c.fieldWidth=c.w-h;c.canvasWidth=e;c.canvasHeight=c.h;c.canvasX=c.labelWidth;c.canvasY=0;c.fieldX=c.canvasWidth+c.labelWidth;c.labelHeight=c.h;c.labelY=0;c.upWidth=c.downW=15;c.upHeight=c.downH=c.h;c.upX=h-c.downW;c.upY=0;c.downX=c.labelWidth;c.downY=0;c.scrollManipulatorW=parseInt((c.canvasWidth-c.upWidth-c.downW)/10);c.scrollManipulatorW=15>c.scrollManipulatorW?15:c.scrollManipulatorW;c.scrollManipulatorH=c.h;c.scrollManipulatorLimInf=d+c.downW;c.scrollManipulatorLimSup=
d+c.canvasWidth-c.downW-c.scrollManipulatorW}c.containerControl.setAttribute("class","DescartesScrollbarContainer");c.containerControl.setAttribute("id",c.id);c.containerControl.setAttribute("style","width: "+c.w+"px; height: "+c.h+"px; left: "+c.x+"px; top: "+c.y+"px; z-index: "+c.zIndex+";");c.canvas.setAttribute("width",c.w+"px");c.canvas.setAttribute("height",c.h+"px");c.canvas.setAttribute("style","position: absolute; left: 0px; top: 0px;");c.ctx=c.canvas.getContext("2d");c.divUp.setAttribute("class",
"DescartesCatcher up");c.divUp.setAttribute("style","width : "+c.upWidth+"px; height : "+c.upHeight+"px; left: "+c.upX+"px; top: "+c.upY+"px;");c.divDown.setAttribute("class","DescartesCatcher down");c.divDown.setAttribute("style","width : "+c.downW+"px; height : "+c.downH+"px; left: "+c.downX+"px; top: "+c.downY+"px;");c.scrollManipulator.setAttribute("class","DescartesCatcher manipulator");c.scrollManipulator.setAttribute("style","width : "+c.scrollManipulatorW+"px; height : "+c.scrollManipulatorH+
"px;");c.scrollManipulator.style.top=("v"===c.orientation?c.scrollManipulatorLimInf:0)+"px";c.scrollManipulator.style.left=("v"===c.orientation?0:c.scrollManipulatorLimInf)+"px";c.field.setAttribute("type","text");c.field.setAttribute("id",c.id+"scrollbar");c.field.setAttribute("class","DescartesScrollbarField");c.field.setAttribute("style","font-size: "+c.fieldFontSize+"px; width : "+c.fieldWidth+"px; height : "+c.fieldHeight+"px; left: "+c.fieldX+"px; top: 0px;");c.field.value=b;0===c.fieldHeight&&
(c.field.style.display="none");c.label.setAttribute("class","DescartesScrollbarLabel");c.label.setAttribute("style","font-size:"+c.fieldFontSize+"px; width: "+c.labelWidth+"px; height: "+c.labelHeight+"px; line-height: "+c.labelHeight+"px; left: 0px; top:"+c.labelY+"px;")};a.Scrollbar.prototype.update=function(){g=this.evaluator;this.label.innerHTML=g.evalExpression(this.name).toString();0==g.evalExpression(this.decimals)?this.incr=1:this.incr=(g.evalExpression(this.max)-g.evalExpression(this.min))/
100;this.activeIfValue=0<g.evalExpression(this.activeif);this.drawIfValue=0<g.evalExpression(this.drawif);this.field.disabled=!this.activeIfValue;this.drawIfValue?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";this.updatePositionAndSize();var a=this.validateValue(g.getVariable(this.id));a==this.value||0<Math.abs(a-this.value)&&1E-9>Math.abs(a-this.value)||(this.value=a,this.changeScrollPositionFromValue(),this.prePos=this.pos);this.value=a;this.field.value=
this.formatOutputValue(this.value);g.setVariable(this.id,this.value)};a.Scrollbar.prototype.draw=function(){c=this;m=c.ctx;d=f(this.w);h=f(this.h);m.fillStyle="#e0e4e8";m.fillRect(0,0,d,h);m.strokeStyle="#7a8a99";c.down&&(m.fillStyle="#ccdcec",m.fillRect(c.downX+.5,c.downY+.5,c.downW,c.downH-1));m.strokeRect(c.downX+.5,c.downY+.5,c.downW,c.downH-1);c.up&&(m.fillStyle="#ccdcec",m.fillRect(c.upX+.5,c.upY-.5,c.upWidth,c.upHeight+1));m.strokeRect(c.upX+.5,c.upY-.5,c.upWidth,c.upHeight+1);n=4;m.fillStyle=
"black";m.beginPath();"h"===c.orientation?(m.moveTo(c.downX+n,c.downH/2),m.lineTo(c.downX+c.downW-n,n),m.lineTo(c.downX+c.downW-n,c.downH-n),m.moveTo(c.upX+c.upWidth-n,c.downH/2),m.lineTo(c.upX+n,n),m.lineTo(c.upX+n,c.downH-n),m.fill(),c.activeIfValue&&(r=f(c.pos),m.fillStyle="#ccdcec",m.fillRect(r+.5,0,f(c.scrollManipulatorW),h),m.strokeStyle="#6382bf",m.strokeRect(r+.5,0,f(c.scrollManipulatorW),h),k=f(c.scrollManipulatorW/2),m.beginPath(),m.moveTo(r+k+.5-2,3),m.lineTo(r+k+.5-2,h-3),m.moveTo(r+k+
.5,3),m.lineTo(r+k+.5,h-3),m.moveTo(r+k+.5+2,3),m.lineTo(r+k+.5+2,h-3),m.stroke())):(m.moveTo(c.downX+c.downW/2,c.downY+c.downH-n),m.lineTo(c.downX+n,c.downY+n),m.lineTo(c.downX+c.downW-n,c.downY+n),m.moveTo(c.upX+c.upWidth/2,c.upY+n),m.lineTo(c.upX+n,c.upY+c.upHeight-n),m.lineTo(c.upX+c.upWidth-n,c.upY+c.upHeight-n),m.fill(),c.activeIfValue&&(r=f(c.pos),m.fillStyle="#ccdcec",m.fillRect(0,r+.5,d,f(c.scrollManipulatorH)),m.strokeStyle="#6382bf",m.strokeRect(0,r+.5,d,f(c.scrollManipulatorH)),k=f(c.scrollManipulatorH/
2),m.beginPath(),m.moveTo(3,r+k+.5-2),m.lineTo(d-3,r+k+.5-2),m.moveTo(3,r+k+.5),m.lineTo(d-3,r+k+.5),m.moveTo(3,r+k+.5+2),m.lineTo(d-3,r+k+.5+2),m.stroke()));m.strokeRect(.5,.5,d-1,h-1);c.activeIfValue||(m.fillStyle="rgba(240,240,240,"+160/255+")",m.fillRect(0,0,d,h.h))};a.Scrollbar.prototype.validateValue=function(a){g=this.evaluator;s=a.toString();s=parseFloat(s.replace(this.parent.decimal_symbol,"."));isNaN(s)&&(s=0);this.minimo=g.evalExpression(this.min);s<this.minimo&&(this.value=null,s=this.minimo);
this.maximo=g.evalExpression(this.max);s>this.maximo&&(this.value=null,s=this.maximo);q=this.incr;s=0!=q?s*q/q:0;this.fixed&&(s=parseFloat(parseFloat(s).toFixed(g.evalExpression(this.decimals))));return s};a.Scrollbar.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.incr)};a.Scrollbar.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.incr)};a.Scrollbar.prototype.increase10=function(){n=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/
10;"h"==this.orientation?this.clickPos.x>this.prePos&&this.changeValue(parseFloat(this.value)+n):this.clickPos.y<this.prePos&&this.changeValue(parseFloat(this.value)+n)};a.Scrollbar.prototype.decrease10=function(){n=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;"h"==this.orientation?this.clickPos.x<this.prePos&&this.changeValue(parseFloat(this.value)-n):this.clickPos.y>this.prePos&&this.changeValue(parseFloat(this.value)-n)};a.Scrollbar.prototype.changeValue=
function(a){this.activeIfValue&&(u=this.validateValue(a),u!=this.value&&(this.value=u,this.field.value=this.formatOutputValue(u),this.changeScrollPositionFromValue(),this.prePos=this.pos,this.evaluator.setVariable(this.id,this.value),this.updateAndExecAction()))};a.Scrollbar.prototype.changeValueForScrollMovement=function(){g=this.evaluator;l=this.scrollManipulatorLimInf;v=this.scrollManipulatorLimSup;p=g.evalExpression(this.min);t=g.evalExpression(this.max);q=this.incr;u=f((this.pos-l)*(t-p)/(v-
l)/q)*q+p;u!=this.value&&(this.value=u,this.field.value=this.formatOutputValue(u),g.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.update())};a.Scrollbar.prototype.changeScrollPositionFromValue=function(){g=this.evaluator;l=this.scrollManipulatorLimInf;v=this.scrollManipulatorLimSup;p=g.evalExpression(this.min);t=g.evalExpression(this.max);q=this.incr;this.pos=(this.value-p)*(v-l)/(t-p)+l;"h"==this.orientation?this.scrollManipulator.style.left=this.pos+
"px":this.scrollManipulator.style.top=this.pos+"px"};a.Scrollbar.prototype.registerMouseAndTouchEvents=function(){function b(a,c,d,h){clearInterval(v);(t.up||t.down||t.canvasClick)&&1E-7<Math.abs(t.value-h)&&(c.call(t),a=d?a:30,v=setTimeout(function(){b(a,c,!1,h)},a))}function c(d){d.preventDefault();t.whichButton=a.whichButton(d);"L"==t.whichButton&&t.activeIfValue&&(t.clickPos=t.getCursorPosition(d),t.canvasClick=!0,"h"==t.orientation?t.clickPos.x<t.prePos?b(u,t.decrease10,!0,t.minimo):b(u,t.increase10,
!0,t.maximo):t.clickPos.y<t.prePos?b(u,t.increase10,!0,t.maximo):b(u,t.decrease10,!0,t.minimo))}function d(a){t.canvasClick=!1;clearInterval(v)}function h(a){!0==t.canvasClick&&(t.clickPos=t.getCursorPosition(a),a.preventDefault())}function e(a){t.activeIfValue&&(t.scrollClick=!0,t.initPos=t.getCursorPosition(a),window.addEventListener("mouseup",l),window.addEventListener("mousemove",m),a.preventDefault())}function f(a){t.activeIfValue&&(t.scrollClick=!0,t.initPos=t.getCursorPosition(a),window.addEventListener("touchend",
k),window.addEventListener("touchmove",m),a.preventDefault())}function l(a){t.scrollClick=!1;t.prePos=t.pos;window.removeEventListener("mouseup",l,!1);window.removeEventListener("mousemove",m,!1);a.preventDefault()}function k(a){t.scrollClick=!1;t.prePos=t.pos;window.removeEventListener("touchend",k,!1);window.removeEventListener("touchmove",m,!1);a.preventDefault()}function m(a){var b=t.getCursorPosition(a);"h"==t.orientation?(t.pos=t.prePos-(t.initPos.x-b.x),t.pos<t.scrollManipulatorLimInf&&(t.pos=
t.scrollManipulatorLimInf),t.pos>t.scrollManipulatorLimSup&&(t.pos=t.scrollManipulatorLimSup),t.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+t.scrollManipulatorW+"px; height : "+t.h+"px; left: "+t.pos+"px; top: 0px;")):(t.pos=t.prePos-(t.initPos.y-b.y),t.pos>t.scrollManipulatorLimInf&&(t.pos=t.scrollManipulatorLimInf),t.pos<t.scrollManipulatorLimSup&&(t.pos=t.scrollManipulatorLimSup),t.scrollManipulator.setAttribute("style",
"background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+t.w+"px; height : "+t.scrollManipulatorH+"px; left: 0px; top: "+t.pos+"px;"));t.changeValueForScrollMovement();a.preventDefault()}function g(c){c.preventDefault();t.whichButton=a.whichButton(c);"L"==t.whichButton&&t.activeIfValue&&(t.up=!0,b(u,t.increase,!0,t.maximo))}function n(c){c.preventDefault();t.whichButton=a.whichButton(c);"L"==t.whichButton&&t.activeIfValue&&(t.down=!0,b(u,t.decrease,!0,t.minimo))}function r(a){t.up=
!1;clearInterval(v);a.preventDefault()}function q(a){t.down=!1;clearInterval(v);a.preventDefault()}function p(a){t.up=!1;clearInterval(v);t.draw()}function s(a){t.down=!1;clearInterval(v);t.draw()}w=a.hasTouchSupport;var t=this,u=w?500:200,v;t.canvas.oncontextmenu=t.divUp.oncontextmenu=t.divDown.oncontextmenu=t.label.oncontextmenu=t.field.oncontextmenu=t.scrollManipulator.oncontextmenu=function(){return!1};this.field.addEventListener("keydown",function(a){13==a.keyCode&&t.changeValue(t.field.value)});
w?this.canvas.addEventListener("touchstart",c):this.canvas.addEventListener("mousedown",c);w||this.divDown.addEventListener("mouseout",q);w?window.addEventListener("touchend",d):window.addEventListener("mouseup",d);w?this.canvas.addEventListener("touchmove",h):this.canvas.addEventListener("mousemove",h);w?this.scrollManipulator.addEventListener("touchstart",f):this.scrollManipulator.addEventListener("mousedown",e);w?this.divUp.addEventListener("touchstart",g):this.divUp.addEventListener("mousedown",
g);w?this.divDown.addEventListener("touchstart",n):this.divDown.addEventListener("mousedown",n);w||this.divUp.addEventListener("mouseout",r);w||this.divDown.addEventListener("mouseout",q);w?window.addEventListener("touchend",p):window.addEventListener("mouseup",p);w?window.addEventListener("touchend",s):window.addEventListener("mouseup",s)};a.Scrollbar.prototype.findOffset=function(){A=this.containerControl;this.offsetTop=this.offsetLeft=0;C=this.containerControl.style.display;for(this.containerControl.style.display=
"block";A;)this.offsetLeft+=A.offsetLeft||0,this.offsetTop+=A.offsetTop||0,A=A.parentNode;this.containerControl.style.display=C};a.Scrollbar.prototype.getCursorPosition=function(b){z=a.getCursorPosition(b);return{x:z.x-this.offsetLeft,y:z.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f;a.Audio=function(c,e){this.controls=!0;this.file="";this.oldDrawIf=0;a.Control.call(this,c,e);var b=this,f=b.evaluator.evalExpression(b.expresion);4==f[0].length?(b.w=
f[0][2],b.h=f[0][3]):(b.w=200,b.h=28);b.audio=b.parent.getAudio(b.file);b.autoplay&&(b.audio.setAttribute("autoplay","autoplay"),b.audio.play());b.loop&&b.audio.setAttribute("loop","loop");b.controls&&b.audio.setAttribute("controls","controls");b.audio.setAttribute("style","position: absolute; width: "+b.w+"px; left: "+b.x+"px; top: "+b.y+"px; z-index: "+b.zIndex+";");b.addControlContainer(b.audio);b.evaluator.setFunction(b.id+".play",function(){b.audio.play();return 0});b.evaluator.setFunction(b.id+
".pause",function(){b.audio.pause();return 0});b.evaluator.setFunction(b.id+".stop",function(){b.audio.pause();return b.audio.currentTime=0});b.evaluator.setFunction(b.id+".currentTime",function(a){b.audio.currentTime=parseFloat(a);return 0});b.audio.addEventListener("timeupdate",function(a){b.evaluator.setVariable(b.id+".currentTime",b.audio.currentTime)})};a.extend(a.Audio,a.Control);a.Audio.prototype.init=function(){this.audio.style.left=this.x+"px";this.audio.style.top=this.y+"px";this.update()};
var g;a.Audio.prototype.update=function(){f=this.evaluator;(g=0<f.evalExpression(this.drawif))?this.audio.style.display="block":(this.audio.style.display="none",g!==this.oldDrawIf&&this.audio.pause());this.oldDrawIf=g;this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f;a.Video=function(c,e){this.controls=!0;this.file="";this.oldDrawIf=0;a.Control.call(this,c,e);var b=this;f=b.evaluator;var m=b.evaluator.evalExpression(b.expresion);4==m[0].length?
(b.w=m[0][2],b.h=m[0][3]):(b.w=null,b.h=null);b.video=document.createElement("video");b.autoplay&&b.video.setAttribute("autoplay","autoplay");b.loop&&b.video.setAttribute("loop","loop");b.controls&&b.video.setAttribute("controls","controls");b.poster&&b.video.setAttribute("poster",b.poster);b.w&&(b.video.setAttribute("width",b.w),b.video.setAttribute("height",b.h));b.video.setAttribute("style","position: absolute; overflow: hidden; left: "+b.x+"px; top: "+b.y+"px;");var m=b.file,h=m.lastIndexOf(".");
-1!=h&&(m=b.file.substring(0,h));b.video.canPlayType("video/mp4")&&(h=document.createElement("source"),h.setAttribute("src",m+".mp4"),h.setAttribute("type","video/mp4"),b.video.appendChild(h));b.video.canPlayType("video/ogg")&&(h=document.createElement("source"),h.setAttribute("src",m+".ogg"),h.setAttribute("type","video/ogg"),b.video.appendChild(h),h=document.createElement("source"),h.setAttribute("src",m+".ogv"),h.setAttribute("type","video/ogg"),b.video.appendChild(h));b.video.canPlayType("video/webm")&&
(h=document.createElement("source"),h.setAttribute("src",m+".webm"),h.setAttribute("type","video/webm"),b.video.appendChild(h));b.addControlContainer(b.video);b.evaluator.setFunction(b.id+".play",function(){b.video.play();return 0});b.evaluator.setFunction(b.id+".pause",function(){b.video.pause();return 0});b.evaluator.setFunction(b.id+".stop",function(){b.video.pause();return b.video.currentTime=0});b.evaluator.setFunction(b.id+".currentTime",function(a){b.video.currentTime=parseFloat(a);return 0});
b.video.addEventListener("timeupdate",function(a){b.evaluator.setVariable(b.id+".currentTime",b.video.currentTime)})};a.extend(a.Video,a.Control);a.Video.prototype.init=function(){this.video.style.left=this.x+"px";this.video.style.top=this.y+"px";this.update()};var g;a.Video.prototype.update=function(){f=this.evaluator;g=0<f.evalExpression(this.drawif);0<f.evalExpression(this.drawif)?this.video.style.display="block":(this.video.style.display="none",g!==this.oldDrawIf&&this.video.pause());this.oldDrawIf=
g;this.updatePositionAndSize()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g;a.TextArea=function(c,e){this.font="Monospaced,PLAIN,12";a.Control.call(this,c,e);this.region="interior";this.tabindex=++this.parent.tabindex;if(this.answer){this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7)));var b=this.parent.lessonParser.parseText(this.answer)}this.containerControl=document.createElement("div");this.textArea=document.createElement("div");
this.textAreaAnswer=document.createElement("div");this.showButton=document.createElement("div");this.activeCover=document.createElement("div");this.containerControl.appendChild(this.textArea);this.containerControl.appendChild(this.textAreaAnswer);this.containerControl.appendChild(this.showButton);this.containerControl.appendChild(this.activeCover);this.addControlContainer(this.containerControl);this.showAnswer=!1;this.text=void 0==this.text||"simpleText"==this.text.type?this.rawText||"":this.text.hasFormula?
this.rawText:this.text.toHTML();b&&"simpleText"!=b.type&&(this.answer=this.text.hasFormula?"":b.toHTML());this.evaluator.setVariable(this.id,this.text);this.drawButton();this.registerMouseAndTouchEvents();this.init()};a.extend(a.TextArea,a.Control);a.TextArea.prototype.init=function(){g=this.answer?28:8;f=this.evaluator;var c;c=this.text.match(/<span/)?this.text:this.text.replace(/\\n/g,"<br/>");this.containerControl.setAttribute("class","DescartesTextAreaContainer");this.containerControl.setAttribute("style",
"width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=0<f.evalExpression(this.drawif)?"block":"none";this.containerControl.setAttribute("spellcheck","false");this.textArea.setAttribute("class","DescartesTextAreaContainer");this.textArea.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-g)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");
this.textArea.setAttribute("contenteditable","true");this.textArea.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;' >"+c+"</span>";this.textAreaAnswer.setAttribute("class","DescartesTextAreaContainer");this.textAreaAnswer.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-g)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textAreaAnswer.style.display=this.showAnswer?"block":"none";
this.textAreaAnswer.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;'>"+this.answer+"</span>";this.showButton.setAttribute("style","width: 20px; height: 16px; position: absolute; bottom: 4px; right: 4px; cursor: pointer;");this.showButton.style.backgroundImage="url("+this.imageUnPush+")";this.showButton.style.display=this.answer?"block":"none";this.showButton.innerHTML="<span style='position: relative; top: 2px; text-align: center; font: 9px Arial'> S </span>";
this.activeCover.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.update()};a.TextArea.prototype.drawButton=function(){var c=document.createElement("canvas");c.setAttribute("width",20);c.setAttribute("height",16);var e=c.getContext("2d");this.canvas=c;this.ctx=e;this.createGradient(20,16);e.lineWidth=1;e.fillStyle="white";e.fillRect(0,0,20,16);e.fillStyle=this.linearGradient;e.fillRect(0,0,20,16);a.drawLine(e,19,0,19,
16,"rgba(0,0,0,"+128/255+")");a.drawLine(e,0,0,0,16,"rgba(0,0,0,"+24/255+")");a.drawLine(e,1,0,1,16,"rgba(0,0,0,"+8/255+")");this.imageUnPush=c.toDataURL();e.fillStyle="white";e.fillRect(0,0,20,16);e.fillStyle=this.linearGradient;e.fillRect(0,0,20,16);a.drawLine(e,0,0,0,14,"gray");a.drawLine(e,0,0,19,0,"gray");e.fillStyle="rgba(0, 0, 0,"+24/255+")";e.fillRect(0,0,this.w,this.h);this.imagePush=c.toDataURL()};a.TextArea.prototype.update=function(){f=this.evaluator;this.activeIfValue=0<f.evalExpression(this.activeif);
this.drawIfValue=0<f.evalExpression(this.drawif);var a;a=this.text.match(/<span/)?this.rawText:this.text;f.setVariable(this.id,a);this.activeCover.style.display=this.activeIfValue?"none":"block";this.containerControl.style.display=this.drawIfValue?"block":"none";this.updatePositionAndSize()};a.TextArea.prototype.registerMouseAndTouchEvents=function(){function a(b){b.preventDefault();e.showButton.style.backgroundImage="url("+e.imageUnPush+")"}var e=this;this.showButton.addEventListener("mousedown",
function(a){a.preventDefault();e.showAnswer=!e.showAnswer;e.textAreaAnswer.style.display=e.showAnswer?"block":"none";e.showButton.childNodes[0].childNodes[0].textContent=e.showAnswer?"T":"S";e.showButton.style.backgroundImage="url("+e.imagePush+")"});this.showButton.addEventListener("mouseup",a);this.showButton.addEventListener("mouseout",a)};a.TextArea.prototype.getScreenshot=function(){var a=document.createElement("canvas");a.setAttribute("width",this.w);a.setAttribute("height",this.h);var e=a.getContext("2d");
e.fillStyle="white";e.strokeStyle="black";e.lineWidth=1;e.fillRect(0,0,this.w,this.h);e.strokeRect(0,0,this.w,this.h);return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=2*Math.PI,g,c,e,b,m,h,d,n,r;a.GraphicControl=function(b,d){c=b.evaluator.parser;this.text=this.spaceID="";this.size=c.parse("4");this.font="Monospaced,PLAIN,12";this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";a.Control.call(this,b,d);this.touchId=null;this.font=
a.convertFont(this.font);if(this.constraintExpr){this.constraint=c.parse(this.constraintExpr);"(expr)"==this.constraint.type&&(this.constraint=c.parse(this.constraintExpr.substring(1,this.constraintExpr.length-1)));if("compOperator"==this.constraint.type){var h=this.constraint.childs[0],e=this.constraint.childs[1];"identifier"!=h.type||"y"!=h.value||e.contains("y")?"identifier"!=h.type||"x"!=h.value||e.contains("x")?this.newt=new a.R2Newton(this.evaluator,this.constraint):(this.evalConstraint=this.evalConstraintY,
this.constraint=e):(this.evalConstraint=this.evalConstraintX,this.constraint=e)}else this.constraint=null;n=new a.R2(0,0)}this.container=this.getContainer();this.mouseCacher=document.createElement("div");this.mouseCacher.setAttribute("class","DescartesGraphicControl");this.mouseCacher.setAttribute("id",this.id);this.mouseCacher.setAttribute("dragged",!0);this.mouseCacher.setAttribute("tabindex","-1");this.ctx=this.space.ctx;this.container.appendChild(this.mouseCacher);this.registerMouseAndTouchEvents();
this.xString=this.id+".x";this.yString=this.id+".y";this.activoString=this.id+".activo";this.activeString=this.id+".active";""!==this.space.id&&2!==b.version?(this.mxString=this.space.id+".mouse_x",this.myString=this.space.id+".mouse_y",this.mclickedString=this.space.id+".mouse_clicked",this.mclicizquierdoString=this.space.id+".clic_izquierdo"):(this.mxString="mouse_x",this.myString="mouse_y",this.mclickedString="mouse_clicked",this.mclicizquierdoString="clic_izquierdo");this.init()};a.GraphicControl.prototype.init=
function(){g=this.evaluator;r=a.hasTouchSupport;var b=g.evalExpression(this.expresion);this.x=b[0][0];this.y=b[0][1];g.setVariable(this.xString,this.x);g.setVariable(this.yString,this.y);this.mouseCacher.setAttribute("style","cursor: pointer; background-color: rgba(255, 255, 255, 0); z-index: "+this.zIndex+";");""==this.imageSrc||this.imageSrc.toLowerCase().match(/vacio.gif$/)?(this.width=2*g.evalExpression(this.size),this.height=2*g.evalExpression(this.size),this._w=r&&48>this.width?48:this.width,
this._h=r&&48>this.height?48:this.height,this.mouseCacher.style.borderRadius=parseInt(Math.min(this._w,this._h)/2)+"px"):(this.image=this.parent.getImage(this.imageSrc),this.width=this.image.width,this.height=this.image.height,this._w=Math.max(this.width,32),this._h=Math.max(this.height,32));this.mouseCacher.style.width=this._w+"px";this.mouseCacher.style.height=this._h+"px";this.mouseCacher.style.left=parseInt(this.space.getAbsoluteX(this.x)-this._w/2)+"px";this.mouseCacher.style.top=parseInt(this.space.getAbsoluteY(this.y)-
this._h/2)+"px";g.setVariable(this.activoString,0);g.setVariable(this.activeString,0);this.setImage=!1;this.update()};a.GraphicControl.prototype.update=function(){g=this.evaluator;this.activeIfValue=0<g.evalExpression(this.activeif);this.drawIfValue=0<g.evalExpression(this.drawif);this.x=g.getVariable(this.xString);this.y=g.getVariable(this.yString);e=this.space.getAbsoluteX(this.x);b=this.space.getAbsoluteY(this.y);this.mouseCacher.style.display=this.activeIfValue?"block":"none";this.mouseCacher.style.left=
parseInt(e-this._w/2)+"px";this.mouseCacher.style.top=parseInt(b-this._h/2)+"px";this.constraint&&this.evalConstraint();this.draw()};a.GraphicControl.prototype.draw=function(){g=this.evaluator;this.drawIfValue&&(h=this.ctx,d=this.space.backgroundCtx,e=parseInt(this.space.getAbsoluteX(this.x))+.5,b=parseInt(this.space.getAbsoluteY(this.y))+.5,""!=this.text&&this.drawText(e,b),this.image.ready?(this.image.complete&&!this.setImage&&h.drawImage(this.image,parseInt(e-this.image.width/2),parseInt(b-this.image.height/
2)),this.trace&&(d.save(),d.translate(e,b),d.scale(parseInt(this.image.width/2),parseInt(this.image.height/2)),d.beginPath(),d.arc(0,0,1,0,f,!1),d.restore(),d.lineWidth=1,d.strokeStyle=this.trace.getColor(),d.stroke())):(h.beginPath(),h.arc(e,b,parseInt(this.width/2),0,f,!1),h.fillStyle=this.colorInt.getColor(),h.fill(),h.lineWidth=1,h.strokeStyle=this.color.getColor(),h.stroke(),this.active&&(h.beginPath(),h.arc(e,b,parseInt(this.width/2)-2,0,f,!1),h.strokeStyle=this.colorInt.borderColor(),h.stroke()),
this.trace&&(d.lineWidth=1,d.strokeStyle=this.trace.getColor(),d.beginPath(),d.arc(e,b,parseInt(this.width/2),0,f,!1),d.stroke())))};a.GraphicControl.prototype.evalConstraint=function(){n.set(this.x,this.y);m=this.newt.findZero(n,1/this.space.scale,!0);this.x=m.x;this.y=m.y;this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y)};a.GraphicControl.prototype.evalConstraintX=function(){var a=this.evaluator.getVariable("x");this.evaluator.setVariable("x",this.x);
this.y=this.evaluator.evalExpression(this.constraint);this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y);this.evaluator.setVariable("x",a)};a.GraphicControl.prototype.evalConstraintY=function(){var a=this.evaluator.getVariable("y");this.evaluator.setVariable("y",this.y);this.x=this.evaluator.evalExpression(this.constraint);this.evaluator.setVariable(this.xString,this.x);this.evaluator.setVariable(this.yString,this.y);this.evaluator.setVariable("y",a)};
a.GraphicControl.prototype.drawText=function(a,b){h=this.ctx;g=this.evaluator;"simpleText"==this.text.type?(h.fillStyle=this.color.getColor(),h.font=this.font,h.textBaseline="alphabetic",h.fillText(this.text.toString(g.evalExpression(this.decimals),this.fixed),parseInt(a+1+this.width/2),parseInt(b-1-this.height/2))):(h.fillStyle=this.color.getColor(),h.strokeStyle=this.color.getColor(),h.textBaseline="alphabetic",this.text.draw(h,parseInt(a+1+this.width/2),parseInt(b-1-this.height/2),this.decimals,
this.fixed,"start",!0,this.color.getColor()))};a.GraphicControl.prototype.getContainer=function(){for(var a=this.parent.spaces,b,c=0,d=a.length;c<d;c++)if(b=a[c],b.id==this.spaceID)return b.addCtr(this),this.zIndex=b.zIndex,this.space=b,b.graphicControlContainer;a[0].addCtr(this);this.zIndex=a[0].zIndex;this.space=a[0];return a[0].graphicControlContainer};a.GraphicControl.prototype.deactivate=function(){this.active=!1;this.evaluator.setVariable(this.activoString,0);this.evaluator.setVariable(this.activeString,
0);this.evaluator.setVariable(this.mclickedString,0);this.evaluator.setVariable(this.mclicizquierdoString,0)};a.GraphicControl.prototype.registerMouseAndTouchEvents=function(){function b(c){document.body.focus();c.preventDefault();g.whichButton=a.whichButton(c);"L"==g.whichButton&&g.activeIfValue&&g.over&&(g.parent.deactivateGraphiControls(),g.click=!0,g.active=!0,g.evaluator.setVariable(g.activoString,1),g.evaluator.setVariable(g.activeString,1),g.evaluator.setVariable(g.mclickedString,0),g.evaluator.setVariable(g.mclicizquierdoString,
0),g.posAnte=g.getCursorPosition(c),g.prePos={x:g.space.getAbsoluteX(g.x),y:g.space.getAbsoluteY(g.y)},g.evaluator.setVariable(g.mxString,g.space.getRelativeX(g.posAnte.x)),g.evaluator.setVariable(g.myString,g.space.getRelativeY(g.posAnte.y)),g.parent.update(),window.addEventListener("mouseup",d),window.addEventListener("mousemove",h))}function c(a){document.body.focus();a.preventDefault();g.activeIfValue&&(g.parent.deactivateGraphiControls(),g.click=!0,g.active=!0,g.evaluator.setVariable(g.activoString,
1),g.evaluator.setVariable(g.activeString,1),g.evaluator.setVariable(g.mclickedString,0),g.evaluator.setVariable(g.mclicizquierdoString,0),g.posAnte=g.getCursorPosition(a),g.prePos={x:g.space.getAbsoluteX(g.x),y:g.space.getAbsoluteY(g.y)},g.evaluator.setVariable(g.mxString,g.space.getRelativeX(g.posAnte.x)),g.evaluator.setVariable(g.myString,g.space.getRelativeY(g.posAnte.y)),g.parent.update(),window.addEventListener("touchmove",h),window.addEventListener("touchend",d))}function d(b){document.body.focus();
b.preventDefault();b.stopPropagation();g.touchId=null;g.evaluator.setVariable(g.mclickedString,1);g.evaluator.setVariable(g.mclicizquierdoString,1);if(g.activeIfValue||g.active)g.click=!1,a.hasTouchSupport?(window.removeEventListener("touchmove",h,!1),window.removeEventListener("touchend",d,!1)):(window.removeEventListener("mouseup",d,!1),window.removeEventListener("mousemove",h,!1)),n=g.getCursorPosition(b),g.posX=g.prePos.x-(g.posAnte.x-n.x),g.posY=g.prePos.y-(g.posAnte.y-n.y),g.evaluator.setVariable(g.xString,
g.space.getRelativeX(g.posX)),g.evaluator.setVariable(g.yString,g.space.getRelativeY(g.posY)),g.evaluator.setVariable(g.mxString,g.space.getRelativeX(n.x)),g.evaluator.setVariable(g.myString,g.space.getRelativeY(n.y)),g.parent.update(),g.mouseCacher.style.left=g.space.getAbsoluteX(g.x)-g._w/2+"px",g.mouseCacher.style.top=g.space.getAbsoluteY(g.y)-g._h/2+"px";g.parent.deactivateGraphiControls()}function h(a){a.preventDefault();a.touchId=g.touchId;g.evaluator.setVariable(g.mclickedString,0);g.evaluator.setVariable(g.mclicizquierdoString,
0);n=g.getCursorPosition(a);g.posX=g.prePos.x-(g.posAnte.x-n.x);g.posY=g.prePos.y-(g.posAnte.y-n.y);g.evaluator.setVariable(g.xString,g.space.getRelativeX(g.posX));g.evaluator.setVariable(g.yString,g.space.getRelativeY(g.posY));g.evaluator.setVariable(g.mxString,g.space.getRelativeX(n.x));g.evaluator.setVariable(g.myString,g.space.getRelativeY(n.y));10<Date.now()-m&&(g.parent.updateControls(),g.parent.update(),m=Date.now())}function e(a){g.over=!0}function f(a){g.over=!1;g.click=!1}var m=0,g=this;
this.active=this.over=this.click=!1;this.mouseCacher.oncontextmenu=function(){return!1};a.hasTouchSupport?this.mouseCacher.addEventListener("touchstart",c):(this.mouseCacher.addEventListener("mousedown",b),this.mouseCacher.addEventListener("mouseover",e),this.mouseCacher.addEventListener("mouseout",f));var n};a.GraphicControl.prototype.getCursorPosition=function(a){if(a.touches){var b;if(a.touchId)for(c=0,d=a.touches.length;c<d;c++){if(a.touches[c].identifier==a.touchId){b=a.touches[c];break}}else for(var c=
0,d=a.touches.length;c<d;c++)if(a.target==a.touches[c].target){b=a.touches[c];this.touchId=b.identifier;break}mouseX=b.pageX;mouseY=b.pageY}else void 0!=a.pageX&&void 0!=a.pageY?(mouseX=a.pageX,mouseY=a.pageY):(mouseX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,mouseY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:mouseX-(this.space.offsetLeft+document.body.scrollLeft),y:mouseY-(this.space.offsetTop+document.body.scrollTop)}};return a}(descartesJS||
{}),descartesJS=function(a,f){var g,c,e,b,m,h,d,n,r,k;if(a.loadLib)return a;var s,q,u,l,v,p,t,w,A=/[\w-//]*(\.png|\.jpg|\.gif|\.svg)/gi,C,z,B,E,D,y,I,G,H,J,x,K,F,L,M,N,R,S,P,Q,O;a.LessonParser=function(b){this.parent=b;this.parser=b.evaluator.parser;this.RTFparser=new a.RTFParser(b.evaluator)};a.LessonParser.prototype.parseButtonsConfig=function(a){var b={rowsNorth:0,rowsSouth:0,widthEast:125,widthWest:125,height:23};a=this.split(a);for(var c=0,d=a.length;c<d;c++)switch(u=a[c][0],l=a[c][1],q=f[u],
q){case "rowsNorth":case "rowsSouth":case "widthEast":case "widthWest":case "height":b[q]=parseInt(l);break;case "about":case "config":case "init":case "clear":b[q]="true"===f[l];break;default:console.log("----- attributo de space no identificado: <"+u+"> valor: <"+l+"> -----")}return b};a.LessonParser.prototype.parseSpace=function(b){v={};b=this.split(b);for(var c=0,d=b.length;c<d;c++)switch(u=b[c][0],l=b[c][1],q=f[u],q){case "type":case "id":case "cID":case "file":v[q]=l;break;case "fixed":case "numbers":case "sensitive_to_mouse_movements":case "R3":case "split":v[q]=
"true"===f[l];break;case "bg_display":case "render":v[q]=f[l];break;case "net":case "net10":case "axes":case "text":v[q]=""!=l?"false"===f[l]?"":new a.Color(l,this.parent.evaluator):"";break;case "x_axis":case "y_axis":v[q]="false"===f[l]?"":l;break;case "O.x":v.OxExpr=l;break;case "O.y":v.OyExpr=l;break;case "image":v.imageSrc=l;break;case "x":s=l;s="%"===s[s.length-1]?(this.parent.container.width*parseFloat(s)/100).toString():l;v.xExpr=this.parser.parse(s);break;case "y":s=l;s="%"===s[s.length-
1]?(this.parent.container.height*parseFloat(s)/100).toString():l;v.yExpr=this.parser.parse(s);break;case "width":s=l.trim();"%"===s[s.length-1]?(v.wExpr=s,s=this.parent.container.width*parseFloat(s)/100):(s=parseFloat(l),s!=l&&(s=this.parent.container.width,v._w_=l.trim()));v.w=s;break;case "height":s=l.trim();"%"===s[s.length-1]?(v.hExpr=s,s=this.parent.container.height*parseFloat(s)/100):(s=parseFloat(l),s!=l&&(s=this.parent.container.height,v._h_=l.trim()));v.h=s;break;case "drawif":""!=l&&(v.drawif=
this.parser.parse(l));break;case "scale":s=parseFloat(l);isNaN(s)&&(s=48);v.scale=s;break;case "background":v.background=new a.Color(l,this.parent.evaluator);break;default:console.log("----- attributo de space no identificado: <"+u+"> valor: <"+l+"> -----")}switch(v.type){case "R2":return new a.Space2D(this.parent,v);case "R3":return new a.Space3D(this.parent,v);case "AP":return new a.SpaceAP(this.parent,v);case "HTMLIFrame":return new a.SpaceHTML_IFrame(this.parent,v);default:return new a.Space2D(this.parent,
v)}};a.LessonParser.prototype.parseControl=function(b){p={type:"numeric"};b=this.split(b);for(var c=0,d=b.length;c<d;c++)switch(u=b[c][0],l=b[c][1],q=f[u],q){case "id":case "name":case "parameter":case "tooltip":case "tooltipFont":case "Explanation":case "ExplanationFont":case "cID":case "options":case "font":case "file":case "answer":p[q]=l;break;case "gui":case "region":case "action":case "msg_pos":case "poster":p[q]=f[l];break;case "fixed":case "visible":case "discrete":case "onlyText":case "evaluate":case "autoplay":case "loop":case "controls":p[q]=
"true"===f[l];break;case "color":case "colorInt":case "trace":p[q]=new a.Color(l,this.parent.evaluator);break;case "font_size":case "drawif":case "activeif":case "decimals":case "min":case "max":case "size":""!=l&&(p[q]=this.parser.parse(l));break;case "constraint":p.constraintExpr=l;break;case "image":p.imageSrc=l;break;case "space":p.spaceID=l;break;case "type":p.type=f[l.trim()];break;case "expresion":p.expresion=this.parser.parse(l.replace(")(",","));break;case "bold":"false"!=f[l]&&(p.bold="bold");
break;case "italics":"false"!=f[l]&&(p.italics="italic");break;case "underlined":"false"!=f[l]&&(p.underlined=!0);break;case "value":var h=l.replace(/&squot;/g,"'");h.match(/^\|/)&&(h="'"+h.substring(1),h.match(/\|$/)&&(h=h.substring(0,h.length-1)+"'"));p.valueExpr=this.parser.parse(h);p.valueExprString=h;break;case "incr":0!=l&&(p.incr=this.parser.parse(l));break;case "exponentialif":p.exponentialif=parseFloat(l);break;case "text":p.rawText=l;for(var h=this.parseText(l),e=0,g=h.length;e<g;e++)h[e]=
this.parser.parse(h[e],!1);p.text=h;break;default:e=u.indexOf(".");h=f[u.substring(0,e)];e=f[u.substring(e+1)];if("parameter"===h&&"font"===e){p.parameterFont=l;break}else if("Explanation"===h&&"font"===e){p.ExplanationFont=l;break}else if("tooltip"===h&&"font"===e){p.tooltipFont=l;break}console.log("----- attributo de control no identificado: <"+u+"> valor: <"+l+"> -----")}if("numeric"===p.type)switch(p.gui){case "spinner":return new a.Spinner(this.parent,p);case "button":return new a.Button(this.parent,
p);case "textfield":return new a.TextField(this.parent,p);case "menu":return new a.Menu(this.parent,p);case "scrollbar":return new a.Scrollbar(this.parent,p);default:return new a.Spinner(this.parent,p)}else{if("video"===p.type)return new a.Video(this.parent,p);if("audio"===p.type)return new a.Audio(this.parent,p);if("graphic"===p.type)return new a.GraphicControl(this.parent,p);if("text"===p.type)return new a.TextArea(this.parent,p)}};a.LessonParser.prototype.parseGraphic=function(b,c,d,h){t={rotateExp:h,
parameter:"t"};b=this.split(b);h=0;for(var e=b.length;h<e;h++)if(u=b[h][0],l=b[h][1],q=f[u],""!=l)switch(q){case "type":case "align":t[q]=f[l];break;case "background":case "abs_coord":case "visible":case "editable":case "fixed":case "vectors":t[q]="true"===f[l];break;case "color":case "fill":case "fillP":case "fillM":case "arrow":case "trace":t[q]="false"===f[l]?"":new a.Color(l,this.parent.evaluator);break;case "family":case "parameter":case "info":case "font":case "name":case "init":case "end":t[q]=
l;break;case "drawif":case "width":case "decimals":case "size":case "spear":case "center":case "radius":case "opacity":case "inirot":case "inipos":case "range":""!=l&&(t[q]=this.parser.parse(l));break;case "space":t.spaceID=l;break;case "expresion":""!=l&&("macro"!=t.type?(t.expresion=this.parser.parse(l),t.expresionString=l):t.expresion=l);break;case "text":t.text=this.parseText(l);break;case "file":var g=l.replace(/&squot;/g,"'");"["===g.charAt(0)&&"]"===g.charAt(g.length-1)&&(g=g.substring(1,g.length-
1));g.match(A)&&(g="'"+g+"'");t.file=this.parser.parse(g);break;case "border":""!=l&&"false"!=f[l]&&(t.border=new a.Color(l,this.parent.evaluator));break;default:if(void 0!=t.family&&u.substring(0,t.family.length+1)===t.family+"."){switch(f[u.substring(t.family.length+1)]){case "interval":""!=l&&(t.family_interval=this.parser.parse(l));break;case "steps":""!=l&&(t.family_steps=this.parser.parse(l))}break}if(void 0!=t.parameter&&u.match(t.parameter+".")){t.parameter!==u.substring(0,u.indexOf(t.parameter)+
t.parameter.length)&&(t.parameter=u.substring(0,u.indexOf(t.parameter)+t.parameter.length));switch(f[u.substring(t.parameter.length+1)]){case "interval":""!=l&&(t.parameter_interval=this.parser.parse(l));break;case "steps":""!=l&&(t.parameter_steps=this.parser.parse(l))}break}console.log("----- attributo del graphic no identificado: <"+u+"> valor: <"+l+"> -----")}c&&(t.abs_coord=c);d&&(t.background=d);switch(t.type){case "text":return new a.Text(this.parent,t);case "image":return new a.Image(this.parent,
t);case "point":return new a.Point(this.parent,t);case "polygon":return new a.Polygon(this.parent,t);case "arc":return new a.Arc(this.parent,t);case "segment":return new a.Segment(this.parent,t);case "arrow":return new a.Arrow(this.parent,t);case "macro":return new a.Macro(this.parent,t);case "curve":return new a.Curve(this.parent,t);case "equation":return new a.Equation(this.parent,t);case "sequence":return new a.Sequence(this.parent,t);case "fill":return new a.Fill(this.parent,t);case "generic":return new a.Generic(this.parent,
t)}};a.LessonParser.prototype.parse3DGraphic=function(b,c,d,h){t={rotateExp:h,parameter:"t"};b=this.split(b);c=0;for(d=b.length;c<d;c++)switch(u=b[c][0],l=b[c][1],q=f[u],q){case "type":case "model":t[q]=f[l];break;case "background":case "fixed":case "edges":t[q]="true"===f[l];break;case "color":case "backcolor":t[q]=new a.Color(l,this.parent.evaluator);break;case "type":case "model":t[q]=f[l];break;case "background":case "fixed":case "edges":case "split":t[q]="true"===f[l];break;case "color":case "backcolor":t[q]=
new a.Color(l,this.parent.evaluator);break;case "drawif":case "width":case "length":case "height":case "decimals":case "Nu":case "Nv":case "inipos":case "endpos":""!=l&&(t[q]=this.parser.parse(l));break;case "family":case "parameter":case "font":case "name":case "inirot":case "endrot":t[q]=l;break;case "space":t.spaceID=l;break;case "expresion":"macro"!=t.type&&"curve"!=t.type&&"surface"!=t.type?(t.expresion=this.parser.parse(l),t.expresionString=l):t.expresion=l.replace(/\\n/g," ").replace(/;/g,
" ");break;case "text":h=this.parseText(l);for(var e=0,g=h.length;e<g;e++)h[e]=this.parser.parse(h[e],!1);t.text=h;break;case "file":h=l.replace(/&squot;/g,"'");"["===h.charAt(0)&&"]"===h.charAt(h.length-1)&&(h=h.substring(1,h.length-1));h.match(/./)&&(h="'"+h+"'");t.file=this.parser.parse(h);break;case "drawif":case "width":case "length":case "decimals":case "Nu":case "Nv":case "inirot":case "endrot":case "inipos":case "endpos":""!=l&&(t[q]=this.parser.parse(l));break;case "family":case "parameter":case "font":case "name":t[q]=
l;break;case "space":t.spaceID=l;break;case "expresion":"macro"!=t.type&&"curve"!=t.type&&"surface"!=t.type?(t.expresion=this.parser.parse(l),t.expresionString=l):t.expresion=l;break;case "text":h=this.parseText(l);e=0;for(g=h.length;e<g;e++)h[e]=this.parser.parse(h[e],!1);t.text=h;break;case "file":h=l.replace(/&squot;/g,"'");"["===h.charAt(0)&&"]"===h.charAt(h.length-1)&&(h=h.substring(1,h.length-1));h.match(/./)&&(h="'"+h+"'");t.file=this.parser.parse(h);break;default:if(void 0!==t.family&&u.substring(0,
t.family.length+1)===t.family+"."){"interval"===f[u.substring(t.family.length+1)]?""!=l&&(t.family_interval=this.parser.parse(l)):""!=l&&(t.family_steps=this.parser.parse(l));break}console.log("----- attributo del graphic3D no identificado: <"+u+"> valor: <"+l+"> -----")}switch(t.type){case "point":return new a.Point3D(this.parent,t);case "segment":return new a.Segment3D(this.parent,t);case "polygon":return new a.Polygon3D(this.parent,t);case "curve":return new a.Curve3D(this.parent,t);case "triangle":return new a.Triangle3D(this.parent,
t);case "face":return new a.Face3D(this.parent,t);case "polireg":return new a.Polireg3D(this.parent,t);case "surface":return new a.Surface3D(this.parent,t);case "text":return new a.Text3D(this.parent,t);case "cube":case "box":case "tetrahedron":case "octahedron":case "sphere":case "dodecahedron":case "icosahedron":case "ellipsoid":case "cone":case "cylinder":case "mesh":return new a.OtherGeometry(this.parent,t);case "macro":return new a.Macro3D(this.parent,t);default:console.log(t.type)}};a.LessonParser.prototype.parseAuxiliar=
function(b){w={};b=this.split(b);for(var c=0,d=b.length;c<d;c++)b[c][1]=b[c][1].replace(/&squot;/g,"'");c=0;for(d=b.length;c<d;c++)switch(u=b[c][0],l=b[c][1],q=f[u],q){case "id":case "file":case "init":case "doExpr":case "whileExpr":case "range":case "local":case "expresion":case "condition":case "parameter":w[q]=l.replace(/&squot;/g,"'");break;case "editable":case "constant":case "array":case "matrix":case "algorithm":case "event":case "sequence":w[q]="true"===f[l];break;case "size":case "rows":case "columns":w[q]=
this.parser.parse(l);break;case "evaluate":case "execution":case "msg_pos":case "action":w[q]=f[l];break;case "type":w[q]=f[l];break;case "x":case "y":case "width":case "height":w[q]=this.parser.parse(l);break;default:var h=u.indexOf("."),e=f[u.substring(0,h)],h=f[u.substring(h+1)];if("parameter"===e&&"font"===h){w.parameterFont=l;break}console.log("----- attributo de auxiliar no identificado: <"+u+"> valor: <"+l+"> -----")}w.sequence?new a.Function(this.parent,w):w.constant?(b=new a.Constant(this.parent,
w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.algorithm&&w.evaluate?(b=new a.Algorithm(this.parent,w),this.parent.auxiliaries.push(b)):w.array&&!w.matrix&&")"!=w.id.charAt(w.id.length-1)?(b=new a.Vector(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.matrix&&")"!=w.id.charAt(w.id.length-1)?(b=new a.Matrix(this.parent,w),w.evaluate&&"always"===w.evaluate&&this.parent.auxiliaries.push(b)):w.event&&")"!=w.id.charAt(w.id.length-1)?this.parent.events.push(new a.Event(this.parent,
w)):")"===w.id.charAt(w.id.length-1)?new a.Function(this.parent,w):new a.Variable(this.parent,w)};a.LessonParser.prototype.parseAction=function(b){C=b.action;z=b.parent;B=b.parameter;if(C)switch(C){case "message":return new a.Message(z,B);case "calculate":return new a.Calculate(z,B);case "openURL":return new a.OpenURL(z,B);case "openScene":return new a.OpenScene(z,B);case "about":return new a.About(z,B);case "config":return new a.Config(z,B);case "init":return new a.Init(z,B);case "clear":return new a.Clear(z,
B);case "animate":return new a.Animate(z,B);case "initAnimation":return new a.InitAnimation(z,B);case "playAudio":return new a.PlayAudio(z,B);default:console.log("----- Accion no soportada aun: <"+C+"> -----")}else return{execute:function(){}}};a.LessonParser.prototype.parseAnimation=function(b){var c={};b=this.split(b);for(var d=0,h=b.length;d<h;d++)switch(u=b[d][0],l=b[d][1],q=f[u],q){case "id":case "delay":case "init":case "doExpr":case "whileExpr":c[q]=l.replace(/&squot;/g,"'");break;case "controls":case "auto":case "loop":case "algorithm":case "evaluate":c[q]=
"true"===f[l];break;default:console.log("----- attributo de la animacion no identificado: <"+u+">  <"+l+"> -----")}return new a.Animation(this.parent,c)};a.LessonParser.prototype.parsePleca=function(f,p){f=this.split(f);c=g="";e=0;b="#536891";m="white";h="left";d="";n="SansSerif,BOLD,20";r="SansSerif,PLAIN,18";k=void 0;for(var q=0,s=f.length;q<s;q++)switch(u=f[q][0],l=f[q][1],u){case "title":g=l;break;case "subtitle":c=l;break;case "subtitlines":e=l;break;case "bgcolor":""!=l&&(b=(new a.Color(l,this.parent.evaluator)).getColor());
break;case "fgcolor":""!=l&&(m=(new a.Color(l,this.parent.evaluator)).getColor());break;case "align":""!=l&&(h=l);break;case "titleimage":d=l;break;case "titlefont":n=""!=l?a.convertFont(l):a.convertFont(n);break;case "subtitlefont":r=""!=l?a.convertFont(l):a.convertFont(r);break;default:console.log("----- attributo de la pleca no identificado: <"+u+">  <"+l+"> -----")}if(""===g&&""===c)return document.createElement("div");J=r.substring(0,r.indexOf("px"));J=J.substring(J.lastIndexOf(" "));""!=d&&
(x=this.parent.getImage(d),K=x.height);k=document.createElement("div");k.setAttribute("id","descartesPleca");K?(k.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+h+"; width: "+(p-30)+"px; height: "+(K-16)+"px; background: "+b+"; color: "+m+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; overflow: hidden; z-index: 100;"),x.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: -1; width: 100%; height: 100%"),
k.appendChild(x)):k.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+h+"; width: "+(p-30)+"px; background: "+b+"; color: "+m+"; padding-top: 12px; padding-bottom: 12px; padding-left: 15px; padding-right: 15px; margin: 0px; z-index: 100;");F=document.createElement("div");F.setAttribute("style","padding: 0px; margin: 0px; font: "+n+"; overflow: hidden; white-space: nowrap;");F.innerHTML=g;L=document.createElement("div");if(1===parseInt(e)){P=0;M=document.createElement("div");
M.innerHTML=c;document.body.appendChild(M);R=J;do R-=P,M.setAttribute("style","padding: 0px; margin: 0px; font: "+r+"; font-size: "+R+"px; width: "+(p-30)+"px; line-height: "+R+"px;"),N=M.offsetHeight,S=N/R,P=1;while(1<S&&8<R);document.body.removeChild(M);L.setAttribute("style","padding: 0px; margin: 0px; font: "+r+"; font-size: "+R+"px; line-height: 110%; overflow: hidden; white-space: nowrap;")}else L.setAttribute("style","padding: 0px; margin: 0px; font: "+r+"; line-height: 110%;");L.innerHTML=
c;k.appendChild(F);k.appendChild(L);k.imageHeight=K;return k};a.LessonParser.prototype.split=function(a){if("string"!=typeof a)return[];a=(a||"").replace(/\\'/g,"\u2019");E=[];y=D=0;I=!1;G=0;for(H=!1;D<a.length;)" "!==a.charAt(D)||I||D++," "===a.charAt(D)||I||(I=!0,G=D),"="!==a.charAt(D)||"'"!==a.charAt(D+1)||H||(H=!0,E[y]=[a.substring(G,D)],G=D+2,D+=2),H&&"'"===a.charAt(D)&&(I=H=!1,E[y].push(a.substring(G,D)),y++),"="!==a.charAt(D)||"'"===a.charAt(D+1)||H||(E[y]=[a.substring(G,D)],G=D+1,D++,Q=a.substring(D).indexOf("="),
-1===Q?O=Q=a.length:(Q+=D,O=a.substring(D,Q).lastIndexOf(" "),O=-1===O?a.length:O+D),E[y].push(a.substring(G,O)),y++,I=!1,D=O),D++;return E};a.LessonParser.prototype.parseText=function(b){b=b||"";return b.match(/^\{\\rtf1/)?this.RTFparser.parse(b.substring(10)):new a.SimpleText(this.parent,b)};return a}(descartesJS||{},babel),descartesJS=function(a){function f(a,b){u=[];u.type="matrix";u.rows=a;u.cols=b;var c;v=0;for(p=b;v<p;v++){c=[];l=0;for(t=a;l<t;l++)c.push(0);u[v]=c}return u}function g(a,b){s=
a.rows;q=a.cols;u=f(s,q);var c;for(v=0;v<s;v++)for(l=0;l<q;l++){for(p=c=0;p<q;p++)c+=a[p][v]*b[l][p];u[l][v]=c}return u}function c(a,b,c){for(var d=f(c.length-1,c.length-1),h=0,e=d.length;h<e;h++)for(var g=0;g<e;g++)d[h][g]=h<a?g<b?c[h][g]:c[h][g+1]:h<b?c[h+1][g]:c[h+1][g+1];return d}function e(a){if(1<a.cols){for(var b=0,d=1,h=0,f=a.cols;h<f;h++)b+=d*a[0][h]*e(c(0,h,a)),d=-d;return b}return a[0][0]}if(a.loadLib)return a;var b,m={},h=Math.floor,d,n,r,k;a.fullDecimals=!1;a.Node=function(a,b){this.sep=
"";this.type=a;this.value=b;this.parent=null;this.childs=[]};a.Node.prototype.getRoot=function(){return null===this.parent?this:this.parent.getRoot()};a.Node.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.Node.prototype.replaceLastChild=function(a){d=this.childs.length-1;lastChild=this.childs[d];lastChild.parent=null;this.childs[d]=a;a.parent=this;return a};a.Node.prototype.contains=function(a){if(this.value===a)return!0;for(var b=0,c=this.childs.length;b<c;b++)if(this.childs[b].contains(a))return!0;
return!1};a.Node.prototype.equalToMinus=function(){return"compOperator"===this.type?(this.type="operator",this.value="-",r=new a.Node("compOperator","=="),k=new a.Node("number","0"),r.addChild(this),r.addChild(k),n=this.getRoot(),n.setAllEvaluateFunction(),n):this};a.Node.prototype.setAllEvaluateFunction=function(){this.setEvaluateFunction();for(var a=0,b=this.childs.length;a<b;a++)this.childs[a].setAllEvaluateFunction()};a.Node.prototype.setEvaluateFunction=function(){if("number"===this.type)this.evaluate=
function(a){return parseFloat(this.value)};else if("string"===this.type)this.evaluate=function(a){return this.value};else if("identifier"===this.type&&0===this.childs.length)if("rnd"==this.value)this.evaluate=function(a){return Math.random()};else{var a;this.evaluate=function(b,c){a=b.variables[this.value];if("object"===typeof a&&void 0==a.length)return a.evaluate(b);void 0==a&&(c||b.matrices[this.value]?a=b.matrices[this.value]:b.vectors[this.value]&&(a=b.vectors[this.value]));return void 0!==a?
a:0}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1===this.childs[0].childs.length){var d,k;this.evaluate=function(a){d=this.childs[0].childs[0].evaluate(a);try{return k=a.vectors[this.value][0>d?0:h(d)],void 0!==k?k:0}catch(b){return 0}}}else if("identifier"===this.type&&"square_bracket"===this.childs[0].type&&1<this.childs[0].childs.length){var n,r;this.evaluate=function(a){n=this.childs[0].childs[0].evaluate(a);r=this.childs[0].childs[1].evaluate(a);try{return k=a.matrices[this.value][0>
n?0:h(n)][0>r?0:h(r)],void 0!==k?k:0}catch(b){return 0}}}else if("identifier"===this.type&&"parentheses"===this.childs[0].type){var p,t;this.evaluate=function(a){p=[];for(var c=0,d=this.childs[0].childs.length;c<d;c++)p[c]=this.childs[0].childs[c].evaluate(a);if("_Eval_"===this.value){b=0<p.length?p[0]:0;if("number"==typeof b)return"NaN";void 0==m[b]&&(t=b.match(/:=/g)?!0:!1,m[b]=a.parser.parse(b,t));return a.evalExpression(m[b])||0}return a.functions[this.value].apply(a,p)}}else if("operator"===
this.type)"+"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b+a;s=b.rows;q=b.cols;u=f(s,q);for(v=0;v<s;v++)for(l=0;l<q;l++)u[l][v]=b[l][v]+a[l][v];return u}:"-"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b-a;s=b.rows;q=b.cols;u=f(s,q);for(v=0;v<s;v++)for(l=0;l<q;l++)u[l][v]=b[l][v]-
a[l][v];return u}:"*"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);return"matrix"!==b.type||"matrix"!==a.type?b*a:g(b,a)}:"/"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a,!0);a=this.childs[1].evaluate(a,!0);if("matrix"!==b.type||"matrix"!==a.type)return b/a;var d=f(a.length,a.length),h=e(a);if(0===h)a=0;else{var h=1/h,l;if(1<a.length)for(var k=0,m=a.length;k<m;k++){l=h;for(var n=0;n<m;n++)d[n][k]=l*e(c(k,n,a)),
l=-l;h=-h}else d[0][0]=h;a=d}b=0===a?f(b.rows,b.cols):g(b,a);return b}:"%"===this.value?this.evaluate=function(a){var b=this.childs[0].evaluate(a);a=this.childs[1].evaluate(a);return b-h(b/a)*a}:"^"===this.value&&(this.evaluate=function(a){return Math.pow(this.childs[0].evaluate(a),this.childs[1].evaluate(a))});else if("compOperator"===this.type)"<"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<this.childs[1].evaluate(a))+0}:"<="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)<=
this.childs[1].evaluate(a))+0}:">"===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>this.childs[1].evaluate(a))+0}:">="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)>=this.childs[1].evaluate(a))+0}:"=="===this.value?this.evaluate=function(a){return(this.childs[0].evaluate(a)===this.childs[1].evaluate(a))+0}:"!="===this.value&&(this.evaluate=function(a){return(this.childs[0].evaluate(a)!=this.childs[1].evaluate(a))+0});else if("boolOperator"===this.type)"&"===
this.value?this.evaluate=function(a){return this.childs[0].evaluate(a)?this.childs[1].evaluate(a)?1:0:0}:"|"===this.value?this.evaluate=function(a){return this.childs[0].evaluate(a)?1:this.childs[1].evaluate(a)?1:0}:"!"===this.value&&(this.evaluate=function(a){return!this.childs[0].evaluate(a)+0});else if("conditional"===this.type)this.evaluate=function(a){return 0<this.childs[0].evaluate(a)?this.childs[1].evaluate(a):this.childs[2].evaluate(a)};else if("sign"===this.type)this.evaluate="sign+"===
this.value?function(a){return this.childs[0].evaluate(a)}:function(a){return-this.childs[0].evaluate(a)};else if("parentheses"===this.type)this.evaluate=function(a,b){return this.childs[0].evaluate(a,b)};else if("(expr)"===this.type||"[expr]"===this.type)this.evaluate=function(a){var b=this.childs.length,c=[],d;if(1===b&&1===this.childs[0].childs.length&&"(expr)"===this.type)c=this.childs[0].childs[0].evaluate(a);else for(var h=0;h<b;h++){d=[];for(var e=0,f=this.childs[h].childs.length;e<f;e++)d.push(this.childs[h].childs[e].evaluate(a));
c[h]=d}return c};else if("asign"===this.type){var y,I,G,H,J,x;this.evaluate=function(a){y=this.childs[0];I=this.childs[1];1===y.childs.length&&"square_bracket"===y.childs[0].type?(d=y.childs[0].childs,1===d.length?(G=d[0].evaluate(a),G=0>G?0:h(G),a.vectors[y.value][G]=I.evaluate(a)):2===d.length&&(H=d[0].evaluate(a),J=d[1].evaluate(a),H=0>H?0:h(H),J=0>J?0:h(J),a.matrices[y.value][H]||(a.matrices[y.value][H]=[]),a.matrices[y.value][H][J]=I.evaluate(a))):(x=I.evaluate(a),x.type?a.matrices[y.value]=
x:"object"!==typeof a.variables[y.value]&&(a.variables[y.value]=x))}}};var s,q,u,l,v,p,t;a.Node.prototype.toString=function(){var a="tipo: "+this.type+", valor: "+this.value+"\n";this.sep="   "+(this.parent?this.parent.sep:"");for(var b=0,c=this.childs.length;b<c;b++)a+=this.sep+this.childs[b].toString();return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r=/^\s+/,k=/^[a-zA-Z_\u00C0-\u021B\u0391-\u03C9]+[a-zA-Z_0-9\u00C0-\u021B\u0391-\u03C9]*([.]*[0-9a-zA-Z_\u00C0-\u021B\u0391-\u03C9]+[0-9]*)*/,
s=/^[0-9]+[.][0-9]+|^[.][0-9]+|^[0-9]+/,q=/^==|^!=|^<=|^<|^>=|^>|^#/,u=/^\!|^\~|^\&\&|^\&|^\|\||^\|/,l=/^=|^:=/,v=/^[\?\:]/,p=/^[\+\-\*\/\%\^\u2212\u00b7\u00D7\u00F7]/,t=/^\[|^\]/,w=/^\(|^\)/,A=/^,/,C=/^;/,z=/\|/g,B=/\|\*/g,E=/\*\|/g;a.Tokenizer=function(){};a.Tokenizer.prototype.tokenize=function(a){function G(a,b,c){g.push({type:a,value:b});m=m.slice(c);e+=c;d++;n=a}if(f=a){a=a.replace(/\\u(\S+) /g,function(a,b){return String.fromCharCode(parseInt(b,16))});a=a.replace(/\&sup(.+);/g,"^ $1 ");a=a.replace(/&squot;/g,
"'");a.match(/\=\|\*/g)&&(a=a.replace(B,"'").replace(E,"'"));a.match(/\=\|/g)&&(a=a.replace(z,"'"));var H=a.trim();"|"==H.charAt(0)&&"|"==H.charAt(H.length-1)&&(a=H.replace(z,"'"))}g=[];c=!1;e=0;m=a;d=0;for(n="";a&&e<a.length;)if(c=e,"'"==m[0]){for(h=1;"'"!=m[h];)if(h<m.length)h++;else{console.log(">Error, unknown symbol: ["+m+"], in the string <<"+f+">>");return}b=m.substring(1,h);G("string",b,b.length+2)}else if(b=m.match(r))m=m.slice(b[0].length),e+=b[0].length,d++;else if(b=m.match(p))b[0]=b[0].replace(/\u00F7/g,
"/").replace(/\u2212/g,"-").replace(/\u00b7/g,"*").replace(/\u00D7/g,"*"),G("operator",b[0],b[0].length);else if(b=m.match(k))"number"===n&&g.push({type:"operator",value:"*"}),G("identifier",b[0],b[0].length);else if(b=m.match(s))G("number",b[0],b[0].length);else if(b=m.match(q))H=b[0],"#"==H&&(H="!="),G("compOperator",H,b[0].length);else if(b=m.match(u))H=b[0],"||"==H?H="|":"&&"==H?H="&":"~"==H&&(H="!"),G("boolOperator",H,b[0].length);else if((b=m.match(l))&&!m.match(/^==/))G("asign",b[0],b[0].length);
else if(b=m.match(v))G("conditional",b[0],b[0].length);else if(b=m.match(t))G("square_bracket",b[0],b[0].length);else if(b=m.match(w))"("==b&&"number"===n&&g.push({type:"operator",value:"*"}),G("parentheses",b[0],b[0].length);else if(b=m.match(A))G("separator",b[0],b[0].length);else if(178===m.charCodeAt(0))g.push({type:"operator",value:"^"}),G("number",2,1);else if(179===m.charCodeAt(0))g.push({type:"operator",value:"^"}),G("number",3,1);else if(b=m.match(C))G("final_of_expresion",b[0],b[0].length);
else if(c==e){console.log("Error, simbolo no conocido: ["+m+"], en la cadena <<"+f+">>");return}return g};var D,y=/rnd|pi|e|Infinity|-Infinity|sqr|sqrt|ra\u00edz|exp|log|log10|abs|ent|sgn|ind|sin|sen|cos|tan|cot|sec|csc|sinh|senh|cosh|tanh|coth|sech|csch|asin|asen|acos|atan|min|max/;a.Tokenizer.prototype.flatTokens=function(a,b){a=a||[];b=b||"";D="";for(var c=0,d=a.length;c<d;c++)D="string"==a[c].type?D+"&squot;"+a[c].value+"&squot;":"identifier"!=a[c].type||a[c].value.match(y)?D+a[c].value:D+b+a[c].value;
return D};return a}(descartesJS||{}),descartesJS=function(a){function f(a){return isNaN(parseFloat(a))?a.replace(/^\s|\s$/g,"").replace(/^'|'$/g,""):parseFloat(a)}if(a.loadLib)return a;a.Parser=function(b){this.evaluator=b;this.tokenizer=new a.Tokenizer;this.vectors={};this.matrices={};this.variables={};this.functions={};this.definitions={};this.registerDefaultValues()};a.Parser.prototype.setDefinition=function(a,b){this.definitions[a]=b};a.Parser.prototype.getDefinition=function(a){return this.definitions[a]};
a.Parser.prototype.setVariable=function(a,b){this.variables[a]=b};a.Parser.prototype.getVariable=function(a,b){b&&(this.variables[a]=void 0!==this.variables[a]?this.variables[a]:void 0);return this.variables[a]};a.Parser.prototype.setVector=function(a,b,c){this.vectors[a][b]=c};a.Parser.prototype.getVector=function(a){this.vectors.hasOwnProperty(a)||(this.vectors[a]=[0,0,0]);return this.vectors[a]};a.Parser.prototype.setMatrix=function(a,b,c,d){this.matrices[a][b][c]=d};a.Parser.prototype.getMatrix=
function(a){this.matrices.hasOwnProperty(a)||(this.matrices[a]=[[0,0,0],[0,0,0],[0,0,0]]);return this.matrices[a]};a.Parser.prototype.setFunction=function(a,b){this.functions[a]=b};a.Parser.prototype.getFunction=function(a){this.functions.hasOwnProperty(a)||(this.functions[a]=function(){return 0});return this.functions[a]};var g,c,e,b,m,h,d,n,r,k,s,q;a.Parser.prototype.parse=function(f,l){(e=this.tokenizer.tokenize(f))||(e=[]);b=null;l=!l||!1;g=n=d=h=0;for(c=e.length;g<c;g++){r=e[g];k=r.value;s=r.type;
if("identifier"===s)if(g+1<c&&"parentheses"===e[g+1].type&&"("===e[g+1].value)this.getFunction(k);else if(g+1<c&&"square_bracket"===e[g+1].type&&"["===e[g+1].value)e[g+3]&&"square_bracket"===e[g+3].type&&"]"===e[g+3].value?this.getVector(k):this.getMatrix(k);else{var v=k.match(/(\w*)\.mouse_x/)||k.match(/(\w*)\.mouse_y/)||k.match(/(\w*)\.mouse_pressed/)||k.match(/(\w*)\.mouse_clicked/)||k.match(/(\w*)\.clic_izquierdo/);v&&(this.variables[v[1]+".DESCARTESJS_no_fixed"]=1);this.getVariable(k,!0)}"asign"===
s&&l&&(s="compOperator",k="==");if("asign"===s)if(m=new a.Node(s,k),null!=b)if("identifier"===b.type)b.parent&&b.parent.replaceLastChild(m),m.addChild(b),b=m,l=!0;else if("square_bracket"===b.type)m.addChild(b.parent),b=m,l=!0;else{m.type="compOperator";m.value="==";for(l=!0;b.parent&&this.getPrecedence(b.parent.value)>=this.getPrecedence(m.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(m);m.addChild(b);b=m}else{console.log("Error1: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+
s+"}");break}else if("parentheses"===s&&"("===k||"square_bracket"===s&&"["===k)if(m=new a.Node(s,k),"("===k&&h++,"["===k&&d++,null===b)"("===k&&(new a.Node("(expr)","(expr)")).addChild(m),"["===k&&(new a.Node("[expr]","[expr]")).addChild(m),b=m;else if("operator"===b.type||"boolOperator"===b.type||"compOperator"===b.type||"conditional"===b.type||"asign"===b.type)b.addChild(m),b=m;else if("sign"===b.type)b.addChild(m),b=m;else if("parentheses"===b.type&&"("===b.value)b.addChild(m),b=m;else if("square_bracket"===
b.type&&"["===b.value)b.addChild(m),b=m;else if("parentheses"===b.type&&"()"===b.value)b.parent.addChild(m),b=m;else if("square_bracket"===b.type&&"[]"===b.value)b.parent.addChild(m),b=m;else if("identifier"===b.type)b.addChild(m),b=m;else{console.log("Error2: en la expresion <<"+f+">>, en el token ["+g+"] {valor: "+k+", tipo: "+s+"}");break}else if("parentheses"===s&&")"===k)if(h--,null===b)console.log("Error3: en la expresion <<"+f+">>, en el token (valor:"+k+", tipo:"+s);else{for(;b&&b.parent&&
("("!=b.value||"("==b.value&&"parentheses"!=b.type);)b=b.parent;if(b&&"("===b.value)b.value="()";else{console.log("Error4: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}}else if("square_bracket"===s&&"]"===k)if(d--,null===b)console.log("Error5: en la expresion <<"+f+">>, en el token (valor:"+k+", tipo:"+s);else{for(;b&&b.parent&&("["!=b.value||"["==b.value&&"square_bracket"!=b.type);)b=b.parent;if(b&&"["===b.value)b.value="[]";else{console.log("Error6: en la expresion <<"+
f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}}else if("number"===s||"string"===s||"identifier"===s)if(m=new a.Node(s,k),null===b)b=m;else if("operator"===b.type||"compOperator"===b.type||"boolOperator"===b.type||"parentheses"===b.type&&"("===b.value||"square_bracket"===b.type&&"["===b.value||"sign"===b.type||"conditional"===b.type||"asign"===b.type)b.addChild(m),b=m;else{console.log("Error7: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}else if("operator"===
s||"compOperator"===s||"boolOperator"===s)if(m=new a.Node(s,k),null===b)if("-"===k||"+"===k)m.type="sign",m.value="sign"+k,b=m;else if("!"===k)b=m;else{console.log("Error8: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}else if("operator"===b.type||"compOperator"===b.type||"boolOperator"===b.type||"asign"===b.type||"conditional"===b.type||"square_bracket"===b.type&&"["===b.value&&("-"===k||"+"===k||"!"===k)||"parentheses"===b.type&&"("===b.value&&("-"===k||"+"===k||"!"===
k)){if("-"===k||"+"===k)m.type="sign",m.value="sign"+k;b.addChild(m);b=m}else if("number"===b.type||"parentheses"===b.type&&"()"===b.value||"square_bracket"===b.type&&"[]"===b.value||"string"===b.type||"identifier"===b.type||"conditional"===b.type||"asign"===b.type){for(;b.parent&&this.getPrecedence(b.parent.value)>=this.getPrecedence(m.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(m);m.addChild(b);b=m}else{console.log("Error9: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+
s+"}");break}else if("conditional"===s)if(m=new a.Node(s,k),null!=b)if("?"===m.value){for(n++;b.parent&&this.getPrecedence(b.parent.value)>this.getPrecedence(m.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(m);m.addChild(b);b=m}else{for(n--;b&&b.parent&&("?"!=b.value||"?"==b.value&&"conditional"!=b.type);)b=b.parent;if(b&&"?"===b.value)b.value="?:";else{console.log("Error10: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}}else{console.log("Error11: en la expresion <<"+
f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}else if("separator"===s)if(null!=b)for(;b.parent&&"("!=b.value&&"["!=b.value;)b=b.parent;else{console.log("Error12: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}else{console.log("Error13: en la expresion <<"+f+">>, en el token {valor: "+k+", tipo: "+s+"}");break}}0<h&&alert("Error, faltan parentesis por cerrar: "+f);0>h&&alert("Error, faltan parentesis por abrir: "+f);0<d&&alert("Error, faltan square bracketss por cerrar: "+
f);0>d&&alert("Error, faltan square bracketss por abrir: "+f);0!=n&&alert("Error, condicional incompleta: "+f);(q=b?b.getRoot():null)&&q.setAllEvaluateFunction();return q};a.Parser.prototype.getPrecedence=function(a){switch(a){case "=":return 1;case ":=":return 1;case "(":return 2;case "[":return 2;case "?":return 2;case ":":return 3;case "?:":return 3;case "|":return 6;case "&":return 7;case "<":return 5;case "<=":return 5;case ">":return 5;case ">=":return 5;case "==":return 5;case "!=":return 5;
case "+":return 6;case "-":return 6;case "/":return 7;case "*":return 7;case "sign-":return 7;case "sign+":return 7;case "!":return 8;case "%":return 8;case "^":return 9;default:return 9}};a.Parser.prototype.registerDefaultValues=function(){function b(a,c){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}var c=this;c.variables.rnd=Math.random;c.variables.pi=c.variables["\u03c0"]=a.returnValue(Math.PI);c.variables.e=a.returnValue(Math.E);c.variables.Infinity=Infinity;c.variables["-Infinity"]=-Infinity;
c.variables.isTouch=c.variables["esT\u00e1ctil"]=a.hasTouchSupport?1:0;c.functions.sqr=function(a){return a*a};c.functions.sqrt=c.functions["ra\u00edz"]=Math.sqrt;c.functions.exp=Math.exp;c.functions.log=Math.log;c.functions.log10=function(a){return Math.log(a)/Math.log(10)};c.functions.abs=Math.abs;c.functions.ent=Math.floor;c.functions.sgn=function(a){return 0<a?1:0>a?-1:0};c.functions.ind=function(a){return a?1:0};c.functions.sin=c.functions.sen=Math.sin;c.functions.cos=Math.cos;c.functions.tan=
Math.tan;c.functions.cot=function(a){return 1/Math.tan(a)};c.functions.sec=function(a){return 1/Math.cos(a)};c.functions.csc=function(a){return 1/Math.sin(a)};c.functions.sinh=c.functions.senh=function(a){return(Math.exp(a)-Math.exp(-a))/2};c.functions.cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2};c.functions.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))};c.functions.coth=function(a){return 1/c.functions.tanh(a)};c.functions.sech=function(a){return 1/c.functions.cosh(a)};
c.functions.csch=function(a){return 1/c.functions.sinh(a)};c.functions.asin=c.functions.asen=Math.asin;c.functions.acos=Math.acos;c.functions.atan=Math.atan;c.functions.min=Math.min;c.functions.max=Math.max;c.functions._Num_=function(a){return"number"==typeof a?"NaN":parseFloat(a)==a?parseFloat(a):"NaN"};c.functions._Trace_=c.functions._Print_=function(){console.log.apply(console,arguments);return 0};c.functions._Stop_Audios_=function(){c.evaluator.parent.stopAudios()};c.functions.esCorrecto=function(b,
d,h){return a.esCorrecto(b,d,c.evaluator,h)};c.functions.escorrecto=function(b,d,h){return a.escorrecto(b,d,c.evaluator,h)};window.parent!==window&&(c.functions["parent.set"]=function(a,b){window.parent.postMessage({type:"set",name:a,value:b},"*");return 0},c.functions["parent.update"]=function(){window.parent.postMessage({type:"update"},"*");return 0},c.functions["parent.exec"]=function(a,b){window.parent.postMessage({type:"exec",name:a,value:b},"*");return 0});c.functions._NumToStr_=c.functions._NumACadena_=
function(a,b){return parseFloat(a).toFixed(parseInt(b))};c.functions._charAt_=c.functions._letraEn_=function(a,b){a=(a||"").toString();b=isNaN(parseInt(b))?0:parseInt(b);return a.charAt(b)};c.functions._substring_=c.functions._subcadena_=function(a,b,c){a=(a||"").toString();b=isNaN(parseInt(b))?0:parseInt(b);c=isNaN(parseInt(c))?0:parseInt(c);return 0<=b&&0<=c?a.substring(b,c):0>b&&0<=c?a.substring(c):0>c&&0<=b?a.substring(b):""};c.functions._length_=c.functions._longitud_=function(a){a=(a||"").toString();
return a.length};c.functions._indexOf_=c.functions["_\u00edndiceDe_"]=function(a,b){a=(a||"").toString();b=(b||"").toString();return a.indexOf(b)};this.functions._Load_=function(b){var c="";b&&(c=(c=document.getElementById(b))&&"descartes/archivo"==c.type?c.text:a.openExternalFile(b));return c||""};this.functions._GetValues_=function(a,b){var c=this.functions._Load_(a).replace(/&brvbar;/g,String.fromCharCode("166"));return this.functions._ExecBlock_(c,b)};this.functions._GetMatrix_=function(a,b){var c=
this.functions._Load_(a).replace(/&brvbar;/g,String.fromCharCode("166"));return this.functions._StrToMatrix_(c,b)};this.functions._MatrixToStr_=function(a){var b=this.matrices[a];if(b){for(var c="<"+a+">\\n",d=this.getVariable(a+".columnas_usadas")||b.rows||0,h=this.getVariable(a+".filas_usadas")||b.cols||0,e,f=0;f<d;f++){for(var g=0;g<h;g++)e=b[f][g],void 0!==e&&("string"==typeof e&&(e="'"+e+"'"),c+=e+(g<h-1?" \u00a6 ":""));c=c.replace(/(\u00A6 )$/g,"")+"\\n"}return c+("</"+a+">")}return""};this.functions._StrToMatrix_=
function(a,b){var d=[],h=!1;d.type="matrix";if(a){a=a.replace(/\r/g,"").split("\n");for(var e=0,g=a.length;e<g;e++)a[e].match("<"+b+">")?(h=a[e].trim().split("<"+b+">"),2==h.length&&""!=h[1]&&d.push(h[1].split(String.fromCharCode("166")).map(f)),h=!0):a[e].match("</"+b+">")?(h=a[e].trim().split("</"+b+">"),2==h.length&&""!=h[0]&&d.push(h[0].split(String.fromCharCode("166")).map(f)),h=!1):h&&d.push(a[e].split(String.fromCharCode("166")).map(f));c.matrices[b]=d;c.setVariable(b+".filas",d[0].length);
c.setVariable(b+".columnas",d.length)}return"OK"};this.functions._GetVector_=function(a,b){var c=this.functions._Load_(a);return this.functions._StrToVector_(c,b)};this.functions._VectorToStr_=function(a){var b=this.vectors[a];if(b){for(var c="<"+a+">\\n",d=this.getVariable(a+".long_usada")||b._size_||0,h,e=0;e<d;e++)h=b[e],void 0!==h?("number"==typeof h&&(h=parseFloat(h)),c+=h+"\\n"):c+="0\\n";return c+("</"+a+">")}return""};this.functions._StrToVector_=function(a,b){var d=[],h=!1;d.type="vector";
if(a){a=a.replace(/\r/g,"").split("\n");for(var e=0,g=a.length;e<g;e++)a[e].match("<"+b+">")?h=!0:a[e].match("</"+b+">")?h=!1:h&&d.push(f(a[e]));d._size_=d.length;c.vectors[b]=d;c.setVariable(b+".long",d.length);c.setVariable(b+".long_usada",d.length)}return"OK"};this.functions._ExecStr_=function(a){return this.functions._ExecBlock_(a,"")};this.functions._ExecBlock_=function(a,b){var d=[],h=""==b;if(a){a=a.replace(/\r/g,"").split("\n");for(var e=0,f=a.length;e<f;e++)a[e].match("<"+b+">")?(h=a[e].trim().split("<"+
b+">"),2==h.length&&""!=h[1]&&(d=d.concat(h[1].split(String.fromCharCode("166")))),h=!0):a[e].match("</"+b+">")?(h=a[e].trim().split("</"+b+">"),2==h.length&&""!=h[0]&&(d=d.concat(h[0].split(String.fromCharCode("166")))),h=!1):h&&(d=d.concat(a[e].split(String.fromCharCode("166"))));e=0;for(f=d.length;e<f;e++)h=d[e].split("="),h[0]=h[0].trim(),2==h.length&&""!=h[0]&&(isNaN(parseFloat(h[1]))?c.setVariable(h[0],h[1].replace(/^\s|\s$/g,"").replace(/^'|'$/g,"")):c.setVariable(h[0],parseFloat(h[1])))}return 0};
var d=document.createElement("a");d.setAttribute("target","_blank");var h,e=null;this.functions._Save_=function(a,b){document.body.appendChild(d);h=new Blob(["\ufeff",b.replace(/\\n/g,"\n").replace(/\\q/g,"'").replace(/\\r/g,"")],{type:"text/plain"});d.setAttribute("download",a);d.setAttribute("href",window.URL.createObjectURL(h));null==e&&(d.click(),e=!0,setTimeout(function(){e=null},1E3));document.body.removeChild(d);return 0};var g,k,m,n,r=document.createElement("input");r.setAttribute("type",
"file");onHandleFileSelect=function(b){g=b.target.files;k=new FileReader;k.onload=function(b){a.addExternalFileContent(g[0].name,b.target.result);c.setVariable(m,g[0].name);c.getFunction(n)&&(c.getFunction(n).apply(c.evaluator,[]),c.evaluator.parent.update())};0<g.length&&k.readAsText(g[0])};r.addEventListener("change",onHandleFileSelect);this.functions._Open_=function(a,b){m=a;n=b;r.click();return 0};var q,s,y=document.createElement("input");y.setAttribute("type","file");onHandleFileSelect2=function(a){a.stopPropagation();
a.preventDefault();q=a.target.files;s=new FileReader;s.onload=function(a){var d={};try{d=JSON.parse(a.target.result)}catch(h){}d.variables&&b(c.variables,d.variables);d.vectors&&b(c.vectors,d.vectors);d.matrices&&b(c.matrices,d.matrices);c.evaluator.parent.update()};0<q.length&&s.readAsText(q[0])};y.removeEventListener("change",onHandleFileSelect2);y.addEventListener("change",onHandleFileSelect2);this.functions._GetDay_=function(){return(new Date).getDate()};this.functions._GetMonth_=function(){return(new Date).getMonth()+
1};this.functions._GetYear_=function(){return(new Date).getFullYear()};this.functions._GetHours_=function(){return(new Date).getHours()};this.functions._GetMinutes_=function(){return(new Date).getMinutes()};this.functions._GetSeconds_=function(){return(new Date).getSeconds()};this.functions._AnchoDeCadena_=this.functions._strWidth_=function(b,c,d,h){return a.getTextWidth(b,a.convertFont(c+","+d+","+h))};this.functions._Rojo_=this.functions._Red_=function(b){return(new a.Color(b)).r/255};this.functions._Verde_=
this.functions._Green_=function(b){return(new a.Color(b)).g/255};this.functions._Azul_=this.functions._Blue_=function(b){return(new a.Color(b)).b/255}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=Math.floor;a.Evaluator=function(f){this.parent=f;this.parser=new a.Parser(this);this.variables=this.parser.variables;this.functions=this.parser.functions;this.vectors=this.parser.vectors;this.matrices=this.parser.matrices;this.definitions=this.parser.definitions};a.Evaluator.prototype.setDefinition=
function(a,c){this.definitions[a]=c};a.Evaluator.prototype.getDefinition=function(a){return this.definitions[a]};a.Evaluator.prototype.setVariable=function(a,c){this.variables[a]=c};a.Evaluator.prototype.getVariable=function(a){return this.variables[a]};a.Evaluator.prototype.setVector=function(a,c,e){c=0>c?0:f(c);this.vectors[a][c]=e};a.Evaluator.prototype.getVector=function(a,c){c=0>c?0:f(c);return this.vectors[a][c]};a.Evaluator.prototype.setMatrix=function(a,c,e,b){c=0>c?0:f(c);e=0>e?0:f(e);this.matrices[a][c][e]=
b};a.Evaluator.prototype.getMatrix=function(a,c,e){c=0>c?0:f(c);e=0>e?0:f(e);return this.matrices[a][c][e]};a.Evaluator.prototype.setFunction=function(a,c){this.functions[a]=c};a.Evaluator.prototype.getFunction=function(a){return this.functions[a]};a.Evaluator.prototype.evalExpression=function(a){return a?a.evaluate(this):0};a.externalEvaluator=new a.Evaluator;return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=2,g=!1,c;a.RTFNode=function(a,b,c,e){this.evaluator=a;this.type=
"rtfNode";this.value=b;this.nodeType=c;this.style=e;this.styleString=e.toString();this.color=e.textColor;this.underline=e.textUnderline;this.overline=e.textOverline;this.parent=null;this.children=[];switch(this.nodeType){case "textBlock":this.draw=this.drawTextBlock;break;case "textLineBlock":this.draw=this.drawTextLineBlock;break;case "formula":this.draw=this.drawFormula;break;case "superIndex":this.draw=this.drawSuperIndex;break;case "subIndex":this.draw=this.drawSubIndex;break;case "dynamicText":this.draw=
this.drawDynamicText;this.decimal_symbol=this.evaluator.parent.decimal_symbol;break;case "fraction":this.draw=this.drawFraction;break;case "numerator":case "denominator":this.draw=this.drawNumDen;break;case "radical":this.draw=this.drawRadical;break;case "limit":this.draw=this.drawLimit;break;case "integral":this.draw=this.drawIntegral;break;case "sum":this.draw=this.drawSum;break;case "matrix":this.draw=this.drawMatrix;break;case "defparts":this.draw=this.drawDefparts;break;case "text":case "newLine":this.draw=
this.drawText;break;case "hyperlink":this.draw=this.drawHyperlink;break;case "mathSymbol":this.draw=this.drawMathSymbol;break;case "index":case "radicand":case "from":case "to":case "what":case "element":this.draw=this.drawGenericBlock;break;case "componentNumCtrl":this.draw=this.drawComponentNumCtrl;break;case "componentSpace":this.draw=this.drawComponentSpace}};a.RTFNode.prototype.getRoot=function(){return null==this.parent?this:this.parent.getRoot()};a.RTFNode.prototype.addChild=function(a){a.parent=
this;this.children.push(a)};var e=0,b=0,m=0;a.RTFNode.prototype.getTextMetrics=function(){if("textBlock"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);for(var c=0,d=this.children.length;c<d;c++)this.children[c].getTextMetrics()}else if("textLineBlock"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),this.getBlockMetric();else if("newLine"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);var n=a.getFontMetrics(this.styleString);this.baseline=
n.baseline;this.descent=n.descent;this.ascent=n.ascent;this.w=0;this.h=n.h}else if("text"==this.nodeType||"dynamicText"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);n=a.getFontMetrics(this.styleString);this.baseline=n.baseline;this.descent=n.descent;this.ascent=n.ascent;var c=this.value,r;"string"!=typeof this.value&&(d=void 0==this.decimals?f:this.evaluator.evalExpression(this.decimals),r=void 0==this.fixed?g:this.fixed,c=this.evaluator.evalExpression(this.value,d,r),parseFloat(c).toString()===
c.toString()&&(c=r?parseFloat(c).toFixed(d):a.removeNeedlessDecimals(parseFloat(c).toFixed(d)),c=(""+c).replace(".",this.decimal_symbol)),c+=" ");this.w=a.getTextWidth(c,this.styleString);this.h=n.h}else if("formula"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),this.getBlockMetric();else if("hyperlink"===this.nodeType){c=a.getFontMetrics(this.styleString);this.baseline=c.baseline;this.descent=c.descent;this.ascent=c.ascent;this.w=a.getTextWidth(this.value,this.styleString);
this.h=c.h;this.clickCacher=document.createElement("div");this.clickCacher.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; cursor: pointer;");var k=new a.OpenURL(this.evaluator.parent,this.URL),s=this;this.clickCacher.addEventListener("click",function(a){s.click=!0;k.actionExec()})}else if("superIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),d=e,n=b,r=m,c=a.getFontMetrics(this.styleString),this.getBlockMetric(),0>this.h&&(this.ascent=
c.ascent,this.descent=c.descent,this.h=this.ascent+this.descent,this.w=1.5*this.spaceWidth),c=r/2-n+this.h,this.superIndexPos=c-this.ascent,this.ascent=c,this.descent=n,this.baseline=this.ascent,this.h=this.ascent+this.descent;else if("subIndex"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),d=e,n=b,r=m,c=a.getFontMetrics(this.styleString),this.getBlockMetric(),0>this.h&&(this.ascent=c.ascent,this.descent=c.descent,this.h=this.ascent+this.descent,this.w=1.5*this.spaceWidth),this.subIndexPos=
n+1,this.ascent=d,this.descent=this.subIndexPos+this.descent,this.baseline=this.ascent,this.h=this.ascent+this.descent;else if("fraction"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);var q=this.children[0],u=this.children[1],c=a.getFontMetrics(q.styleString);q.getBlockMetric();u.getBlockMetric();d=e;n=b;r=m;0>q.h&&(q.h=c.h,q.w=this.spaceWidth);0>u.h&&(u.h=c.h,u.w=this.spaceWidth);this.h=q.h+u.h-1;this.ascent=q.h+Math.round(r/2)-n;this.descent=this.h-this.ascent;this.baseline=
this.ascent;this.w=Math.max(q.w,u.w)+this.spaceWidth+8}else if("radical"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);n=this.children[0].style.clone();if(1===this.children.length)this.children[1]=new a.RTFNode(this.evaluator," ","radicand",n),this.children[1].addChild(this.children[0]),this.children[0]=new a.RTFNode(this.evaluator," ","index",n);else if("index"!==this.children[0].nodeType||"radicand"!==this.children[1].nodeType){r=new a.RTFNode(this.evaluator,"","radicand",
n);c=0;for(d=this.children.length;c<d;c++)r.addChild(this.children[c]);this.children=[];this.children[0]=new a.RTFNode(this.evaluator,"","index",n);this.children[1]=r}c=this.children[0];d=this.children[1];0>=c.children.length&&(n=this.style.clone(),n.fontSize=parseInt(n.fontSize-.2*n.fontSize),c.addChild(new a.RTFNode(this.evaluator," ","text",n)));0>=d.children.length&&d.addChild(new a.RTFNode(this.evaluator," ","text",this.style.clone()));c.getBlockMetric();d.getBlockMetric();this.ascent=d.h/2<
c.h?d.h/2+c.h+2-d.descent:d.ascent+4;this.descent=d.descent;this.baseline=this.ascent;this.h=this.ascent+this.descent;this.w=c.w+d.w+4*this.spaceWidth}else if("sum"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),d=e,n=b,r=m,n=this.children[0],d=this.children[1],r=this.children[2],n.getBlockMetric(),d.getBlockMetric(),r.getBlockMetric(),-1==n.ascent&&(q=a.getFontMetrics(n.styleString),n.ascent=q.ascent,n.descent=q.descent,n.h=q.h),-1==d.ascent&&(q=a.getFontMetrics(d.styleString),
d.ascent=q.ascent,d.descent=q.descent,d.h=q.h),c=a.getFontMetrics(this.styleString),this.ascent=c.h+d.h>r.ascent?c.h-c.descent+d.h:r.ascent,this.descent=n.h>r.descent?n.h+c.descent:r.descent,this.baseline=this.ascent,this.h=this.ascent+this.descent,c=this.style.clone(),c.fontType="Times New Roman",c.Bold="bold",c=c.toString(),c=a.getTextWidth(String.fromCharCode(8721),c),this.w=Math.max(n.w,d.w,c)+Math.max(r.w,this.spaceWidth)+this.spaceWidth;else if("integral"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",
this.styleString),d=e,n=b,r=m,n=this.children[0],d=this.children[1],r=this.children[2],n.getBlockMetric(),d.getBlockMetric(),r.getBlockMetric(),-1==n.ascent&&(q=a.getFontMetrics(n.styleString),n.ascent=q.ascent,n.descent=q.descent,n.h=q.h),-1==d.ascent&&(q=a.getFontMetrics(d.styleString),d.ascent=q.ascent,d.descent=q.descent,d.h=q.h),c=a.getFontMetrics(this.styleString),this.ascent=c.h+d.h>r.ascent?c.h-c.descent+d.h:r.ascent,this.descent=n.h>r.descent?n.h+c.descent:r.descent,this.baseline=this.ascent,
this.h=this.ascent+this.descent,c=this.style.clone(),c.fontSize*=1.5,c.fontType="Times New Roman",c.Bold="bold",c=c.toString(),c=a.getTextWidth(String.fromCharCode(8747),c),this.w=Math.max(n.w,d.w,c)+Math.max(r.w,this.spaceWidth)+2*this.spaceWidth;else if("limit"==this.nodeType)this.spaceWidth=a.getTextWidth(" ",this.styleString),d=e,n=b,r=m,n=this.children[0],d=this.children[1],r=this.children[2],c=a.getFontMetrics(this.styleString),n.getBlockMetric(),d.getBlockMetric(),r.getBlockMetric(),-1==n.ascent&&
(q=a.getFontMetrics(n.styleString),n.ascent=q.ascent,n.descent=q.descent,n.h=q.h),-1==d.ascent&&(q=a.getFontMetrics(d.styleString),d.ascent=q.ascent,d.descent=q.descent,d.h=q.h),-1==r.ascent&&(q=a.getFontMetrics(r.styleString),r.ascent=q.ascent,r.descent=q.descent,r.h=q.h),this.ascent=r.ascent,this.descent=Math.max(c.h,r.descent),this.baseline=this.ascent,this.h=this.ascent+this.descent,c=a.getTextWidth(" "+String.fromCharCode(8594),this.styleString),0==n.w&&(n.w=this.spaceWidth),0==d.w&&(d.w=this.spaceWidth),
0==r.w&&(r.w=this.spaceWidth),this.w=d.w+n.w+r.w+c+this.spaceWidth;else if("matrix"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);c=a.getFontMetrics(this.styleString);d=e;n=b;r=m;r=c.ascent;for(var q=c.descent,u=c.h,l=this.spaceWidth,v,p,c=0,d=this.children.length;c<d;c++)this.children[c].getBlockMetric(),v=this.children[c].h,p=this.children[c].w,u<v&&(u=v,r=this.children[c].ascent,q=this.children[c].descent),l<p&&(l=p);this.childWidth=l+2*this.spaceWidth;this.childHeight=u;
this.childAscent=r;this.childDescent=q;this.h=this.rows*u;this.ascent=this.h/2;this.descent=this.h/2;this.w=this.columns*this.childWidth+this.spaceWidth}else if("defparts"==this.nodeType){this.spaceWidth=a.getTextWidth(" ",this.styleString);c=a.getFontMetrics(this.styleString);d=e;n=b;r=m;r=c.ascent;q=c.descent;u=c.h;l=this.spaceWidth;c=0;for(d=this.children.length;c<d;c++)this.children[c].getBlockMetric(),v=this.children[c].h,p=this.children[c].w,u<v&&(u=v,r=this.children[c].ascent,q=this.children[c].descent),
l<p&&(l=p);this.childWidth=l+2*this.spaceWidth;this.childHeight=u;this.childAscent=r;this.childDescent=q;this.h=this.parts*u;this.ascent=this.h/2+n;this.descent=this.h-this.ascent;this.w=l+this.spaceWidth/2}else"mathSymbol"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),n=a.getFontMetrics(this.styleString),this.baseline=n.baseline,this.descent=n.descent,this.ascent=n.ascent,this.w=a.getTextWidth(this.value,this.styleString)+this.spaceWidth,this.h=n.h):"componentNumCtrl"==this.nodeType?
(this.spaceWidth=a.getTextWidth(" ",this.styleString),n=a.getFontMetrics(this.styleString),this.componentNumCtrl=this.evaluator.parent.getControlByCId(this.value),this.baseline=n.baseline-2,this.descent=n.descent-2,this.ascent=n.ascent+2,this.h=this.componentNumCtrl.h||1,this.w=this.componentNumCtrl.w||1):"componentSpace"==this.nodeType?(this.spaceWidth=a.getTextWidth(" ",this.styleString),this.componentSpace=this.evaluator.parent.getSpaceByCId(this.value),this.h=this.ascent=this.descent=this.baseline=
0,this.w=this.componentSpace.w):console.log("Element i=unknown",this.nodeType)};a.RTFNode.prototype.getBlockMetric=function(){this.w=0;for(var a=-1,c=-1,f,g=0,k=this.children.length;g<k;g++){f=this.children[g];f.getTextMetrics();childAscent=f.ascent;childDescent=f.descent;this.w+=f.w;var s=childDescent;f=f.h;e=childAscent;b=s;m=f;c<childAscent&&(c=childAscent);a<childDescent&&(a=childDescent)}this.ascent=c;this.descent=a;this.baseline=this.ascent;this.h=this.ascent+this.descent};a.RTFNode.prototype.drawTextBlock=
function(a,b,e,m,k,s,q,u){c=u;this.stableWidth||(f=m,g=k,this.getTextMetrics());q=q?-this.children[0].ascent:0;k=m=0;for(s=this.children.length;k<s;k++)0<k&&(m+=this.children[k-1].h),this.children[k].draw(a,b+0,e+q+m)};a.RTFNode.prototype.drawTextLineBlock=function(a,b,e){for(var f=0,g=0,m=this.children.length;g<m;g++)a.strokeStyle=c,a.fillStyle=c,0<g&&(f+=this.children[g-1].w,"formula"==this.children[g-1].nodeType&&(f+=2*this.children[g-1].spaceWidth)),this.children[g].draw(a,b+f,e+this.baseline)};
a.RTFNode.prototype.drawFormula=function(a,b,c){for(var e=0,f=0,g=this.children.length;f<g;f++)0<f&&(e+=this.children[f-1].w),this.children[f].draw(a,b+this.spaceWidth+e,c)};a.RTFNode.prototype.drawText=function(a,b,c){null!=this.color&&(a.fillStyle=this.color);a.font=this.styleString;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,b-1,c);if(this.underline){var e="bold"==this.style.textBold,f=e?1:.5;a.lineWidth=e?2:1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();
a.moveTo(b-1,parseInt(c+this.descent/2)+f);a.lineTo(b-1+this.w,parseInt(c+this.descent/2)+f);a.stroke()}this.overline&&(f=(e="bold"==this.style.textBold)?2:1.5,a.lineWidth=e?2:1,null!=this.color&&(a.strokeStyle=this.color),a.beginPath(),a.moveTo(b-1,parseInt(c-this.ascent)+f),a.lineTo(b-1+this.w,parseInt(c-this.ascent)+f),a.stroke())};a.RTFNode.prototype.drawDynamicText=function(b,c,e){var m=Math.floor(.5*this.spaceWidth),k=void 0==this.decimals?f:this.evaluator.evalExpression(this.decimals),s=void 0==
this.fixed?g:this.fixed,q=this.evaluator.evalExpression(this.value);parseFloat(q).toString()===q.toString()&&(q=s?parseFloat(q).toFixed(k):a.removeNeedlessDecimals(parseFloat(q).toFixed(k)),q=(""+q).replace(".",this.decimal_symbol));null!=this.color&&(b.fillStyle=this.color);b.font=this.styleString;b.textAlign="start";b.textBaseline="alphabetic";this.w=a.getTextWidth(q,this.styleString);b.fillText(q,m+c,e);this.underline&&(s=(k="bold"==this.style.textBold)?1:.5,b.lineWidth=k?2:1,null!=this.color&&
(b.strokeStyle=this.color),b.beginPath(),b.moveTo(m+c-1,parseInt(e+this.descent/2)+s),b.lineTo(m+c-1+this.w,parseInt(e+this.descent/2)+s),b.stroke());this.overline&&(s=(k="bold"==this.style.textBold)?2:1.5,b.lineWidth=k?2:1,null!=this.color&&(b.strokeStyle=this.color),b.beginPath(),b.moveTo(m+c-1,parseInt(e-this.ascent)+s),b.lineTo(m+c-1+this.w,parseInt(e-this.ascent)+s),b.stroke());this.w+=2*m};a.RTFNode.prototype.drawHyperlink=function(a,b,c){this.clickCacher.parentNode||(a.canvas.nextSibling.className?
a.canvas.parentNode.insertBefore(this.clickCacher,a.canvas.nextSibling.nextSibling):a.canvas.parentNode.insertBefore(this.clickCacher,a.canvas.nextSibling),this.clickCacher.style.left=b-2+"px",this.clickCacher.style.top=c-this.ascent-2+"px");a.save();this.click?(a.fillStyle="red",a.strokeStyle="red"):(a.fillStyle="blue",a.strokeStyle="blue");a.font=this.styleStr;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,b-1,c);var e="bold"==this.style.textBold,f=e?1:.5;a.lineWidth=e?2:
1;a.beginPath();a.moveTo(b-1,Math.ceil(c+this.descent/2)+f-2);a.lineTo(b-1+this.w,Math.ceil(c+this.descent/2)+f-2);a.stroke();a.restore()};a.RTFNode.prototype.drawRadical=function(a,b,c){var e=Math.floor(this.spaceWidth);this.children[0].draw(a,b,Math.floor(c+this.children[1].descent-this.children[1].h/2-this.children[0].descent));this.children[1].draw(a,b+1.5*e+this.children[0].w,c);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b,Math.floor(c+this.children[1].descent-
this.children[1].h/2));a.lineTo(b+this.children[0].w,Math.floor(c+this.children[1].descent-this.children[1].h/2));a.lineTo(b+this.children[0].w+.5*e,c+this.children[1].descent);a.lineTo(b+this.children[0].w+1*e,c-this.children[1].ascent);a.lineTo(b+this.children[0].w+2*e+this.children[1].w,c-this.children[1].ascent);a.stroke()};a.RTFNode.prototype.drawFraction=function(a,b,c){this.children[0].draw(a,b+(this.w-this.children[0].w)/2,c-this.ascent);this.children[1].draw(a,b+(this.w-this.children[1].w)/
2,c-this.ascent+this.children[0].h-1);var e=Math.floor(.5*this.spaceWidth);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b+e,parseInt(c-this.ascent+this.children[0].h)-.5);a.lineTo(b-e+this.w-1,parseInt(c-this.ascent+this.children[0].h)-.5);a.stroke()};a.RTFNode.prototype.drawNumDen=function(a,b,c){for(var e=0,f=0,g=this.children.length;f<g;f++)0<f&&(e+=this.children[f-1].w),this.children[f].draw(a,b+e,c+this.baseline)};a.RTFNode.prototype.drawSubIndex=function(a,
b,c){for(var e=0,f=0,g=this.children.length;f<g;f++)0<f&&(e+=this.children[f-1].w),this.children[f].draw(a,b+e,c+this.subIndexPos)};a.RTFNode.prototype.drawSuperIndex=function(a,b,c){for(var e=0,f=0,g=this.children.length;f<g;f++)0<f&&(e+=this.children[f-1].w),this.children[f].draw(a,b+e,c-this.superIndexPos)};a.RTFNode.prototype.drawLimit=function(b,c,e){var f=a.getFontMetrics(this.styleString),g=" "+String.fromCharCode(8594),m=a.getTextWidth(g,this.styleString);this.children[0].draw(b,c,e+f.descent+
this.children[0].ascent);this.children[1].draw(b,c+this.children[0].w+m,e+f.descent+this.children[1].ascent);this.children[2].draw(b,c+m+this.children[0].w+this.children[1].w,e);null!=this.color&&(b.fillStyle=this.color);b.font=this.styleString;b.textAlign="start";b.textBaseline="alphabetic";b.fillText("l\u00edm",c+this.children[0].w,e);b.fillText(g,c+this.children[0].w,e+f.descent+this.children[0].ascent)};a.RTFNode.prototype.drawIntegral=function(b,c,e){var f=this.style.clone();f.fontSize*=1.5;
f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),g=a.getTextWidth(String.fromCharCode(8747),f),m=a.getFontMetrics(f),q=Math.max(this.children[0].w,this.children[1].w,Math.floor(1.5*g));this.children[0].draw(b,c+g,e+m.descent+this.children[0].ascent);this.children[1].draw(b,c+g+this.spaceWidth/2,e-this.ascent+this.children[1].ascent);this.children[2].draw(b,c+q+g,e);null!=this.color&&(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8747),
c,e+m.descent/2)};a.RTFNode.prototype.drawSum=function(b,c,e){var f=this.style.clone();f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),g=a.getTextWidth(String.fromCharCode(8721),f),m=a.getFontMetrics(this.styleString),q=Math.max(this.children[0].w,this.children[1].w,g);this.children[0].draw(b,c+(q-this.children[0].w)/2,e+m.descent+this.children[0].ascent);this.children[1].draw(b,c+(q-this.children[1].w)/2,e-m.ascent-this.children[1].descent);this.children[2].draw(b,c+q,e);null!=this.color&&
(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8721),c+Math.floor((q-g)/2),e-5)};a.RTFNode.prototype.drawMatrix=function(a,b,c){for(var e,f,g=0,m=this.children.length;g<m;g++)e=g%this.columns,f=Math.floor(g/this.columns),this.children[g].draw(a,2*this.spaceWidth+b+e*this.childWidth,c-this.ascent+this.childAscent+f*this.childHeight);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(Math.floor(b+this.spaceWidth)+
.5,c-this.ascent+.5);a.lineTo(Math.floor(b+this.spaceWidth/2)+.5,c-this.ascent+.5);a.lineTo(Math.floor(b+this.spaceWidth/2)+.5,c+this.descent+.5);a.lineTo(Math.floor(b+this.spaceWidth)+.5,c+this.descent+.5);a.moveTo(Math.floor(b+this.w-this.spaceWidth)-.5,c-this.ascent+.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth/2)-.5,c-this.ascent+.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth/2)-.5,c+this.descent+.5);a.lineTo(Math.floor(b+this.w-this.spaceWidth)-.5,c+this.descent+.5);a.stroke()};a.RTFNode.prototype.drawDefparts=
function(a,b,c){for(var e=0,f=this.children.length;e<f;e++)this.children[e].draw(a,b+3*this.spaceWidth,c-this.ascent+this.childAscent+e%this.parts*this.childHeight);a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(parseInt(b+2*this.spaceWidth)+.5,c-this.ascent+.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c-this.ascent+4.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c+this.descent-this.h/2-4.5);a.lineTo(b-.5,c+this.descent-this.h/2);a.lineTo(parseInt(b+2*this.spaceWidth)-
4.5,c+this.descent-this.h/2+4.5);a.lineTo(parseInt(b+2*this.spaceWidth)-4.5,c+this.descent-4.5);a.lineTo(parseInt(b+2*this.spaceWidth)+.5,c+this.descent+.5);a.stroke()};a.RTFNode.prototype.drawMathSymbol=function(a,b,c){a.lineWidth=1;null!=this.color&&(a.strokeStyle=this.color,a.fillStyle=this.color);a.beginPath();"("==this.value?(a.font=this.styleString,a.textAlign="start",a.textBaseline="alphabetic",a.fillText("(",b,c)):")"==this.value?(a.font=this.styleString,a.textAlign="start",a.textBaseline=
"alphabetic",a.fillText(")",b+this.spaceWidth,c)):(a.font=this.styleString,a.textAlign="center",a.textBaseline="alphabetic",a.fillText(this.value,b+this.w/2,c))};a.RTFNode.prototype.drawGenericBlock=function(a,b,c){for(var e=0,f=0,g=this.children.length;f<g;f++)0<f&&(e+=this.children[f-1].w),this.children[f].draw(a,b+e,c)};a.RTFNode.prototype.drawComponentNumCtrl=function(a,b,c){this.parent.getTextMetrics();this.componentNumCtrl.expresion=this.evaluator.parser.parse("("+b+","+(c-this.ascent)+","+
this.componentNumCtrl.w+","+this.componentNumCtrl.h+")")};a.RTFNode.prototype.drawComponentSpace=function(a,b,c){this.getTextMetrics();this.componentSpace.xExpr=this.evaluator.parser.parse(b+"");this.componentSpace.yExpr=this.evaluator.parser.parse(c-this.parent.ascent+"")};a.RTFNode.prototype.draw=function(a,b,c){console.log(">>> Dibujo desconocido ",this.nodeType)};a.RTFNode.prototype.toHTML=function(){var a="";if("textLineBlock"===this.nodeType||"textBlock"===this.nodeType)for(var b=0,c=this.children.length;b<
c;b++)a+=this.children[b].toHTML();else"text"===this.nodeType?a="<span "+this.style.toCSS()+">"+this.value+"</span>":"newLine"===this.nodeType&&(a="<span "+this.style.toCSS()+">"+this.value+"<br /></span>");return a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f=String.fromCharCode,g,c,e,b,m,h,d,n,r,k,s,q;a.RTFTokenizer=function(){};a.RTFTokenizer.prototype.tokenize=function(a){if(a)a=a.replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&quote;/g,"''").replace(/\&squot;/g,
"'").replace(/\\rquote /g,"'").replace(/\\endash /g,"-").replace(/\n/g," ").replace(/\r/g,"").replace(/\\uc(\d+) /g,"").replace(/\\uc(\d+)/g,"");else return[];g=[];c=a.length;g=[];e="";m=b=0;d=a.charAt(0);n=!1;for(r="text";b<c;)h=d,d=a.charAt(b+1),n?"\\"===d||"{"===d||"}"===d||" "===d||";"===d?(n=!1,e+=h," "===d?(b++,d=a.charAt(b+1),q=!0):q=!1,(k=e.match(/^\'([0-9a-f]{2})/))?(s="","text"===r&&(s=g.pop().value),e=s+=f(parseInt(k[1],16))+e.substring(3)):(k=e.match(/^u[0-9]+/))?(s="","text"===r&&(s=
g.pop().value),e=s+=f(k[0].substring(1))):("{"===e||"}"===e||"\\"==h?(g.push({type:"text",value:e+(q?" ":"")}),r="text"):(g.push({type:"controlWord",value:e}),r="controlWord"),e="")):"{"==h||"}"==h||"\\"==h?(n=!1,g.push({type:"text",value:h}),r="text"):e+=h:"\\"===h?(n=!0,""!==e&&(g.push({type:"text",value:e}),r="text"),e=""):"{"===h?(m++,""!==e&&g.push({type:"text",value:e}),e="",g.push({type:"openBlock",value:m}),r="openBlock"):"}"===h?(""!==e&&g.push({type:"text",value:e}),e="",g.push({type:"closeBlock",
value:m}),r="closeBlock",m--):e+=h,b++;""!==e&&g.push({type:"text",value:e});return g};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r,k,s,q,u,l,v,p,t,w,A,C,z,B,E,D,y,I,G,H,J;a.RTFParser=function(b){this.evaluator=b;this.tokenizer=new a.RTFTokenizer};a.RTFParser.prototype.parse=function(x){x=f=this.tokenizer.tokenize(x);for(var K=[],F=!1,L=!1,M=[],N=0,R=x.length;N<R;N++)if("openBlock"==x[N].type&&M.push(x[N].value),"closeBlock"==x[N].type&&(M.pop(),
0>=M.length&&(F=!1)),"controlWord"!=x[N].type||"expr"!=x[N].value&&"decimals"!=x[N].value||(L=!0),"controlWord"==x[N].type&&"mjaformula"==x[N].value&&(F=!0),"text"==x[N].type&&F&&!L){for(var S=0,P=x[N].value,Q="",O=0,V=P.length;O<V;O++)if("("==P.charAt(O)||")"==P.charAt(O)||"+"==P.charAt(O)||"-"==P.charAt(O)||"*"==P.charAt(O)||"="==P.charAt(O))Q=P.substring(S,O),""!=Q&&K.push({type:"text",value:Q}),K.push({type:P.charAt(O),value:P.charAt(O)}),S=O+1;Q=P.substring(S,O);""!=Q&&K.push({type:"text",value:Q})}else K.push(x[N]),
"text"==x[N].type&&L&&(L=!1);f=K;g={};e=2;if("openBlock"==f[0].type&&"fonttbl"==f[1].value){for(c=f[0].value;"closeBlock"!=f[e].type&&f[e].value!=c;)g[f[e].value]=f[e+2].value.substring(0,f[e+2].value.length-1),e+=3;e++}b={};m=0;if("openBlock"==f[e].type&&"colortbl"==f[e+1].value){c=f[e++].value;for(e++;"closeBlock"!=f[e].type&&f[e].value!=c;)h=parseInt(f[e++].value.substring(3)).toString(16),d=parseInt(f[e++].value.substring(5)).toString(16),n=parseInt(f[e++].value.substring(4)).toString(16),";"===
f[e].value&&e++,b[m++]="#"+(2>h.length?"0"+h:h)+(2>d.length?"0"+d:d)+(2>n.length?"0"+n:n);e++}r=new a.RTFNode(this.evaluator,"","textBlock","",!1,"");k=new a.RTFNode(this.evaluator,"","textLineBlock","",!1,"");r.addChild(k);u=q=s=null;A=w=t=p=v=l=!1;C=[new a.FontStyle(20,"Arial","","",!1,!1,null)];z=C[0];B=!0;D=E=-1;y=[];J=H=G=I=!1;x=e;for(K=f.length;x<K;x++)if("controlWord"==f[x].type&&g[f[x].value])z.fontType=g[f[x].value];else if("controlWord"==f[x].type&&f[x].value.match(/^fs(\d+)/))z.fontSize=
parseInt(f[x].value.match(/^fs(\d+)/)[1]/2);else if("controlWord"==f[x].type&&"b"==f[x].value)z.textBold="bold";else if("controlWord"==f[x].type&&"b0"==f[x].value)z.textBold="";else if("controlWord"==f[x].type&&"i"==f[x].value)z.textItalic="oblique";else if("controlWord"==f[x].type&&"i0"==f[x].value)z.textItalic="";else if("controlWord"==f[x].type&&"ul"==f[x].value)z.textUnderline=!0;else if("controlWord"==f[x].type&&"ulnone"==f[x].value)z.textUnderline=!1;else if("controlWord"==f[x].type&&"ol"==
f[x].value)z.textOverline=!0;else if("controlWord"==f[x].type&&"olnone"==f[x].value)z.textOverline=!1;else if("controlWord"==f[x].type&&f[x].value.match(/^cf(\d+)/))z.textColor=b[parseInt(f[x].value.substring(2))],0<y.length&&(y[y.length-1].style.textColor=z.textColor);else if("openBlock"==f[x].type)E=f[x].value,z=z.clone(),C.push(z),y.push(null);else if("closeBlock"==f[x].type)f[x].value==D&&(D=-1,l=!1,k=k.parent),C.pop(),z=C[C.length-1],y.pop();else if("controlWord"==f[x].type&&"par"==f[x].value){k.addChild(new a.RTFNode(this.evaluator,
"","newLine",z.clone()));r=new a.RTFNode(this.evaluator,"","textLineBlock",z.clone());if("textBlock"!=k.nodeType)for(k=k.parent;"textBlock"!=k.nodeType;)k=k.parent;k.addChild(r);k=r}else if("controlWord"==f[x].type&&"mjaformula"==f[x].value)I=!0,D=E,l=!0,r=new a.RTFNode(this.evaluator,"","formula",z.clone()),k.addChild(r),k=r,y[y.length-1]=r;else if("controlWord"==f[x].type&&("fraction"==f[x].value||"radicand"==f[x].value||"radical"==f[x].value||"what"==f[x].value||"sum"==f[x].value||"integral"==
f[x].value||"limit"==f[x].value))F=y[y.length-2].style.clone(),r=new a.RTFNode(this.evaluator,"",f[x].value,F),y[y.length-2].addChild(r),y[y.length-1]=r;else if("controlWord"==f[x].type&&"index"==f[x].value||"to"==f[x].value||"from"==f[x].value)F=y[y.length-2].style.clone(),F.fontSize=parseInt(F.fontSize-.2*F.fontSize),8>F.fontSize&&(F.fontSize=8),r=new a.RTFNode(this.evaluator,"",f[x].value,F),y[y.length-2].addChild(r),y[y.length-1]=r;else if("controlWord"==f[x].type&&("num"==f[x].value||"den"==
f[x].value))F=y[y.length-2].style.clone(),F.fontSize=Math.round(F.fontSize-.1*F.fontSize),8>F.fontSize&&(F.fontSize=8),"num"==f[x].value?r=new a.RTFNode(this.evaluator,"","numerator",F):"den"==f[x].value&&(r=new a.RTFNode(this.evaluator,"","denominator",F)),y[y.length-2].addChild(r),y[y.length-1]=r;else if("controlWord"==f[x].type&&("subix"==f[x].value||"supix"==f[x].value))F=y[y.length-2].style.clone(),F.fontSize=Math.floor(F.fontSize-F.fontSize/3),8>F.fontSize&&(F.fontSize=8),"subix"==f[x].value?
r=new a.RTFNode(this.evaluator,"","subIndex",F):"supix"==f[x].value&&(r=new a.RTFNode(this.evaluator,"","superIndex",F)),r.originalStyle=y[y.length-2].style.clone(),y[y.length-2].addChild(r),y[y.length-1]=r;else if("controlWord"==f[x].type&&("defparts"==f[x].value||"matrix"==f[x].value||"element"==f[x].value))F=y[y.length-2].style.clone(),r=new a.RTFNode(this.evaluator,"",f[x].value,F),y[y.length-2].addChild(r),y[y.length-1]=r,"defparts"==f[x].value?u=r:"matrix"==f[x].value&&(q=r);else if("controlWord"==
f[x].type&&"parts"==f[x].value)A=!0;else if("text"==f[x].type&&A)u.parts=parseInt(f[x].value),A=!1;else if("controlWord"==f[x].type&&"rows"==f[x].value)t=!0;else if("text"==f[x].type&&t)q.rows=parseInt(f[x].value),t=!1;else if("controlWord"==f[x].type&&"columns"==f[x].value)w=!0;else if("text"==f[x].type&&w)q.columns=parseInt(f[x].value),w=!1;else if("controlWord"==f[x].type&&"expr"==f[x].value)B=!1,v=!0;else if("controlWord"==f[x].type&&"decimals"==f[x].value)p=!0;else if("text"==f[x].type&&p)s.decimals=
this.evaluator.parser.parse(f[x].value+""),p=!1;else if("controlWord"==f[x].type&&"fixed1"==f[x].value)s.fixed=!0;else if("controlWord"==f[x].type&&"fixed0"==f[x].value)s.fixed=!1;else if("controlWord"!=f[x].type||"component"!=f[x].value)if("controlWord"==f[x].type&&"NumCtrl"==f[x].value)G=!0;else if("controlWord"==f[x].type&&"Space"==f[x].value)H=!0;else if("controlWord"==f[x].type&&"hyperlink"==f[x].value)J=!0;else if("text"==f[x].type&&J){textContent=f[x].value.split("|")[0];F=z.clone();r=new a.RTFNode(this.evaluator,
textContent,"hyperlink",F);r.URL=f[x].value.split("|")[1];if("textLineBlock"!=k.nodeType)for(k=k.parent;"textLineBlock"!=k.nodeType;)k=k.parent;k.addChild(r);J=!1}else if("text"==f[x].type&&G)r=new a.RTFNode(this.evaluator,f[x].value,"componentNumCtrl",z.clone()),k.addChild(r),G=!1;else if("text"==f[x].type&&H)r=new a.RTFNode(this.evaluator,f[x].value,"componentSpace",z.clone()),k.addChild(r),H=!1;else if("text"==f[x].type&&v)F=y[y.length-2].style.clone(),textContent=this.evaluator.parser.parse(f[x].value),
r=new a.RTFNode(this.evaluator,textContent,"dynamicText",F),y[y.length-2].addChild(r),s=y[y.length-1]=r,v=!1;else if("text"==f[x].type&&!v&&!l){textContent=f[x].value;r=new a.RTFNode(this.evaluator,textContent,"text",z.clone());if("textLineBlock"!=k.nodeType)for(k=k.parent;"textLineBlock"!=k.nodeType;)k=k.parent;k.addChild(r)}else if("text"==f[x].type&&!v&&l)textContent=f[x].value,r=new a.RTFNode(this.evaluator,textContent,"text",y[y.length-1].style.clone()),y[y.length-1].addChild(r);else if("("==
f[x].type||")"==f[x].type)F=y[y.length-1].style.clone(),F.textItalic="",r=new a.RTFNode(this.evaluator,f[x].type,"mathSymbol",F),y[y.length-1].addChild(r);else if("+"==f[x].type||"-"==f[x].type||"*"==f[x].type||"="==f[x].type)r=new a.RTFNode(this.evaluator,f[x].type,"mathSymbol",y[y.length-1].style.clone()),y[y.length-1].addChild(r);if(null!=k){var U=k.getRoot();U.stableWidth=B;U.getTextMetrics();U.hasFormula=I}return U};a.FontStyle=function(a,b,c,d,e,f,h){this.fontSize=a;this.fontType=b;this.textItalic=
c;this.textBold=d;this.textUnderline=e;this.textOverline=f;this.textColor=h};a.FontStyle.prototype.toString=function(){"arial"==this.fontType.toLowerCase()?this.fontType="descartesJS_sansserif,Arial,Helvetica,Sans-serif":this.fontType.toLowerCase().match("times")?this.fontType="descartesJS_serif,'Times New Roman',Times,serif":this.fontType.toLowerCase().match("courier")&&(this.fontType="descartesJS_monospace,'Courier New',Courier,Monospace");return(this.textBold+" "+this.textItalic+" "+this.fontSize+
"px "+this.fontType).trim()};a.FontStyle.prototype.toCSS=function(){var a="style='font: "+this.fontSize+"px "+this.fontType+"; ";this.textUnderline&&!this.textOverline&&(a+="text-decoration: underline; ");!this.textUnderline&&this.textOverline&&(a+="text-decoration: overline; ");this.textUnderline&&this.textOverline&&(a+="text-decoration: underline overline; ");this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: bold; ");!this.textBold&&this.textItalic&&(a+="font-style: oblique; font-weight: normal; ");
this.textBold&&this.textItalic&&(a+="font-style: oblique; font-weight: bold; ");this.textBold||this.textItalic||(a+="font-style: normal; font-weight: normal; ");this.textColor&&(a+="color: "+this.textColor+"; ");return a+"'"};a.FontStyle.prototype.clone=function(){return new a.FontStyle(this.fontSize,this.fontType,this.textItalic,this.textBold,this.textUnderline,this.textOverline,this.textColor)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b,m,h,d,n,r,k,s,
q,u;a.Space=function(b,d){this.parent=b;g=this.evaluator=this.parent.evaluator;c=g.parser;this.id="";this.values=d;this.type="R2";this.xExpr=c.parse("0");this.yExpr=c.parse("0");this.w=parseInt(b.container.width);this.h=parseInt(b.container.height);this.drawif=c.parse("1");this.fixed=2!=b.version?!1:!0;this.scale=48;this.Oy=this.Ox=0;this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.bg_display="topleft";this.background="descinst.com.mja.descartes.DescartesJS.class"===
b.code||b.arquimedes?new a.Color("f0f8fa"):new a.Color("ffffff");this.net=2!=b.version?new a.Color("c0c0c0"):"";this.net10=2!=b.version?new a.Color("808080"):"";this.axes=2!=b.version?new a.Color("808080"):"";this.text=new a.Color("ffafaf");this.numbers=!1;this.x_axis=2!=b.version?"":" ";this.y_axis=2!=b.version?"":" ";this.sensitive_to_mouse_movements=!1;this.cID="";this.mouse_y=this.mouse_x=0;this.ctrs=[];this.graphicsCtr=[];this.graphics=[];this.backgroundGraphics=[];this.zIndex=b.zIndex;this.plecaHeight=
b.plecaHeight||0;this.displaceRegionNorth=b.displaceRegionNorth||0;this.displaceRegionWest=b.displaceRegionWest||0;for(var e in d)d.hasOwnProperty(e)&&(this[e]=d[e]);this.init()};a.Space.prototype.init=function(){f=this.parent;g=this.evaluator;e=this.id;this.displaceRegionNorth=f.displaceRegionNorth||0;this.displaceRegionWest=f.displaceRegionWest||0;void 0!=this.wExpr&&(this.w=(parseInt(f.container.width)-this.displaceRegionWest)*parseFloat(this.wExpr)/100);void 0!=this.hExpr&&(this.h=(parseInt(f.container.height)-
this.displaceRegionNorth)*parseFloat(this.hExpr)/100);h=parseInt(f.container.height);d=parseInt(f.container.width);this.x=g.evalExpression(this.xExpr)+this.displaceRegionWest;this.y=g.evalExpression(this.yExpr)+this.plecaHeight+this.displaceRegionNorth;this.container&&(this.container.style.left=this.x+"px",this.container.style.top=this.y+"px");0<=this.y?(b=h-this.y,this.h>b&&(this.h=b)):(b=this.h+this.y,this.h=b>=h?h:b);0<=this.x?(m=d-this.x,this.w>m&&(this.w=m)):(m=this.w+this.x,this.w=m>=d?d:m);
""==this.imageSrc&&this.imageSrc.trim().toLowerCase().match(/vacio.gif$/)||(this.image=f.getImage(this.imageSrc));this.OxExpr&&(r=this.OxExpr,"%"===r[r.length-1]?this.Ox=this.w*parseFloat(r)/100:(n=parseFloat(r),n!=r&&(n=0),this.Ox=n));this.OyExpr&&(k=this.OyExpr,"%"===k[k.length-1]?this.Oy=this.h*parseFloat(k)/100:(n=parseFloat(k),n!=k&&(n=0),this.Oy=n));""!==this.id&&2!==f.version?(g.setVariable(e+"._w",this.w),g.setVariable(e+"._h",this.h),g.setVariable(e+".escala",this.scale),g.setVariable(e+
".Ox",this.Ox),g.setVariable(e+".Oy",this.Oy),g.setVariable(e+".mouse_x",0),g.setVariable(e+".mouse_y",0),g.setVariable(e+".mouse_pressed",0),g.setVariable(e+".mouse_clicked",0),g.setVariable(e+".clic_izquierdo",0)):(n=g.getVariable("_w"),void 0===n&&(n=this.w),g.setVariable("_w",n),n=g.getVariable("_h"),void 0===n&&(n=this.h),g.setVariable("_h",n),n=g.getVariable("escala"),void 0===n&&(n=this.scale),g.setVariable("escala",n),n=g.getVariable("Ox"),void 0===n&&(n=this.Ox),g.setVariable("Ox",n),n=g.getVariable("Oy"),
void 0===n&&(n=this.Oy),g.setVariable("Oy",n),g.setVariable("mouse_x",0),g.setVariable("mouse_y",0),g.setVariable("mouse_pressed",0),g.setVariable("mouse_clicked",0),g.setVariable("clic_izquierdo",0),""===this.x_axis&&""===this.y_axis&&2==f.version&&(this.axes=""));this.w_2=this.w/2;this.h_2=this.h/2};a.Space.prototype.addCtr=function(a){"graphic"===a.type?this.graphicsCtr.push(a):this.ctrs.push(a)};a.Space.prototype.addGraph=function(a,b){"R2"==this.type&&b||"R3"==this.type&&!b||(a.background&&"R3"!==
this.type?this.backgroundGraphics.push(a):this.graphics.push(a))};a.Space.prototype.clearClick=function(){this.evaluator.setVariable(this.mclickedString,0);this.evaluator.setVariable(this.mclicizquierdoString,0)};a.Space.prototype.getRelativeX=function(a){return(parseInt(a)-this.w_2-this.Ox)/this.scale};a.Space.prototype.getRelativeY=function(a){return(-parseInt(a)+this.h_2+this.Oy)/this.scale};a.Space.prototype.getAbsoluteX=function(a){return a*this.scale+this.w_2+this.Ox};a.Space.prototype.getAbsoluteY=
function(a){return-a*this.scale+this.h_2+this.Oy};a.Space.prototype.findOffset=function(){s=this.container;this.offsetTop=this.offsetLeft=0;this.container&&this.container.style&&(q=this.container.style.display);this.container.style.display="block";if(s.getBoundingClientRect){var a=s.getBoundingClientRect();this.offsetLeft=a.left;this.offsetTop=a.top}else for(;s;)s.tagName&&"html"!==s.tagName.toLowerCase()?(this.offsetLeft+=s.offsetLeft||0,this.offsetTop+=s.offsetTop||0,s=s.parentNode):s=null;this.container&&
this.container.style&&(this.container.style.display=q)};a.Space.prototype.getCursorPosition=function(b){this.findOffset();u=a.getCursorPosition(b);return{x:u.x-((document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft)+this.offsetLeft),y:u.y-((document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop)+this.offsetTop)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f;a.SpaceExternal=function(a){f=this;f.parent=
a;f.width=228;f.vSpace=25;f.container=document.createElement("div");f.container.setAttribute("style","-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border-style: ridge; border-width: 5px; border-color: gray; box-shadow: #000 0px 0px 25px 5px; overflow-y: scroll; overflow-x: hidden; position: fixed; left: 0px; top: 0px; z-index: 10000; width: "+(f.width+27)+"px; height: 460px; background-color: #63b4fb");f.moveManipulator=document.createElement("div");f.moveManipulator.setAttribute("style",
" position: absolute; left: 0px; top: 0px; width: "+(f.width+27)+"px; height: "+f.vSpace+"px; line-height: "+f.vSpace+"px; background-color: ddd; cursor: move; padding-left: 75px; font-family: Sans-Serif; font-size: 18px;");f.moveManipulator.innerHTML="Descartes";f.container.appendChild(f.moveManipulator);f.ctrs=[]};a.SpaceExternal.prototype.init=function(){function f(b){e.newPosition=a.getCursorPosition(b);e.container.style.left=e.initialPosition.x+(e.newPosition.x-e.oldPosition.x)+"px";e.container.style.top=
e.initialPosition.y+(e.newPosition.y-e.oldPosition.y)+"px"}function c(a){a.preventDefault();e.findOffset();document.body.removeEventListener("mousemove",f);document.body.removeEventListener("mouseup",c)}document.body.appendChild(this.container);var e=this,b=e.parent.evaluator.parser,m;m=0;for(var h=e.ctrs.length;m<h;m++)e.ctrs[m].expresion=b.parse("(0,"+(e.vSpace+23+35*m)+","+e.width+",35)"),e.ctrs[m].update();e.numCtr=h;m="espa\u00f1ol"==e.language?"cr\u00e9ditos":"english"==e.language?"about":"cr\u00e9ditos";
m=new a.Button(e.parent,{region:"external",name:m,font_size:b.parse("15"),expresion:b.parse("(0,"+e.vSpace+","+e.width/2+",25)")});m.actionExec={execute:a.showAbout};m.update();(new a.Button(e.parent,{region:"external",name:"config",font_size:b.parse("15"),action:"config",expresion:b.parse("("+e.width/2+","+e.vSpace+","+e.width/2+",25)")})).update();m="espa\u00f1ol"==e.language?"inicio":"english"==e.language?"init":"inicio";(new a.Button(e.parent,{region:"external",name:m,font_size:b.parse("15"),
action:"init",expresion:b.parse("(0,"+(e.vSpace+23+35*h)+","+e.width/2+",25)")})).update();m="espa\u00f1ol"==e.language?"limpiar":"english"==e.language?"clear":"limpiar";(new a.Button(e.parent,{region:"external",name:m,font_size:b.parse("15"),action:"clear",expresion:b.parse("("+e.width/2+","+(e.vSpace+23+35*h)+","+e.width/2+",25)")})).update();m="espa\u00f1ol"==e.language?"cerrar":"close";b=new a.Button(e.parent,{region:"external",name:m,font_size:b.parse("15"),expresion:b.parse("("+e.width/4+","+
(e.vSpace+46+35*h)+","+e.width/2+",25)")});b.update();b.canvas.addEventListener("click",function(a){e.hide()});e.setPositionAndSize();e.moveManipulator.addEventListener("mousedown",function(b){b.preventDefault();e.oldPosition=a.getCursorPosition(b);e.initialPosition={x:e.container.offsetLeft,y:e.container.offsetTop};document.body.addEventListener("mousemove",f);document.body.addEventListener("mouseup",c)});e.findOffset();e.hide()};a.SpaceExternal.prototype.addCtr=function(a){this.ctrs.push(a)};a.SpaceExternal.prototype.show=
function(){this.setPositionAndSize();this.container.style.display="block"};a.SpaceExternal.prototype.hide=function(){this.container.style.display="none"};a.SpaceExternal.prototype.setPositionAndSize=function(){var a=this.vSpace+46+35*this.numCtr+25+10;this.container.style.left=Math.max(parseInt(window.innerWidth-this.width)/2,0)+"px";this.container.style.top="5px";this.container.style.height=window.innerHeight<this.vSpace+75?this.vSpace+75+"px":a>window.innerHeight-10?window.innerHeight-10:a+"px"};
a.SpaceExternal.prototype.findOffset=function(){tmpContainer=this.container;this.offsetTop=this.offsetLeft=0;this.container&&this.container.style&&(tmpDisplay=this.container.style.display);this.container.style.display="block";if(tmpContainer.getBoundingClientRect){var a=tmpContainer.getBoundingClientRect();this.offsetLeft=a.left;this.offsetTop=a.top}else for(;tmpContainer;)tmpContainer.tagName&&"html"!==tmpContainer.tagName.toLowerCase()?(this.offsetLeft+=tmpContainer.offsetLeft||0,this.offsetTop+=
tmpContainer.offsetTop||0,tmpContainer=tmpContainer.parentNode):tmpContainer=null;this.container&&this.container.style&&(this.container.style.display=tmpDisplay);for(var a=0,c=this.ctrs.length;a<c;a++)this.ctrs[a].findOffset&&this.ctrs[a].findOffset()};return a}(descartesJS||{}),descartesJS=function(a){var f,g;if(a.loadLib)return a;var c=Math.floor,e=Math.round,b=2*Math.PI,m=a.convertFont("SansSerif,PLAIN,12"),h=a.convertFont("Monospaced,PLAIN,12"),d,n,r,k,s,q,u,l,v,p,t,w,A,C,z,B,E,D,y,I,G,H,J,x,
K,F,L,M,N;a.Space2D=function(b,c){a.Space.call(this,b,c);d=this;d._ratio=5E6<d.w*a._ratio*d.h*a._ratio?1:a._ratio;d.backgroundCanvas=document.createElement("canvas");d.backgroundCanvas.setAttribute("id",d.id+"_background");d.backgroundCanvas.width=d.w*d._ratio;d.backgroundCanvas.height=d.h*d._ratio;d.backgroundCanvas.style.width=d.w+"px";d.backgroundCanvas.style.height=d.h+"px";d.backgroundCtx=d.backgroundCanvas.getContext("2d");d.backgroundCtx.imageSmoothingEnabled=!1;d.backgroundCtx.mozImageSmoothingEnabled=
!1;d.backgroundCtx.webkitImageSmoothingEnabled=!1;d.canvas=document.createElement("canvas");d.canvas.setAttribute("id",d.id+"_canvas");d.canvas.width=d.w*d._ratio;d.canvas.height=d.h*d._ratio;d.canvas.setAttribute("class","DescartesSpace2DCanvas");d.canvas.setAttribute("style","z-index: "+d.zIndex+"; width:"+d.w+"px; height:"+d.h+"px;");d.ctx=d.canvas.getContext("2d");d.ctx.imageSmoothingEnabled=!1;d.ctx.mozImageSmoothingEnabled=!1;d.ctx.webkitImageSmoothingEnabled=!1;d.graphicControlContainer=document.createElement("div");
d.graphicControlContainer.setAttribute("id",d.id+"_graphicControls");d.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+d.zIndex+";");d.numericalControlContainer=document.createElement("div");d.numericalControlContainer.setAttribute("id",d.id+"_numericalControls");d.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+d.zIndex+";");d.container=document.createElement("div");d.container.setAttribute("id",
d.id);d.container.setAttribute("class","DescartesSpace2DContainer");d.container.setAttribute("style","left: "+d.x+"px; top: "+d.y+"px; z-index: "+d.zIndex+";");d.parent.arquimedes&&"#f0f8fa"===d.background.getColor()&&(d.container.style.border="1px solid #b8c4c8");d.container.appendChild(d.backgroundCanvas);d.container.appendChild(d.canvas);d.container.appendChild(d.graphicControlContainer);d.container.appendChild(d.numericalControlContainer);b.container.insertBefore(d.container,b.loader);d.parent.images[d.id+
".image"]=d.canvas;d.parent.images[d.id+".image"].ready=1;d.parent.images[d.id+".image"].complete=!0;d.evaluator.setVariable(d.id+".image",d.id+".image");d.parent.images[d.id+".back"]=d.backgroundCanvas;d.parent.images[d.id+".back"].ready=1;d.parent.images[d.id+".back"].complete=!0;d.evaluator.setVariable(d.id+".back",d.id+".back");""!==d.id&&2!==b.version?(d.OxString=d.id+".Ox",d.OyString=d.id+".Oy",d.scaleString=d.id+".escala",d.wString=d.id+"._w",d.hString=d.id+"._h",d.mxString=d.id+".mouse_x",
d.myString=d.id+".mouse_y",d.mpressedString=d.id+".mouse_pressed",d.mclickedString=d.id+".mouse_clicked",d.mclicizquierdoString=d.id+".clic_izquierdo",d.kpressedString=d.id+".key_pressed",d.kvalueString=d.id+".key_value"):(d.OxString="Ox",d.OyString="Oy",d.scaleString="escala",d.wString="_w",d.hString="_h",d.mxString="mouse_x",d.myString="mouse_y",d.mpressedString="mouse_pressed",d.mclickedString="mouse_clicked",d.mclicizquierdoString="clic_izquierdo",d.kpressedString="key_pressed",d.kvalueString=
"key_value");d.click=0;"descartesJS_scenario"!==d.id?d.registerMouseAndTouchEvents():d.canvas.oncontextmenu=function(a){return!1}};a.extend(a.Space2D,a.Space);a.Space2D.prototype.init=function(){d=this;d.uber.init.call(d);d.canvas&&(d.backgroundCanvas.width=d.w*d._ratio,d.backgroundCanvas.height=d.h*d._ratio,d.backgroundCanvas.style.width=d.w+"px",d.backgroundCanvas.style.height=d.h+"px",d.canvas.width=d.w*d._ratio,d.canvas.height=d.h*d._ratio,d.canvas.style.width=d.w+"px",d.canvas.style.height=d.h+
"px");d.container&&d.findOffset()};a.Space2D.prototype.update=function(a){d=this;n=d.evaluator;r=d.parent;n.setVariable(d.wString,d.w);n.setVariable(d.hString,d.h);d.drawIfValue=0<n.evalExpression(d.drawif);if(d.drawIfValue){s=d.x!==n.evalExpression(d.xExpr)+d.displaceRegionWest;q=d.y!==n.evalExpression(d.yExpr)+r.plecaHeight+d.displaceRegionNorth;d.spaceChange=a||s||q||d.drawBefore!==d.drawIfValue||d.Ox!==n.getVariable(d.OxString)||d.Oy!==n.getVariable(d.OyString)||d.scale!==n.getVariable(d.scaleString)||
d.backColor!==d.background.getColor();d.x=s?n.evalExpression(d.xExpr)+d.displaceRegionWest:d.x;d.y=q?n.evalExpression(d.yExpr)+r.plecaHeight+d.displaceRegionNorth:d.y;d.Ox=n.getVariable(d.OxString);d.Oy=n.getVariable(d.OyString);d.scale=n.getVariable(d.scaleString);d.drawBefore=d.drawIfValue;1E-6>d.scale?(d.scale=1E-6,n.setVariable(d.scaleString,1E-6)):1E6<d.scale&&(d.scale=1E6,n.setVariable(d.scaleString,1E6));if(s||q)d.container.style.left=d.x+"px",d.container.style.top=d.y+"px",d.findOffset();
d.container.style.display="block";d.drawTrace=!d.spaceChange&&(!d.fixed&&!d.click||d.fixed);d.spaceChange&&(d.backgroundCtx.setTransform(d._ratio,0,0,d._ratio,0,0),d.drawBackground(),d.backgroundCtx.setTransform(1,0,0,1,0,0));d.ctx.setTransform(d._ratio,0,0,d._ratio,0,0);d.draw();d.ctx.setTransform(1,0,0,1,0,0)}else d.container.style.display="none"};a.Space2D.prototype.drawBackground=function(){n=this.evaluator;k=this.backgroundCtx;k.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);
this.backColor=this.background.getColor();k.fillStyle=this.backColor;k.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.image&&""!=this.image.src&&this.image.ready&&this.image.complete&&("topleft"===this.bg_display?k.drawImage(this.image,0,0):"stretch"===this.bg_display?k.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?(k.fillStyle=k.createPattern(this.image,"repeat"),k.fillRect(0,0,this.canvas.width,this.canvas.height)):"imgcenter"===this.bg_display&&
k.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));l=this.scale;v=0;for(p=0>this.w+this.h?0:this.w+this.h;l>p;)l/=10,v++;for(;l<p/10;)l*=10;k.lineWidth=1;""!==this.net&&(k.strokeStyle=this.net.getColor(),this.drawMarks(k,l/10,-1));if(2!==this.parent.version&&""!==this.net10||2===this.parent.version&&""!==this.net&&""!==this.net10)k.strokeStyle=this.net10.getColor(),this.drawMarks(k,l,-1);if(""!==this.axes){k.strokeStyle=this.axes.getColor();k.beginPath();if(""!==this.x_axis||
2!==this.parent.version)k.moveTo(0,c(this.h/2+this.Oy)+.5),k.lineTo(this.w,c(this.h/2+this.Oy)+.5);if(""!==this.y_axis||2!==this.parent.version)k.moveTo(c(this.w/2+this.Ox)+.5,0),k.lineTo(c(this.w/2+this.Ox)+.5,this.h);k.stroke();this.drawMarks(k,l,4);this.drawMarks(k,l/2,2);this.drawMarks(k,l/10,1)}if(""!==this.x_axis||""!==this.y_axis)k.fillStyle=""!==this.axes?this.axes.getColor():"black",k.font=m,k.textAlign="right",k.textBaseline="alphabetic",k.fillText(this.x_axis,c(this.w)-2,c(this.h/2+this.Oy)+
12),k.fillText(this.y_axis,c(this.w/2+this.Ox)-2,12);this.numbers&&""!=this.axes&&(k.fillStyle=this.axes.getColor(),k.font=m,k.textAlign="start",k.textBaseline="bottom",l>(this.w+this.h)/2?this.drawNumbers(k,l/5,l<=this.scale?v+1:v):l>(this.w+this.h)/4?this.drawNumbers(k,l/2,l<=this.scale?v+1:v):this.drawNumbers(k,l,v));for(var a=0,b=this.backgroundGraphics.length;a<b;a++)this.backgroundGraphics[a].draw()};a.Space2D.prototype.draw=function(){k=this.ctx;k.clearRect(0,0,this.canvas.width,this.canvas.height);
for(var a=0,d=this.graphics.length;a<d;a++)u=this.graphics[a],""!==u.trace&&this.drawTrace&&u.drawTrace(),u.draw();a=0;for(d=this.graphicsCtr.length;a<d;a++)this.graphicsCtr[a].draw();""!=this.text&&this.click&&"L"===this.whichButton&&(k.fillStyle=this.text.getColor(),k.strokeStyle=k.fillStyle,k.lineWidth=1,k.font=h,k.textAlign="center",k.textBaseline="alphabetic",G=1>=this.scale?this.mouse_x.toFixed(0):this.mouse_x.toFixed(this.scale.toString().length),H=1>=this.scale?this.mouse_y.toFixed(0):this.mouse_y.toFixed(this.scale.toString().length),
J="("+G+","+H+")",x=c(k.measureText(J).width/2),K=this.getAbsoluteX(this.mouse_x),F=this.getAbsoluteY(this.mouse_y),L=c(K),M=c(F-10),L+x>this.w?L=this.w-x:0>L-x&&(L=x),M+1>this.h?M=this.h:0>M-14&&(M=15),k.fillText(J,L,M),k.beginPath(),k.arc(K,F,2.5,0,b,!0),k.stroke())};a.Space2D.prototype.drawMarks=function(a,b,d){t=this.w;w=this.h;E=0;D=t;y=0;I=w;z=c(t/2+this.Ox);B=c(w/2+this.Oy);0<=d&&(E=z-d,D=z+d,y=B-d,I=B+d);a.beginPath();for(d=-e(z/b);(A=z+e(d*b))<t;d++)a.moveTo(A+.5,y+.5),a.lineTo(A+.5,I+.5);
for(d=-e(B/b);(C=B+e(d*b))<w;d++)a.moveTo(E+.5,C+.5),a.lineTo(D+.5,C+.5);a.stroke()};a.Space2D.prototype.drawNumbers=function(a,b,d){t=this.w;w=this.h;z=c(t/2+this.Ox);B=c(w/2+this.Oy);for(d=-e(z/b);(A=z+e(d*b))<t;d++)a.fillText(parseFloat((d*b/this.scale).toFixed(4)),A+1,B-2);for(d=-e(B/b);(C=B+e(d*b))<w;d++)0!==parseFloat(-d*b/this.scale)&&a.fillText(parseFloat((-d*b/this.scale).toFixed(4)),z+5,C+5)};a.Space2D.prototype.registerMouseAndTouchEvents=function(){function b(a){document.body.focus();
if(n.evaluator.variables[n.id+".DESCARTESJS_no_fixed"]||!n.fixed||n.sensitive_to_mouse_movements)n.parent.clearClick(),n.click=1,n.evaluator.setVariable(n.mpressedString,1),n.evaluator.setVariable(n.mclickedString,0),n.evaluator.setVariable(n.mclicizquierdoString,0),n.parent.deactivateGraphiControls(),m(a),window.addEventListener("touchmove",l),window.addEventListener("touchend",d),a.stopPropagation(),a.preventDefault()}function d(a){document.body.focus();if(n.evaluator.variables[n.id+".DESCARTESJS_no_fixed"]||
!n.fixed||n.sensitive_to_mouse_movements)n.click=0,n.evaluator.setVariable(n.mpressedString,0),n.evaluator.setVariable(n.mclickedString,1),n.evaluator.setVariable(n.mclicizquierdoString,1),window.removeEventListener("touchmove",l),window.removeEventListener("touchend",d),a.stopPropagation(),a.preventDefault(),n.parent.update()}function e(b){document.body.focus();b.stopPropagation();b.preventDefault();n.parent.clearClick();n.click=1;n.parent.deactivateGraphiControls();n.whichButton=a.whichButton(b);
"R"===n.whichButton?(window.addEventListener("mouseup",h),n.clickPosForZoom=n.getCursorPosition(b).y,n.clickPosForZoomNew=n.clickPosForZoom,n.fixed||(n.tempScale=n.scale,window.addEventListener("mousemove",k))):"L"===n.whichButton&&(n.evaluator.setVariable(n.mpressedString,1),n.evaluator.setVariable(n.mclickedString,0),n.evaluator.setVariable(n.mclicizquierdoString,0),m(b),window.addEventListener("mousemove",l),window.addEventListener("mouseup",h))}function h(a){document.body.focus();a.stopPropagation();
a.preventDefault();n.click=0;n.evaluator.setVariable(n.mpressedString,0);n.evaluator.setVariable(n.mclickedString,1);n.evaluator.setVariable(n.mclicizquierdoString,1);"R"===n.whichButton&&(window.removeEventListener("mousemove",k),n.clickPosForZoom==n.clickPosForZoomNew&&n.parent.externalSpace.show());window.removeEventListener("mousemove",l);window.removeEventListener("mouseup",h);n.parent.deactivateGraphiControls();n.parent.update()}function m(a){n.posAnte=n.getCursorPosition(a);n.mouse_x=n.getRelativeX(n.posAnte.x);
n.mouse_y=n.getRelativeY(n.posAnte.y);n.evaluator.setVariable(n.mxString,n.mouse_x);n.evaluator.setVariable(n.myString,n.mouse_y);n.parent.update()}function k(a){a.preventDefault();n.clickPosForZoomNew=n.getCursorPosition(a).y;n.evaluator.setVariable(n.scaleString,n.tempScale+n.tempScale/45*((n.clickPosForZoom-n.clickPosForZoomNew)/10));n.parent.update()}function l(a){a.preventDefault();a.stopPropagation();n.fixed||(n.posNext=n.getCursorPosition(a),f=c(n.posAnte.x-n.posNext.x),g=c(n.posAnte.y-n.posNext.y),
n.evaluator.setVariable(n.OxString,n.Ox-f),n.evaluator.setVariable(n.OyString,n.Oy-g),n.posAnte.x-=f,n.posAnte.y-=g);m(a)}var n=this;N=a.hasTouchSupport;n.clickPosForZoom=null;n.clickPosForZoomNew=null;n.canvas.oncontextmenu=function(a){return!1};N&&(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("touchmove",m),this.canvas.addEventListener("touchstart",b));N||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",m),this.canvas.addEventListener("mousedown",e));
window.addEventListener("blur",function(a){h(a)});document.addEventListener("visibilitychange",function(a){h(a)})};return a}(descartesJS||{}),descartesJS=function(a){var f,g,c;function e(a,b){return b.depth-a.depth}function b(b,c){Z=a.subtract3D(b,a.scalarProduct3D(c,a.dotProduct3D(b,c)));W=a.add3D(b,a.scalarProduct3D(Z,-2));X=a.norm3D(W);return 0!==X?a.scalarProduct3D(W,1/X):a.scalarProduct3D(b,-1)}if(a.loadLib)return a;var m=Math.floor,h=Math.round,d=Math.max,n=Math.cos,r=Math.sin,k=Math.sqrt,s=
15*Math.PI/180,q=Math.cos(s),u=Math.sin(s),l,v,p,t,w,A,C,z,B,E,D,y,I,G,H,J,x,K,F,L,M,N,R,S=[],P,Q,O,V,U,Y,Z,W,X;a.Space3D=function(b,c){a.Space.call(this,b,c);p=this;p.backgroundCanvas=document.createElement("canvas");p.backgroundCanvas.setAttribute("id",p.id+"_background");p.backgroundCanvas.setAttribute("width",p.w+"px");p.backgroundCanvas.setAttribute("height",p.h+"px");p.canvas=document.createElement("canvas");p.canvas.setAttribute("id",p.id+"_canvas");p.canvas.setAttribute("width",p.w+"px");
p.canvas.setAttribute("height",p.h+"px");p.canvas.setAttribute("class","DescartesSpace3DCanvas");p.canvas.setAttribute("style","z-index: "+p.zIndex+";");p.ctx=p.canvas.getContext("2d");p.ctx.imageSmoothingEnabled=!1;p.ctx.mozImageSmoothingEnabled=!1;p.ctx.webkitImageSmoothingEnabled=!1;p.graphicControlContainer=document.createElement("div");p.graphicControlContainer.setAttribute("id",p.id+"_graphicControls");p.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+
p.zIndex+";");p.numericalControlContainer=document.createElement("div");p.numericalControlContainer.setAttribute("id",p.id+"_numericalControls");p.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+p.zIndex+";");p.container=document.createElement("div");p.container.setAttribute("id",p.id);p.container.setAttribute("class","DescartesSpace3DContainer");p.container.setAttribute("style","left: "+p.x+"px; top: "+p.y+"px; z-index: "+p.zIndex+";");p.container.appendChild(p.backgroundCanvas);
p.container.appendChild(p.canvas);p.container.appendChild(p.graphicControlContainer);p.container.appendChild(p.numericalControlContainer);b.container.insertBefore(p.container,b.loader);p.eye={x:0,y:0,z:0};p.lights=[{x:50,y:50,z:70},{x:50,y:-50,z:30},{x:20,y:0,z:-80},{x:0,y:0,z:0}];for(var d=0,e=p.lights.length;d<e;d++)p.lights[d]=a.normalize3D(p.lights[d]);p.light3={x:0,y:0,z:0};p.intensity=[.4,.5,.3,0];p.userIntensity=0;p.dim=1;p.tmpIntensity=[];p.OxStr=p.id+".Ox";p.OyStr=p.id+".Oy";p.scaleStr=p.id+
".escala";p.wStr=p.id+"._w";p.hStr=p.id+"._h";p.obsStr=p.id+".observador";p.rotZStr=p.id+".rot.z";p.rotYStr=p.id+".rot.y";p.userI_Dim_Str=p.id+".userIlum.dim";p.userI_I_Str=p.id+".userIlum.I";p.userI_x_Str=p.id+".userIlum.x";p.userI_y_Str=p.id+".userIlum.y";p.userI_z_Str=p.id+".userIlum.z";p.evaluator.setVariable(p.rotZStr,0);p.evaluator.setVariable(p.rotYStr,0);p.evaluator.setVariable(p.userI_Dim_Str,p.dim);p.evaluator.setVariable(p.userI_I_Str,p.userIntensity);p.evaluator.setVariable(p.userI_x_Str,
0);p.evaluator.setVariable(p.userI_y_Str,0);p.evaluator.setVariable(p.userI_z_Str,0);p.registerMouseAndTouchEvents()};a.extend(a.Space3D,a.Space);a.Space3D.prototype.init=function(a){p=this;p.uber.init.call(p);p.canvas&&(p.canvas.setAttribute("width",p.w+"px"),p.canvas.setAttribute("height",p.h+"px"));p.container&&p.findOffset();p.w_2=p.w/2;p.h_2=p.h/2;p.oldMouse={x:0,y:0}};a.Space3D.prototype.update=function(a){p=this;l=p.evaluator;v=p.parent;l.setVariable(p.wStr,p.w);l.setVariable(p.hStr,p.h);p.drawIfValue=
0<l.evalExpression(p.drawif);if(p.drawIfValue){B=p.x!==l.evalExpression(p.xExpr)+p.displaceRegionWest;E=p.y!==l.evalExpression(p.yExpr)+v.plecaHeight+p.displaceRegionNorth;p.spaceChange=a||B||E||p.drawBefore!==p.drawIfValue||p.Ox!==l.getVariable(p.OxStr)||p.Oy!==l.getVariable(p.OyStr)||p.scale!==l.getVariable(p.scaleStr);p.x=B?l.evalExpression(p.xExpr)+p.displaceRegionWest:p.x;p.y=E?l.evalExpression(p.yExpr)+v.plecaHeight+p.displaceRegionNorth:p.y;p.Ox=l.getVariable(p.OxStr);p.Oy=l.getVariable(p.OyStr);
p.scale=l.getVariable(p.scaleStr);p.drawBefore=p.drawIfValue;if(a||void 0==p.observer){var b;a=0;for(var c=p.parent.controls.length;a<c;a++)p.parent.controls[a].id===p.obsStr&&(b=!0);p.observer=b?l.getVariable(p.obsStr)||.5*(p.w+p.h):2.5*(p.w+p.h);p.observer=d(p.observer,.1*(p.w+p.h));l.setVariable(p.obsStr,p.observer);p.eye={x:p.observer/p.scale*q,y:0,z:p.observer/p.scale*u};p.D=p.scale*p.eye.x/q;p.XE=h(p.scale*p.eye.y+.5);p.YE=h(p.scale*p.eye.z+.5)}p.observer=d(l.getVariable(p.obsStr),.1*(p.w+p.h));
l.setVariable(p.obsStr,p.observer);1E-6>p.scale?(p.scale=1E-6,l.setVariable(p.scaleStr,1E-6)):1E6<p.scale&&(p.scale=1E6,l.setVariable(p.scaleStr,1E6));if(B||E)p.container.style.left=p.x+"px",p.container.style.top=p.y+"px",p.findOffset();p.container.style.display="block";p.dim=l.getVariable(p.userI_Dim_Str);p.userIntensity=l.getVariable(p.userI_I_Str);p.light3={x:parseInt(l.getVariable(p.userI_x_Str)),y:parseInt(l.getVariable(p.userI_y_Str)),z:parseInt(l.getVariable(p.userI_z_Str))};p.updateCamera();
p.draw()}else p.container.style.display="none"};a.Space3D.prototype.draw=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.background.getColor();this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.image&&""!=this.image.src&&this.image.ready&&this.image.complete&&("topleft"===this.bg_display?this.ctx.drawImage(this.image,0,0):"stretch"===this.bg_display?this.ctx.drawImage(this.image,0,0,this.w,this.h):"patch"===this.bg_display?(this.ctx.fillStyle=
ctx.createPattern(this.image,"repeat"),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)):"center"===this.bg_display&&this.ctx.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));for(var a=0,b=this.graphics.length;a<b;a++)this.graphics[a].update();this.primitives=[];a=0;for(b=this.graphics.length;a<b;a++){t=this.graphics[a];if(t.split||this.split)for(var c=a+1;c<b;c++)w=this.graphics[c],(w.split||this.split)&&t.splitFace(w);this.primitives=this.primitives.concat(t.primitives||
[])}A=this.primitives;C=A.length;for(a=0;a<C;a++)A[a].computeDepth(this);if("painter"===this.render)this.drawPainter(A);else for(A=A.sort(e),a=0;a<C;a++)A[a].draw(this.ctx,this);a=0;for(b=this.graphicsCtr.length;a<b;a++)this.graphicsCtr[a].draw()};var T;a.renderNode=function(a){this.value=a;this.front=this.back=null};a.renderNode.prototype.inOrder=function(){var a=[];this.back&&(a=a.concat(this.back.inOrder()));a.push(this.value);this.front&&(a=a.concat(this.front.inOrder()));return a};a.Space3D.prototype.buildTree=
function(b){if(0===b.length)return null;var c,d=[],e=[];T=b.shift();for(var f=0,h=b.length;f<h;f++){c=null;for(var g=0,m=b[f].spaceVertices.length;g<m;g++)whereIs=2<T.spaceVertices.length?this.inPlane2(T.spaceVertices[0],T.normal,b[f].spaceVertices[g]):0,whereIs=0<T.direction?-whereIs:whereIs,null===c?0>whereIs?c="front":0<whereIs&&(c="back"):0>whereIs?"back"===c&&(c="cross"):0<whereIs&&"front"===c&&(c="cross");if("back"===c)d.push(b[f]);else if("front"===c)e.push(b[f]);else if(null==c)d.push(b[f]);
else{c=null;g=0;for(m=T.spaceVertices.length;g<m;g++)whereIs=2<b[f].spaceVertices.length?this.inPlane2(b[f].spaceVertices[0],b[f].normal,T.spaceVertices[g]):-1,whereIs=0<b[f].direction?-whereIs:whereIs,null===c?0>whereIs?c="front":0<whereIs&&(c="back"):0>whereIs?"back"===c&&(c="cross"):0<whereIs&&"front"===c&&(c="cross");"front"===c?d.push(b[f]):e.push(b[f])}}b=new a.renderNode(T);b.back=this.buildTree(d);b.front=this.buildTree(e);return b};a.Space3D.prototype.drawPainter=function(a){if(a=this.buildTree(a)){a=
a.inOrder();for(var b=0;b<a.length;b++)a[b].draw(this.ctx,this)}};a.Space3D.prototype.inPlane=function(a,b,c,d){return parseFloat(((d.x-a.x)*(b.y-a.y)*(c.z-a.z)+(d.y-a.y)*(b.z-a.z)*(c.x-a.x)+(d.z-a.z)*(b.x-a.x)*(c.y-a.y)-(d.z-a.z)*(b.y-a.y)*(c.x-a.x)-(d.y-a.y)*(b.x-a.x)*(c.z-a.z)-(d.x-a.x)*(b.z-a.z)*(c.y-a.y)).toFixed(8))};a.Space3D.prototype.inPlane2=function(a,b,c){return parseFloat((b.x*(c.x-a.x)+b.y*(c.y-a.y)+b.z*(c.z-a.z)).originalToFixed(8))};a.Space3D.prototype.updateCamera=function(){p=this;
p.D=p.observer;p.eye.x=p.D/p.scale;p.eye.y=p.XE/p.scale;p.eye.z=p.YE/p.scale};a.Space3D.prototype.rotateVertex=function(b){x=a.degToRad(p.evaluator.getVariable(p.rotZStr));K=n(x);F=r(x);f=b.x*K-b.y*F;g=b.x*F+b.y*K;c=b.z;x=a.degToRad(p.evaluator.getVariable(p.rotYStr));K=n(x);F=r(x);return{x:c*F+f*K,y:g,z:c*K-f*F}};a.Space3D.prototype.project=function(a){p=this;I=p.eye.x-a.x;G=p.eye.y-a.y;H=p.eye.z-a.z;var b=k(I*I+G*G+H*H);J=-a.x/b||0;I=this.w_2+this.Ox+p.scale*(a.y+J*(p.eye.y-a.y));G=this.h_2+this.Oy-
p.scale*(a.z+J*(p.eye.z-a.z));return{x:I,y:G,z:b}};a.Space3D.prototype.computeColor=function(c,d,e){c.match("rgba")?c=a.RGBAToHexColor(c):c.match("#")&&(c=new a.Color(c.substring(1)));V=a.subtract3D(this.eye,d.average);U=a.norm3D(V);Y=a.scalarProduct3D(V,1/U);this.lights[3]=a.subtract3D(this.light3,d.average);R=a.norm3D(this.lights[3]);for(var f=0,h=this.intensity.length-1;f<h;f++)S[f]=this.intensity[f]*this.dim;S[3]=this.userIntensity*this.userIntensity/R||0;P=e?this.dim/2:this.dim/4;Q=0;O=0<=d.direction?
d.normal:a.scalarProduct3D(d.normal,-1);f=0;for(h=this.lights.length;f<h;f++)e?(Q=Math.max(0,a.dotProduct3D(b(this.lights[f],O),Y)),Q*=Q*Q):Q=Math.max(0,a.dotProduct3D(this.lights[f],O)),P+=S[f]*Q;P=Math.min(P,1);L=m(c.r*P);M=m(c.g*P);N=m(c.b*P);return"rgba("+L+","+M+","+N+","+c.a+")"};a.Space3D.prototype.registerMouseAndTouchEvents=function(){function b(a){document.body.focus();k.click=1;k.evaluator.setVariable(k.id+".mouse_pressed",1);k.parent.deactivateGraphiControls();k.posAnte=k.getCursorPosition(a);
k.oldMouse.x=k.getRelativeX(k.posAnte.x);k.oldMouse.y=k.getRelativeY(k.posAnte.y);f(a);window.addEventListener("touchmove",m);window.addEventListener("touchend",c);a.preventDefault()}function c(a){document.body.focus();k.click=0;k.evaluator.setVariable(k.id+".mouse_pressed",0);window.removeEventListener("touchmove",m,!1);window.removeEventListener("touchend",c,!1);a.preventDefault()}function d(b){document.body.focus();k.click=1;k.parent.deactivateGraphiControls();k.whichButton=a.whichButton(b);"R"===
k.whichButton?(window.addEventListener("mouseup",e),k.clickPosForZoom=k.getCursorPosition(b).y,k.clickPosForZoomNew=k.clickPosForZoom,k.fixed||(k.tempScale=k.scale,window.addEventListener("mousemove",g))):"L"==k.whichButton&&(k.evaluator.setVariable(k.id+".mouse_pressed",1),k.posAnte=k.getCursorPosition(b),k.oldMouse.x=k.getRelativeX(k.posAnte.x),k.oldMouse.y=k.getRelativeY(k.posAnte.y),f(b),window.addEventListener("mousemove",m),window.addEventListener("mouseup",e));b.preventDefault()}function e(a){document.body.focus();
k.click=0;k.evaluator.setVariable(k.id+".mouse_pressed",0);a.preventDefault();"R"===k.whichButton&&(window.removeEventListener("mousemove",g,!1),k.clickPosForZoom==k.clickPosForZoomNew&&k.parent.externalSpace.show());window.removeEventListener("mousemove",m,!1);window.removeEventListener("mouseup",e,!1)}function f(a){k.posAnte=k.getCursorPosition(a);k.mouse_x=k.getRelativeX(k.posAnte.x);k.mouse_y=k.getRelativeY(k.posAnte.y);k.evaluator.setVariable(k.id+".mouse_x",k.mouse_x);k.evaluator.setVariable(k.id+
".mouse_y",k.mouse_y);70<Date.now()-n&&(k.parent.update(),n=Date.now())}function g(a){a.preventDefault();k.clickPosForZoomNew=k.getCursorPosition(a).y;k.evaluator.setVariable(k.scaleStr,k.tempScale+k.tempScale/45*((k.clickPosForZoom-k.clickPosForZoomNew)/10));k.parent.update()}function m(b){if(!k.fixed&&k.click){D=parseInt(50*(k.oldMouse.x-k.mouse_x));y=parseInt(50*(k.oldMouse.y-k.mouse_y));if(D!==k.disp.x||y!==k.disp.y)k.alpha=a.degToRad(k.evaluator.getVariable(k.rotZStr)),k.beta=a.degToRad(-k.evaluator.getVariable(k.rotYStr)),
k.alpha=h(a.radToDeg(k.alpha)-D),k.beta=h(a.radToDeg(k.beta)-y),k.evaluator.setVariable(k.rotZStr,k.alpha),k.evaluator.setVariable(k.rotYStr,-k.beta),k.disp.x=D,k.disp.y=y,k.oldMouse.x=k.getRelativeX(k.posAnte.x),k.oldMouse.y=k.getRelativeY(k.posAnte.y);f(b);b.preventDefault()}}var k=this,n=0;z=a.hasTouchSupport;this.canvas.oncontextmenu=function(){return!1};z&&this.canvas.addEventListener("touchstart",b);z||this.canvas.addEventListener("mousedown",d);this.disp={x:0,y:0}};return a}(descartesJS||{}),
descartesJS=function(a){if(a.loadLib)return a;var f;a.SpaceAP=function(g,c){a.Space.call(this,g,c);this.exportarVars=this.importarVars=null;f=g.evaluator;this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=f.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=f.parser.parse(this.file):this.file=f.parser.parse("'"+this.file+"'");this.oldFile=f.evalExpression(this.file);this.initFile()};a.extend(a.SpaceAP,a.Space);a.SpaceAP.prototype.initFile=
function(){this.firstUpdate=!0;var f;if(this.oldFile){var c=document.getElementById(this.oldFile);f=c&&"descartes/spaceApFile"==c.type?c.text:a.openExternalFile(this.oldFile);null!=f&&(f=f.split("\n"))}if(f&&f.toString().match(/<applet/gi)){for(var c="",e=!1,b=0,m=f.length;b<m&&(f[b].match("<applet")&&(e=!0),e&&(c+=f[b]),!f[b].match("</applet"));b++);b=document.createElement("div");b.innerHTML=c;b.firstChild.setAttribute("width",this.w);b.firstChild.setAttribute("height",this.h);c=this.descApp?this.descApp.container:
null;this.descApp=new a.DescartesApp(b.firstChild);this.descApp.container.setAttribute("class","DescartesAppContainer");this.descApp.container.setAttribute("style","position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");c?this.parent.container.replaceChild(this.descApp.container,c):this.parent.container.insertBefore(this.descApp.container,this.parent.loader);c=this.descApp.spaces;
b=0;for(m=c.length;b<m;b++)c[b].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none";var h=this;this.descApp.update=function(){this.updateAuxiliaries();this.updateEvents();this.updateControls();this.updateSpaces();h.exportar()}}else c=this.descApp?this.descApp.container:null,this.descApp={},this.descApp.container=document.createElement("div"),this.descApp.container.setAttribute("class","DescartesAppContainer"),b="position: absolute; overflow: hidden; background-color: "+
this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";",this.image&&("topleft"==this.bg_display?b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat;":"stretch"==this.bg_display?b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-size: 100% 100%;":"patch"==this.bg_display?b+="background-image: url("+this.imageSrc+");":"imgcenter"==this.bg_display&&(b+="background-image: url("+
this.imageSrc+"); background-repeat:no-repeat; background-position: center center;")),this.descApp.container.setAttribute("style",b),c?this.parent.container.replaceChild(this.descApp.container,c):this.parent.container.insertBefore(this.descApp.container,this.parent.loader),this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?"block":"none"};a.SpaceAP.prototype.update=function(){var a=this.evaluator.evalExpression(this.file);if(this.oldFile!=a)this.oldFile=a,this.initFile();
else{var a=this.x!=this.evaluator.evalExpression(this.xExpr),c=this.y!=this.evaluator.evalExpression(this.yExpr)+this.plecaHeight;this.x=a?this.evaluator.evalExpression(this.xExpr):this.x;this.y=c?this.evaluator.evalExpression(this.yExpr)+this.plecaHeight:this.y;a&&(this.descApp.container.style.left=this.x+"px");c&&(this.descApp.container.style.top=this.y+"px");if(a||c)for(var a=this.descApp.spaces,c=0,e=a.length;c<e;c++)a[c].findOffset();this.descApp.container.style.display=0<this.evaluator.evalExpression(this.drawif)?
"block":"none";if(this.firstUpdate&&(this.firstUpdate=!1,null==this.importarVars)){this.importarVars=[];for(var b in this.evaluator.variables)this.evaluator.variables.hasOwnProperty(b)&&b.match(/^public./)&&this.importarVars.push({varName:b,value:this.evaluator.getVariable(b)})}this.importar()}};a.SpaceAP.prototype.importar=function(){for(var a,c=!1,e=0,b=this.importarVars.length;e<b;e++)a=this.evaluator.getVariable(this.importarVars[e].varName),a!=this.importarVars[e].value&&(this.importarVars[e].value=
a,this.descApp.evaluator.setVariable(this.importarVars[e].varName,this.importarVars[e].value),c=!0);c&&this.descApp.update()};a.SpaceAP.prototype.exportar=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f,g,c,e,b;a.SpaceHTML_IFrame=function(b,c){a.Space.call(this,b,c);var d=this.parent.evaluator;if(void 0!=this._w_){var e=d.parser.parse(this._w_);this._w_="number"!=e.type?e:void 0}void 0!=this._h_&&(e=d.parser.parse(this._h_),this._h_="number"!=e.type?e:void 0);
this.file=this.file?this.file.trim():"";this.file.match(/^\[/)&&this.file.match(/\]$/)?this.file=d.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?this.file=d.parser.parse(this.file):this.file=d.parser.parse("'"+this.file+"'");this.oldFile=d.evalExpression(this.file);this.MyIFrame=document.createElement("iframe");0!=this.oldFile&&this.MyIFrame.setAttribute("src",this.oldFile);this.MyIFrame.setAttribute("marginheight",0);this.MyIFrame.setAttribute("marginwidth",
0);this.MyIFrame.setAttribute("frameborder",0);this.MyIFrame.setAttribute("scrolling","auto");this.MyIFrame.setAttribute("style","position: static; left: 0px; top: 0px;");this.container=document.createElement("div");this.container.setAttribute("id",this.id);this.container.setAttribute("style",(a.isIOS?"overflow: scroll; -webkit-overflow-scrolling: touch; overflow-scrolling: touch; ":"")+"position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+
this.zIndex+";");this.container.appendChild(this.MyIFrame);this.parent.container.insertBefore(this.container,this.parent.loader);var f=this;this.MyIFrame.onload=function(a){var b=this;f.evaluator.setFunction(f.id+".set",function(a,c){b.contentWindow.postMessage({type:"set",name:a,value:c},"*");return 0});f.evaluator.setFunction(f.id+".update",function(){b.contentWindow.postMessage({type:"update"},"*");return 0});f.evaluator.setFunction(f.id+".exec",function(a,c){b.contentWindow.postMessage({type:"exec",
name:a,value:c},"*");return 0})};this.update=this.iframeUpdate;this.evaluator.setVariable(this.id+"._scroll",0)};a.extend(a.SpaceHTML_IFrame,a.Space);a.SpaceHTML_IFrame.prototype.init=function(){b=this;b.uber.init.call(b);b.MyIFrame&&(b.MyIFrame.style.width=b.w+"px",b.MyIFrame.style.height=b.h+"px",b.MyIFrame.style.left=b.x+"px",b.MyIFrame.style.top=b.y+"px")};a.SpaceHTML_IFrame.prototype.iframeUpdate=function(a){f=this.evaluator;this.drawIfValue=0<f.evalExpression(this.drawif);this.container.style.visibility=
this.drawIfValue?"visible":"hidden";this.container.style.opacity=this.drawIfValue?"1":"0";this.container.style.zIndex=this.drawIfValue?this.zIndex:-1E3;if(this.drawIfValue){a&&(this.y=this.x=Infinity);g=this.x!==f.evalExpression(this.xExpr)+this.displaceRegionWest;c=this.y!==f.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;this.x=g?f.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=c?f.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:
this.y;void 0!=this._w_&&(a=f.evalExpression(this._w_),this.w!==a&&(this.container.style.width=a+"px",this.MyIFrame.style.width=a+"px",this.w=a));void 0!=this._h_&&(a=f.evalExpression(this._h_),this.h!==a&&(this.container.style.height=a+"px",this.MyIFrame.style.height=a+"px",this.h=a));if(g||c)this.container.style.left=this.x+"px",this.container.style.top=this.y+"px";e=f.evalExpression(this.file);e!==this.oldFile&&(this.oldFile=e,this.MyIFrame.setAttribute("src",e));this.scrollVar=f.getVariable(this.id+
"._scroll");1==this.scrollVar?(this.MyIFrame.setAttribute("scrolling","yes"),this.MyIFrame.style.overflow=""):-1==this.scrollVar?(this.MyIFrame.setAttribute("scrolling","no"),this.MyIFrame.style.overflow="hidden"):(this.MyIFrame.setAttribute("scrolling","auto"),this.MyIFrame.style.overflow="")}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var f;a.DescartesLoader=function(a){this.children=a.children;this.lessonParser=a.lessonParser;this.images=a.images;this.images.length=
a.images.length;this.audios=a.audios;this.audios.length=a.audios.length;this.arquimedes=a.arquimedes;this.descartesApp=a;var c=a.image_loader?a.image_loader:e(a.loader.width,a.loader.height);this.imageLoader=document.createElement("div");this.imageLoader.width=a.width;this.imageLoader.height=a.height;this.imageLoader.setAttribute("class","DescartesLoaderImage");this.imageLoader.setAttribute("style","background-image: url("+c+"); background-size:cover; width: "+a.width+"px; height: "+a.height+"px;");
a.loader.appendChild(this.imageLoader);this.loaderBar=document.createElement("canvas");this.loaderBar.width=a.width;this.loaderBar.height=a.height;this.loaderBar.setAttribute("class","DescartesLoaderBar");this.loaderBar.setAttribute("style","width: "+a.width+"px; height:"+a.height+"px;");this.loaderBar.ctx=this.loaderBar.getContext("2d");a.loader.appendChild(this.loaderBar);this.barWidth=80;this.barHeight=Math.floor(a.loader.height/70);var f=this;this.timer=setInterval(function(){f.drawLoaderBar(f.loaderBar.ctx,
a.width,a.height)},10);a.firstRun=!1;this.initPreloader()};a.DescartesLoader.prototype.initPreloader=function(){var b=this.children,c=this.images,e=this.audios,d=/[\w\.\-//]*(\.png|\.jpg|\.gif|\.svg)/gi,f=/[\w\.\-//]*(\.ogg|\.oga|\.mp3|\.wav)/gi;this.arquimedes&&(c["lib/DescartesCCLicense.png"]=a.getCreativeCommonsLicenseImage(),c["lib/DescartesCCLicense.png"].addEventListener("load",function(){this.ready=1}),c["lib/DescartesCCLicense.png"].addEventListener("error",function(){this.errorload=1}));
var g,k,s,q,u,l;s=0;for(u=b.length;s<u;s++)if("rtf"!==b[s].name){if(b[s].value.match(/'macro'|'makro'/g)){q="";var v;g=this.lessonParser.split(b[s].value);k=0;for(l=g.length;k<l;k++)"expresion"===babel[g[k][0]]&&(q=g[k][1]);q&&((v=document.getElementById(q))&&"descartes/macro"==v.type?v=v.text:(v=a.openExternalFile(q))&&!v.match(/tipo_de_macro/g)&&(v=null));if(v&&(g=v.match(d)))for(q=0,l=g.length;q<l;q++)k=g[q],k.toLowerCase().match(/vacio.gif$/)||""==k.substring(0,k.length-4)||(c[k]=new Image,c[k].addEventListener("load",
function(){this.ready=1}),c[k].addEventListener("error",function(){this.errorload=1}),c[k].src=k)}if(g=b[s].value.match(d))for(q=0,l=g.length;q<l;q++)k=g[q],k.toLowerCase().match(/vacio.gif$/)||""==k.substring(0,k.length-4)||(c[k]=new Image,c[k].addEventListener("load",function(){this.ready=1}),c[k].addEventListener("error",function(){this.errorload=1}),c[k].src=k);if(g=b[s].value.match(f))for(q=0,k=g.length;q<k;q++)this.initAudio(g[q])}for(var p in c)c.hasOwnProperty(p)&&this.images.length++;for(p in e)e.hasOwnProperty(p)&&
this.audios.length++;var t=this,w=this.images.length+this.audios.length;this.sep=2*(this.barWidth-2)/w;var A=function(){t.readys=0;for(var a in c)c.hasOwnProperty(a)&&(c[a].ready||c[a].errorload)&&t.readys++;for(a in t.audios)e.hasOwnProperty(a)&&(e[a].ready||e[a].errorload)&&t.readys++;t.readys!=w?setTimeout(A,30):(clearTimeout(t.timer),t.descartesApp.initBuildApp())};A()};a.DescartesLoader.prototype.initAudio=function(b){var c=this.audios;c[b]=new Audio(b);c[b].filename=b;var e=function(){this.ready=
1},d=function(){this.canPlayType("audio/"+this.filename.substring(this.filename.length-3))||"mp3"!=this.filename.substring(this.filename.length-3)?(console.log("El archivo '"+b+"' no puede ser reproducido"),this.errorload=1):(c[b]=new Audio(this.filename.replace("mp3","ogg")),c[b].filename=this.filename.replace("mp3","ogg"),c[b].addEventListener("canplaythrough",e),c[b].addEventListener("load",e),c[b].addEventListener("error",d),c[b].load())};c[b].addEventListener("canplaythrough",e);c[b].addEventListener("load",
e);c[b].addEventListener("error",d);a.hasTouchSupport?(c[b].load(),c[b].play(),setTimeout(function(){c[b].pause()},20),c[b].ready=1):c[b].load()};var g,c;a.DescartesLoader.prototype.drawLoaderBar=function(a,e,h){g=this.barWidth;c=this.barHeight;a.translate(e/2,(h-65*f)/2+90*f);a.scale(f,f);a.strokeRect(-g,-c,2*g,c);a.fillStyle="#888";a.fillRect(-g+2,-c+2,2*(g-2),c-4);a.fillStyle="#1f358d";a.fillRect(-g+2,-c+2,this.readys*this.sep,c-4);a.setTransform(1,0,0,1,0,0)};var e=function(b,c){var e=document.createElement("canvas"),
d=5E6<b*a._ratio*c*a._ratio?1:a._ratio;e.width=b*d;e.height=c*d;e.style.width=b+"px";e.style.height=c+"px";var g=e.getContext("2d");g.save();g.setTransform(d,0,0,d,0,0);g.strokeStyle=g.fillStyle="#1f358d";g.lineCap="round";g.lineWidth=2;g.beginPath();f=b<c?b/360:c/195;f=2.5<f?2.5:f;g.translate((b-120*f)/2,(c-65*f)/2);g.scale(f,f);g.moveTo(3,25);g.lineTo(3,1);g.lineTo(21,1);g.bezierCurveTo(33,1,41,15,41,25);g.stroke();g.beginPath();g.moveTo(1,63);g.lineTo(1,64);g.moveTo(5,62);g.lineTo(5,64);g.moveTo(9,
61);g.lineTo(9,64);g.moveTo(13,60);g.lineTo(13,64);g.moveTo(17,58);g.lineTo(17,64);g.moveTo(21,56);g.lineTo(21,64);g.moveTo(25,53);g.lineTo(25,64);g.moveTo(29,50);g.lineTo(29,64);g.moveTo(33,46);g.lineTo(33,64);g.moveTo(37,41);g.lineTo(37,64);g.moveTo(41,32);g.lineTo(41,64);g.stroke();g.font="20px descartesJS_sansserif, Arial, Helvetica, Sans-serif";g.fillText("escartes",45,33);g.fillText("JS",98,64);g.restore();return e.toDataURL()};return a}(descartesJS||{}),descartesJS=function(a){function f(a){for(var e=
"[",b=0,m=a.length;b<m;b++)a[b]instanceof Array?e+=f(a[b]):(g=a[b],"undefined"!=typeof g&&g||(g=0),"string"==typeof g&&(g="'"+g+"'"),e+=g),b<m-1&&(e+=",");return e+"]"}if(a.loadLib)return a;a.DescartesApp=function(c){this.animation={playing:!1,stop:function(){}};this.applet=c;this.parentContainer=c.parentNode;this.width=parseFloat(c.getAttribute("width"));this.height=parseFloat(c.getAttribute("height"));this.decimal_symbol=".";this.decimal_symbol_regexp=new RegExp("\\"+this.decimal_symbol,"g");this.language=
"espa\u00f1ol";this.children=c.getElementsByTagName("param");a.creativeCommonsLicense=!0;for(var e=0,b=this.children.length;e<b;e++)"CreativeCommonsLicense"===this.children[e].name&&(a.creativeCommonsLicense="no"===this.children[e].value?!1:!0);this.code=c.getAttribute("code");this.saveState=[];this.images={};this.images.length=-1;this.audios={};this.audios.length=-1;this.firstRun=!0;this.init()};a.DescartesApp.prototype.init=function(){this.stop();this.evaluator=new a.Evaluator(this);this.lessonParser=
new a.LessonParser(this);this.arquimedes=!!this.code.match("descinst.DescartesWeb2_0.class","i")||!!this.code.match("Arquimedes","i")||!!this.code.match("Discurso","i");this.licenseA=a.creativeCommonsLicense?"{\\rtf1\\uc0{\\fonttbl\\f0\\fcharset0 Arial;\\f1\\fcharset0 Arial;\\f2\\fcharset0 Arial;\\f3\\fcharset0 Arial;\\f4\\fcharset0 Arial;}{\\f0\\fs34 __________________________________________________________________________________ \\par \\fs22                                        Los contenidos de esta unidad did\u00e1ctica interactiva est\u00e1n bajo una  {\\*\\hyperlink licencia Creative Commons|http://creativecommons.org/licenses/by-nc-sa/4.0/}, si no se indica lo contrario.\\par                                        La unidad did\u00e1ctica fue creada con Arqu\u00edmedes, que es un producto de c\u00f3digo abierto, {\\*\\hyperlink Creditos|http://arquimedes.matem.unam.mx/Descartes5/creditos/conCCL.html}\\par }":
"";for(var c=this.children,e,b=0,f=0,h=a.creativeCommonsLicense?90:0,d=0,g=c.length;d<g;d++)e=c[d],"rtf_height"==e.name&&(b=parseInt(e.value)||this.height),"Buttons"==babel[e.name]&&(this.buttonsConfig=this.lessonParser.parseButtonsConfig(e.value),f=this.buttonsConfig.height),"image_loader"==e.name&&(this.image_loader=e.value),"expand"==e.name&&(this.expand=e.value),"docBase"==e.name&&(this.docBase=e.value,e=document.createElement("base"),e.setAttribute("id","descartesJS_base"),e.setAttribute("href",
this.docBase),document.head.appendChild(e));this.expand&&"cover"==this.expand&&(this.width=window.innerWidth,this.height=window.innerHeight);this.arquimedes&&b&&(this.height=b+f+h);this.spaces=[];this.externalSpace&&document.body.removeChild(this.externalSpace.container);this.externalSpace=new a.SpaceExternal(this);this.northSpace={container:document.createElement("div"),controls:[]};this.southSpace={container:document.createElement("div"),controls:[]};this.eastSpace={container:document.createElement("div"),
controls:[]};this.westSpace={container:document.createElement("div"),controls:[]};this.editableRegion={container:document.createElement("div"),textFields:[]};a.Editor&&(this.editor=new a.Editor(this));this.controls=[];this.auxiliaries=[];this.events=[];this.cacheVars={};this.getVarsNames={};this.plecaHeight=this.tabindex=this.zIndex=0;this.numberOfIframes=1;void 0!=this.container&&this.parentContainer.removeChild(this.container);this.container=document.createElement("div");this.loader=document.createElement("div");
this.parentContainer.appendChild(this.container);this.container.width=this.width;this.container.height=this.height;this.container.setAttribute("class","DescartesAppContainer");this.container.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px;");this.container.appendChild(this.loader);this.loader.width=this.width;this.loader.height=this.height;this.loader.setAttribute("class","DescartesLoader");this.loader.setAttribute("style","width:"+this.width+"px; height:"+this.height+"px; z-index:1000;");
this.image_loader&&(this.loader.style.backgroundColor="rgba(0,0,0,0)");this.firstRun?this.descartesLoader=new a.DescartesLoader(this):this.initBuildApp()};a.DescartesApp.prototype.initBuildApp=function(){for(var c=this.children,e=this.lessonParser,b=[],f=[],h=[],d=[],g=[],r=[],k,s=0,q=c.length;s<q;s++)if(k=c[s],"language"==babel[k.name]&&(this.language=k.value),"pleca"==k.name)k=e.parsePleca(k.value,this.width),this.container.insertBefore(k,this.loader),this.plecaHeight=k.imageHeight?k.imageHeight:
k.offsetHeight;else if("Buttons"==babel[k.name])this.buttonsConfig=e.parseButtonsConfig(k.value);else if("decimal_symbol"==babel[k.name])this.decimal_symbol=k.value,this.decimal_symbol_regexp=new RegExp("\\"+this.decimal_symbol,"g");else if("version"==babel[k.name])this.version=parseInt(k.value);else if("language"==babel[k.name])this.language=k.value;else if("rtf"==k.name){var u=(this.width-780)/2,l=parseInt(this.height)-this.plecaHeight-this.buttonsConfig.height-45;d.push("space='descartesJS_scenario' type='text' expresion='[10,20]' background='yes' text='"+
k.value.replace(/'/g,"&squot;")+"'");d.push("space='descartesJS_scenario' type='text' expresion='["+u+","+(l-25)+"]' background='yes' text='"+this.licenseA+"'");a.creativeCommonsLicense&&d.push("space='descartesJS_scenario' type='image' expresion='["+(u+15)+","+l+"]' background='yes' abs_coord='yes' file='lib/DescartesCCLicense.png'")}else"E"==k.name.charAt(0)?(k.value.match(/'HTMLIFrame'/)&&this.numberOfIframes++,b.push(k.value)):"C"==k.name.charAt(0)&&"_"==k.name.charAt(1)?f.push(k.value):"A"==
k.name.charAt(0)&&"_"==k.name.charAt(1)?h.push(k.value):"G"==k.name.charAt(0)?d.push(k.value):"S"==k.name.charAt(0)?g.push(k.value):"Animation"==babel[k.name]&&r.push(k.value);this.scenarioRegion={container:document.createElement("div"),scroll:0};this.scenarioRegion.container.setAttribute("id","descartesJS_Scenario_Region");this.scenarioRegion.scenarioSpace=this.lessonParser.parseSpace("tipo='R2' id='descartesJS_scenario' fondo='blanco' x='0' y='0' fijo='yes' red='no' red10='no' ejes='no' text='no' ancho='"+
this.width+"' alto='"+this.height+"'");this.scenarioRegion.container.appendChild(this.scenarioRegion.scenarioSpace.container);this.arquimedes&&(this.container.appendChild(this.scenarioRegion.container),this.spaces.push(this.scenarioRegion.scenarioSpace));s=0;for(q=b.length;s<q;s++)c=e.parseSpace(b[s]),this.arquimedes&&this.scenarioRegion.container.appendChild(c.container),this.spaces.push(c),this.zIndex++;s=0;for(q=d.length;s<q;s++)if(b=e.parseGraphic(d[s]))b.visible&&(this.editableRegionVisible=
!0),b.space.addGraph(b);s=0;for(q=g.length;s<q;s++)(b=e.parse3DGraphic(g[s]))&&b.space.addGraph(b,!0);s=0;for(q=f.length;s<q;s++)this.controls.push(e.parseControl(f[s]));s=0;for(q=h.length;s<q;s++)e.parseAuxiliar(h[s]);s=0;for(q=r.length;s<q;s++)this.animation=e.parseAnimation(r[s]);this.configRegions();this.updateAuxiliaries();this.updateAuxiliaries();s=0;for(q=this.controls.length;s<q;s++)this.controls[s].init();this.updateControls();this.updateSpaces(!0);var v=this;this.numberOfIframes?setTimeout(function(){v.finishInit()},
200*this.numberOfIframes):this.finishInit()};a.DescartesApp.prototype.finishInit=function(){this.evaluator.setVariable("decimalSymbol",this.decimal_symbol);this.update();this.loader.style.display="none";window.parent!==window&&(this.parentContainer.style.margin="0px",this.parentContainer.style.padding="0px",window.parent.postMessage({type:"reportSize",href:window.location.href,width:this.width,height:this.height},"*"),window.parent.postMessage({type:"ready",value:window.location.href},"*"),a.onResize());
window.opener&&window.opener.postMessage({type:"isResizeNeeded",href:window.location.href},"*");this.externalSpace.init()};a.DescartesApp.prototype.adjustSize=function(){document.body.style.margin="0px";document.body.style.padding="0px";this.parentContainer.style.margin="0px";this.parentContainer.style.padding="0px";var c=parseInt(this.width)+30,e=parseInt(this.height)+90;window.moveTo((parseInt(screen.width)-c)/2,(parseInt(screen.height)-e)/2);window.resizeTo(c,e);a.onResize()};a.DescartesApp.prototype.adjustDimensions=
function(){var a,e,b;if(void 0==this.init_w||void 0==this.init_h)this.init_w=parseInt(this.container.style.width),this.init_h=parseInt(this.container.style.height);e=parseInt(this.parentContainer.offsetWidth);a=this.init_w;b=e/a;a>e?(this.parentContainer!=document.body&&(this.parentContainer.style.height=this.init_h*b+"px"),this.percent=b,this.container.style.webkitTransform=this.container.style.MozTransform="scale("+b+")",this.container.style.webkitTransformOrigin=this.container.style.MozTransformOrigin=
"top left"):(this.parentContainer!=document.body&&(this.parentContainer.style.height="auto"),this.percent=1,this.container.style.webkitTransform=this.container.style.MozTransform="",this.container.style.webkitTransformOrigin=this.container.style.MozTransformOrigin="")};a.DescartesApp.prototype.configRegions=function(){var c=this.evaluator.parser,e=this.buttonsConfig,b=this.container;if(2!=this.version)var f="15",h=100,d=100,g=100,r=100;else f="14",h=63,d=50,g=44,r=53;var k=0,s=0,q=0,u=q=0,l=0,v=0,
p=0,t=0,v=this.northSpace.controls,w=this.southSpace.controls,A=this.eastSpace.controls,C=this.westSpace.controls;if(0<e.rowsNorth||0<v.length||e.about||e.config){0>=e.rowsNorth?(k=e.height,e.rowsNorth=1):k=e.height*e.rowsNorth;l=this.northSpace.container;l.setAttribute("id","descartesJS_northRegion");l.setAttribute("style","width:"+b.width+"px; height:"+k+"px; background:#c0c0c0; position:absolute; left:0px; top: "+this.plecaHeight+"px; z-index:100;");b.insertBefore(l,this.loader);var l=b.width,
z=0;e.about?(z=h,l-=z):h=0;e.config&&(l-=d);for(var B=Math.ceil(v.length/e.rowsNorth),E=l/B,q=0,D=v.length;q<D;q++)v[q].expresion=c.parse("("+(z+q%B*E)+","+e.height*Math.floor(q/B)+","+E+","+e.height+")"),v[q].drawif=c.parse("1"),v[q].init();e.about&&(q="espa\u00f1ol"==this.language?"cr\u00e9ditos":"english"==this.language?"about":"cr\u00e9ditos",q=new a.Button(this,{region:"north",name:q,font_size:c.parse(f),expresion:c.parse("(0, 0, "+h+", "+k+")")}),q.actionExec={execute:a.showAbout},q.update());
e.config&&(new a.Button(this,{region:"north",name:"config",font_size:c.parse(f),action:"config",expresion:c.parse("("+(l+h)+", 0, "+d+", "+k+")")})).update()}if(0<e.rowsSouth||0<w.length||e.init||e.clear){0>=e.rowsSouth?(s=e.height,e.rowsSouth=1):s=e.height*e.rowsSouth;v=b.width;z=0;e.init?(z=g,v-=z):g=0;e.clear&&(v-=r);l=this.southSpace.container;l.setAttribute("id","descartesJS_southRegion");l.setAttribute("style","width:"+b.width+"px; height:"+s+"px; background:#c0c0c0; position:absolute; left: 0px; top:"+
(b.height-s)+"px; z-index:100;");b.insertBefore(l,this.loader);B=Math.ceil(w.length/e.rowsSouth);E=v/B;q=0;for(D=w.length;q<D;q++)w[q].expresion=c.parse("("+(z+q%B*E)+","+e.height*Math.floor(q/B)+","+E+","+e.height+")"),w[q].drawif=c.parse("1"),w[q].init();e.init&&(q="espa\u00f1ol"==this.language?"inicio":"english"==this.language?"init":"inicio",(new a.Button(this,{region:"south",name:q,font_size:c.parse(f),action:"init",expresion:c.parse("(0, 0, "+g+", "+s+")")})).update());e.clear&&(q="espa\u00f1ol"==
this.language?"limpiar":"english"==this.language?"clear":"limpiar",(new a.Button(this,{region:"south",name:q,font_size:c.parse(f),action:"clear",expresion:c.parse("("+(v+g)+", 0, "+r+", "+s+")")})).update())}if(0<A.length)for(q=b.height-k-s,p=e.widthEast,l=this.eastSpace.container,l.setAttribute("id","descartesJS_eastRegion"),l.setAttribute("style","width:"+p+"px; height:"+q+"px; background:#c0c0c0; position:absolute; left:"+(b.width-p)+"px; top:"+k+"px; z-index:100;"),b.insertBefore(l,this.loader),
q=0,D=A.length;q<D;q++)A[q].expresion=c.parse("(0,"+e.height*q+","+p+","+e.height+")"),A[q].drawif=c.parse("1"),A[q].init();if(0<C.length)for(q=b.height-k-s,t=e.widthWest,l=this.westSpace.container,l.setAttribute("id","descartesJS_westRegion"),l.setAttribute("style","width: "+t+"px; height: "+q+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+k+"px; z-index: 100;"),b.insertBefore(l,this.loader),q=0,D=C.length;q<D;q++)C[q].expresion=c.parse("(0,"+e.height*q+","+t+","+e.height+")"),C[q].drawif=
c.parse("1"),C[q].init();if(this.editableRegionVisible)for(u=e.height,l=this.editableRegion.container,l.setAttribute("id","descartesJS_editableRegion"),l.setAttribute("style","width:"+b.width+"px; height:"+u+"px; position:absolute; left:0px; top:"+(b.height-s-e.height)+"px; z-index:100; background:#c0c0c0; overflow:hidden;"),b.insertBefore(l,this.loader),c=this.editableRegion.textFields,e=b.width/c.length,f=a.getFieldFontSize(u),q=0,D=c.length;q<D;q++)"div"==c[q].type?(l.appendChild(c[q].container),
c[q].container.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; width: "+(e-4)+"px; height: "+u+"px; position: absolute; left: "+q*e+"px; top: 0px;"),h=c[q].container.firstChild,h.setAttribute("style","font-family: Arial, Helvetica, 'Droid Sans', Sans-serif; font-size: "+f+"px; padding-top: 0%; background-color: #e0e4e8; position: absolute; left: 0px; top: 0px; height:"+u+"px; text-align: center; line-height: "+u+"px;"),d=h.offsetWidth,h.style.width=d+"px",h.firstChild.textContent=
h.firstChild.textContent.substring(3,h.firstChild.textContent.length-3),c[q].container.lastChild.setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+f+"px; width:"+(e-d)+"px; height:"+u+"px; position:absolute; left:"+d+"px; top:0px; border:2px groove white;")):(l.appendChild(c[q]),c[q].setAttribute("style","font-family:'Courier New', Courier, 'Droid Sans Mono', Monospace; font-size: "+f+"px; width:"+e+"px; height:"+u+"px; position:absolute; left:"+
q*e+"px; top:0px; border:2px groove white;"));this.displaceRegionNorth=k;this.displaceRegionWest=t;b.width-=p;b.height=b.height-s-u;q=0;for(D=this.spaces.length;q<D;q++)this.spaces[q].init()};a.DescartesApp.prototype.update=function(){this.updateAuxiliaries();this.updateControls();this.updateEvents();this.updateControls();this.updateSpaces()};a.DescartesApp.prototype.clearClick=function(){for(var a=0,e=this.spaces.length;a<e;a++)this.spaces[a].clearClick()};a.DescartesApp.prototype.deactivateGraphiControls=
function(){for(var a,e=0,b=this.controls.length;e<b;e++)a=this.controls[e],"graphic"==a.type&&a.deactivate()};a.DescartesApp.prototype.updateAuxiliaries=function(){for(var a=0,e=this.auxiliaries.length;a<e;a++)this.auxiliaries[a].update()};a.DescartesApp.prototype.updateEvents=function(){for(var a=0,e=this.events.length;a<e;a++)this.events[a].update()};a.DescartesApp.prototype.updateControls=function(){for(var a=0,e=this.controls.length;a<e;a++)this.controls[a].update()};a.DescartesApp.prototype.updateSpaces=
function(a){for(var e=0,b=this.spaces.length;e<b;e++)this.spaces[e].update(a)};a.DescartesApp.prototype.clear=function(){for(var a=0,e=this.spaces.length;a<e;a++)this.spaces[a].spaceChange=!0,this.spaces[a].drawBackground&&this.spaces[a].drawBackground()};a.DescartesApp.prototype.play=function(){this.animation&&this.animation.play()};a.DescartesApp.prototype.stop=function(){this.animation&&this.animation.stop()};a.DescartesApp.prototype.reinitAnimation=function(){this.animation&&this.animation.reinit()};
a.DescartesApp.prototype.stopAudios=function(){this.stop();for(var a in this.audios)this.audios.hasOwnProperty(a)&&this.audios[a].pause&&(this.audios[a].pause(),this.audios[a].currentTime=0)};a.DescartesApp.prototype.getImage=function(a){var e=this.images;if(a)return e[a]||(e[a]=new Image,e[a].addEventListener("load",function(){this.ready=1}),e[a].addEventListener("error",function(){this.ready=0;this.errorload=1}),e[a].src=a),e[a]};a.DescartesApp.prototype.getAudio=function(a){var e=this.audios;if(a){if(!e[a]){var b=
a.lastIndexOf("."),b=-1===b?a.lenght:b;a.substring(0,b);e[a]=new Audio(a);var f=function(a){this.ready=1};e[a].addEventListener("canplaythrough",f);var h=function(b){this.canPlayType("audio/"+a.substring(a.length-3))||"mp3"!=a.substring(a.length-3)?(console.log("El archivo '"+a+"' no puede ser reproducido"),this.errorload=1):(e[a]=new Audio(a.replace("mp3","ogg")),e[a].addEventListener("canplaythrough",f),e[a].addEventListener("load",f),e[a].addEventListener("error",h),e[a].load())};e[a].addEventListener("error",
h);e[a].play();setTimeout(function(){e[a].pause()},15)}return e[a]}return new Audio};a.DescartesApp.prototype.getControlByCId=function(a){for(var e,b=0,f=this.controls.length;b<f;b++)if(e=this.controls[b],e.cID==a)return e;return{update:function(){},w:0}};a.DescartesApp.prototype.getControlById=function(a){for(var e,b=0,f=this.controls.length;b<f;b++)if(e=this.controls[b],e.id==a)return e;return{update:function(){}}};a.DescartesApp.prototype.getSpaceByCId=function(a){for(var e,b=0,f=this.spaces.length;b<
f;b++)if(e=this.spaces[b],e.cID==a)return e;return{update:function(){},w:0}};a.DescartesApp.prototype.getSpaceById=function(a){for(var e,b=0,f=this.spaces.length;b<f;b++)if(e=this.spaces[b],e.id==a)return e;return{update:function(){},w:0}};var g;a.DescartesApp.prototype.getState=function(){var a,e="",b=this.evaluator.variables,g;for(g in b)b.hasOwnProperty(g)&&(a=b[g],"string"==typeof a&&(a="'"+a+"'"),void 0!=a&&"rnd"!=g&&"pi"!=g&&"e"!=g&&"Infinity"!=g&&"-Infinity"!=g&&"object"!=typeof a&&(e=""!=
e?e+"\n"+g+"="+a:g+"="+a));var b=this.evaluator.vectors,h;for(h in b)b.hasOwnProperty(h)&&(a=b[h],e=e+"\n"+h+"="+f(a));h=this.evaluator.matrices;for(var d in h)h.hasOwnProperty(d)&&(a=h[d],e=e+"\n"+d+"="+f(a));return e};a.DescartesApp.prototype.setState=function(a,e){for(var b=a.split("\n"),f,h,d=0,g=b.length;d<g;d++)f=b[d].split("="),2<=f.length&&(h=eval(f[1]),-1!=f[1].indexOf("[[")?(this.evaluator.matrices[f[0]]=h,this.evaluator.matrices[f[0]].rows=h.length,this.evaluator.matrices[f[0]].cols=h[0].length):
-1!=f[1].indexOf("[")?(this.evaluator.vectors[f[0]]=h,this.evaluator.variables[f[0]+".long"]=h.length):this.evaluator.variables[f[0]]=h);e||this.update()};a.DescartesApp.prototype.getEvaluation=function(){for(var a=0,e=0,b="",f=0,h=this.controls.length;f<h;f++)"textfield"==this.controls[f].gui&&this.controls[f].evaluate&&(a++,e+=this.controls[f].ok,this.controls[f].value=""==this.controls[f].value?"''":this.controls[f].value,b+=" \\n "+this.controls[f].id+"="+this.controls[f].value+"|"+this.controls[f].ok);
return"questions="+a+" \\n correct="+e+" \\n wrong="+(a-e)+b};a.DescartesApp.prototype.showSolution=function(){for(var a=this.controls,e=0,b=a.length;e<b;e++)"textfield"==a[e].gui&&a[e].evaluate&&a[e].changeValue(a[e].getFirstAnswer());this.update()};a.DescartesApp.prototype.showAnswer=function(){for(var a=0,e=this.saveState.length;a<e;a++)this.evaluator.evalExpression(this.saveState[a]);this.update()};return a}(descartesJS||{}),descartesJS=function(a){function f(){var a=document.getElementById("StyleDescartesApps");
a&&a.parentNode.removeChild(a);a=document.createElement("style");a.id="StyleDescartesApps";a.type="text/css";a.setAttribute("rel","stylesheet");a.innerHTML="applet.DescartesJS {display:none;} applet {display:none;} ajs.DescartesJS {display:none;} ajs {display:none;}";document.head.appendChild(a)}function g(b){b=document.createElement("div");b.innerHTML='<span style="font:12px descartesJS_serif;visibility:hidden;">_</span><span style="font:12px descartesJS_sansserif;visibility:hidden;">_</span><span style="font:12px descartesJS_monospace;visibility:hidden;">_</span><span style="font:12px descartesJS_extra;visibility:hidden;">_</span>';
document.body.appendChild(b);a.getFeatures();if(a.hasCanvasSupport){window.scrollTo(0,10);for(var c=document.getElementsByTagName("*"),d=[],e=0,f=c.length;e<f;e++)"DescartesAppContainer"==c[e].className&&d.push(c[e]);e=0;for(f=d.length;e<f;e++)d[e].parentNode.removeChild(d[e]);for(var d=document.getElementsByTagName("applet"),e=document.getElementsByTagName("ajs"),c=[],g=0,s=d.length;g<s;g++)f=d[g],(f.getAttribute("code").match("DescartesJS")||f.getAttribute("code").match("descinst.DescartesWeb2_0.class")||
f.getAttribute("code").match("Descartes")||f.getAttribute("code").match("Arquimedes")||f.getAttribute("code").match("Discurso"))&&c.push(f);g=0;for(s=e.length;g<s;g++)f=e[g],(f.getAttribute("code").match("DescartesJS")||f.getAttribute("code").match("descinst.DescartesWeb2_0.class")||f.getAttribute("code").match("Descartes")||f.getAttribute("code").match("Arquimedes")||f.getAttribute("code").match("Discurso"))&&c.push(f);d=0;for(e=c.length;d<e;d++)a.apps.push(new a.DescartesApp(c[d])),c[d].className=
"DescartesJS";window.addEventListener("resize",a.onResize);window.scrollTo(0,0)}else document.getElementById("StyleDescartesApps").innerHTML="applet.DescartesJS {display:block;} applet {display:block;} ajs.DescartesJS {display:block;} ajs {display:block;}";document.body.removeChild(b)}if(a.loadLib)return a;a.apps=[];a.getDescartesApps=function(){return a.apps};window.hasOwnProperty("debugDescartesJS")&&debugDescartesJS||f();a.onResize=function(b){for(var c=0,d=a.apps.length;c<d;c++){b=a.apps[c].spaces;
for(var e=0,f=b.length;e<f;e++)b[e].findOffset()}};a.receiveMessage=function(b){if(0<a.apps.length){var c=b.data;c&&("set"===c.type?"string"==typeof c.value||"number"==typeof c.value?a.apps[0].evaluator.setVariable(c.name,c.value):c.value&&void 0!=c.value.rows?a.apps[0].evaluator.matrices[c.name]=c.value:a.apps[0].evaluator.vectors[c.name]=c.value:"update"===c.type?a.apps[0].update():"exec"===c.type?(b=a.apps[0].evaluator.getFunction(c.name),c=c.value.toString().split(","),b&&b.apply(a.apps[0].evaluator,
c)):"isResizeNeeded"===c.type?b.source.postMessage({type:"doResize"},"*"):"doResize"===c.type&&0<a.apps.length&&a.apps[0].adjustSize())}};if(void 0==a.loadLib){a.loadLib=!0;window.addEventListener("load",g);window.addEventListener("message",a.receiveMessage);for(var c=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd"],e=0,b=c.length;e<b;e++)window.addEventListener(c[e],function(b){a.onResize(b)})}return a}(descartesJS||{});
